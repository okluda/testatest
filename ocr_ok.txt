沖汗半邊國吋器人國
mm（8）圖
12411787了
DB
了o
mm
一
.網真程式交易APP實作
Web+MySGL+Django
-林萍珍著
AA/
人
EN生加
NA合劑
5
0
則做CHAPTEP
及全
HIML5商
1-1HTML5，C$S3與JgvqScript三角關係
1-2安裝編輯器sublimefexH
1-3網頁編輯與檢視
1-4HTML5的文件結構
1.5HTML5常用標籤
1-6HTML5網頁文字格式編排HTML（hypertextmarkuplanguage）是指超文字標示語言，是一種藉由標準符號
（或指令）來標記並顯示在網頁中的字型、顏色、圖形、動畫以及超連結等內容。
HTML是網頁設計的基礎，與CSS（cgscqdingshylesheefs）、JavaScript等技術合
起來設計高效能的動態網頁。HTML是藉由瀏覽器顯示網頁的內容；CSS是美化網頁
的程式語言，使HTML網頁變得更加美觀；JavaScript可以讓HTML+CSS的網頁動
起來，提高使用者體驗的互動性。本書所介紹的版本是目前最新的HTMLS5及CSS3。
LT-HHTML5，CSS3與JqvqsScripf三角關係

HTML5、CSS3與JavaScript三者是網頁設計的完美分工。HTMLs負責描述網
頁的內容；CSS3美化網頁外觀的排版；JavaSeript則是建構一個互動的網頁行為，
見下圖。

JavaScriptCss3
HTML5；

Web網頁的瀏覽器是採主從式架構，每台使用者的電腦都是客戶端（client），造訪
時與伺服器端（server）去請求一整個網頁回來，於本機的瀏覽器做顯示。

1.客戶端可提供使用者在其本機（使用者電腦）的瀏覽器中藉由直譯器執行網頁內

容（HTML與CSS）以及JavaScript程式見下圖左。

2.伺服器端負責提供網頁的電腦，網頁是藉由HTTP協定傳送給客戶端瀏覽器去執

行見下圖右。請求網頁
瀏覽器服務web伺服器
Browser/ClientServer
網頁程式回應客戶端的
HTML、css網頁
含Javasecript程式
一一HTML5

HTMEL最早發表於1993年，HTML5是目前最新的版本於2014年由全球資訊網
協會（WorldWideWebConsortium，W3C）完成制定標準。廣義來看HTML5制作網頁
應要整合CSS與JavaScript技術，目標是減少伺服器端網路應用服務的運算需求，提
高客戶端執行動態網頁運算服務的效能，即可降低網路傳送負載，提升整體客戶端與
伺服器端的分工效能。

阿HTML5特性

HTML5擴充HTML4的API（applicationprogramminginterfaces）與DOM（document
objectmodel）功能已經成為HTML5中重要的基礎。

HTML新增語法錯誤文件處理細節，客戶端瀏覽器有一致的標準來處理程式語
法錯誤問題。HTML是撰寫網頁中使用最廣泛的語言。HTML5網頁撰寫其應用具彈
性與學習具親和力，其他特性如下：

by支援所有的瀏覽器包含：Chrome、firefox、MicrosoftIE、AppleSafari等。

y文件格式較彈性可以忽略空白與跳行。

y網頁瀏覽時可以隨視窗大小自動縮排調整。

y區域儲存（localstorage）允許客戶端（client6）儲存較大的數據資料。回HTML5歷史

HTMEL5於2014年由W3C（全球資訊網協會）公佈制定的標準"取代自1999年
發佈的HTML4。以廣義應用的角度，HTML5包含HTML，CSS以及JavaSeript成為
一套完整的網頁技術組合。

W3c協會於1994年10月成立，其後，網路應用發展的標準規範就交由W3C荔
會制定及推廣。

HTML5的歷史整理如下表：

上di在生

1994W3C協會成立，發佈HTML草案。
|1999|W3C推薦HTML4.0版
we人

2008發佈HTML5第1版規格。二
|2011|Google宣佈其Gmail，GoogleCalender，GoogleDocs採用HTML5架構。
EP」
資料來源：http：/www.w3schools.com/htmlhtml5_intro.asp
1-1-2_CCS3

CSS（層聲樣式表）用以美化HTML網頁外觀的樣式語言，可以重新結構化定義
HTML網頁標籤。可以藉由CSS3做網頁的文字、圖片、表格、表單、滑鼠的格式拓
版設定，例如可以針對文字設定字型大小、顏色、行距、字體等。可以依不同使用者
權限設定不同的排版格式，例如字型大小。

CSS可以將樣式設定為CSS檔案並引進網頁，可以將檔案的內容與顯示獨立分
工，增加網頁的可讀性、增加網頁設計的結構性。

CSs樣式的結構由選擇器、屬性與屬性的值所組成。選擇器可以指定標籤名稱做
定義例如<p>或<span>等、id名稱做定義例如<divid-vmyTestrs、lass名稱做定義
如<liclass="classlclass2'>；屬性可以指定該標籤的特徵例如：字型、顏色、字體等；
TENET加CSS3歷史

1994年HTML發佈後，同年CSS也被HakonWiumLie與BertBos共同設計出
來。網頁外觀層疊的樣式是可以自其他樣式表中繼承而來。網頁設計者可以依個人喜
好，重新定義或設計HTML標籤的樣式，加入具自己偏好的版面設計。

CSS3的歷史整理如下表：

記紀2大紀事
|4HaoswamLe與Batpws#RRihcss2|
es
_
|2016|W3c選擇推薦CSS第三版。
1-1-3JgvqsScripf

JavaScript屬於高階的語言，為物件導向暨直譯式程式語言。由昇陽公司所提出，
原始目的是輔助Java在網頁設計的互動性。JavaScript的程式是在客戶端直譯執行，
可以配合HTMLs與CSS3，可以更廣泛應用到行動商務程式。JavaScript程式也可以
在伺服器端執行如Node.js，目前頗為流行。
區JovoqScripf的特性

JavaScript是腳本語言也是直譯語言，不需要事先編譯（compiler）過即可執行。

JavaSeript可以讀取網頁上的標籤內容並在網頁上飼入動態的文字等素材，也可
以偵測瀏覽器的事件並即時做出回應。其他特性如下：

y可以在客戶端事先做資料的驗證，再將資料送到伺服器端做進階執行。

>y可以藉由DOM的樹狀結構來取存HTML網頁標籤內容，網頁標籤是結構上的

節點，可以由設計函數或方法，進行事件觸發與處理程序。
y可以透過BOM（browserobjectmodel）操作瀏覽器，包含視窗大小調整、關閉或
開啟視窗、彈跳視窗、計時器以及輸出視窗內容等等。加JgqvgsScripf歷史
JavaScript的前身是LiveScript，由Netseape公司開發的程式語言。後來與
AOL（美國線上公司）與SUN（昇陽公司）合作更名為JavaSeript。2018年1月在
TOIBE世界程式語言熱門排名在第6名見下表，JavaScript的歷史整理如下表。
還RAR
ee
|1997|由Netscape，AOL，SUN聯合發佈並更名為JavaScript。
|1998_經由ECMA（歐洲電腦製造商協會）通過ECMASeript程式語言的標準化。
|2005|具有陣列（amay）功能。
|2008|支援JSON（JavaScriptobjectnotation）標準。
|2010|ECMA推出的申新版本L85。
1-2安裝編輯器sublimeie
本書採用SublimeText3當作網頁編輯器，同時可以寫Python與網頁等多程式的
編輯器也能供免費下載使用，下載安裝官網盡下：
https：//www.sublimetext.com/|安裝步畢
人
步旺臉啟動安裝精靈見下圖，按「NextJ。
窗setup-SublimeText3一口x
WelcometotheSublmeText3
SetupWizard
ThiswillinstalSublimeTextBuild3126onyourcomputer
Itisrecommendedthatyoudose引otherapplicationsbefore
continuing，
CldkNexttocontinue，orCanceltoexitSetup，
步暖鶴選擇安裝路徑，按「NextJ。
侯setup-SublimeText3~mmx
SelectDestinationLocation
WhereshouldSublimeText3beinstaled？和
5etupwilinstallSublmeText3intothefolowingfolder
Tocontinue，dickNext，Ifyouwouldlketoselectadifferentfolder，dckBrowse，
還
Atleast22.7MBoffreediskspaceisrequired，縣王窟）選擇額外安裝內容清單（contextmenu），按「Next，J。
他setup-SublimeText31口x
SelectAdditionalTasks

Whidhadditonaltasksshouldbeperformed？

SelecttheadditonaltasksyouwouldlikeSetuptoperformwhileinstalingSublmeText

3，thenddNext.

Li
AC__g6_

崗光人@準備安裝，按「InstallJ。
侯Setup-sublimeText3二x
ReadytoInstall

SetupisnowreadytobegininstalingSublmeText3onyourcomputer，

ClidkInstaltocontinuewiththeinstalaton，orddeBadkifyouwanttoreviewor

mangeanysettings，

Destinationlocation：>

C：YrogramFiesWubimeText3
Pi
2

《>

TR_TEE_IgR_步驟埠）完成安裝，按「Finish。
侯setup-SublimeText3一
國CompletingtheSublimeText3

SetupWizard

SetuphasfinishedinstalingSublimeText3onyourcomputer，

Theapplicationmaybelaunchedbyselectingtheinstalled
ClckFinishtoexitSetup，
SublimeText的操作可以參考以下網址。
http：//aubreyhsu.blogspot.tw/2015/08/sublime-text-3.html
_1-3網頁編輯與檢視
|
|網頁（webpages）包含三個部份：html、head以及body。<html>用以標示HTML
|文件開始，置於文件的最前端，</html>標示文件結束。<head>用來標示HTML文件
的相關資訊，<head>範圍內還可以包含<title>與<seript>等。結束也是以</head>、
</title>與</script>成對出現。<body>是網頁會被執行的主要部份，包括文字、表格
與圖片等。可以插入<p>、</p>、<hl>、</hl>、<hr>、<br>，同樣是以<body>做結
|
”東。簡單範例如下：
|
EL
<html><head>
<title>Examplepage</title>
</head>
<body>
<hl>Helloworld</h1>
</body>
</html>
綻忽和如
如何使用SublimeText直接預覽寫好的程式，有幾種方法，任選一種即可。
口
1.安裝plugin程式
店包公請先啟動SublimeText，並且點擊「Ctrl+Shift+P」，會出現以下畫面。
ee
[leEdt_seeeion_FndviewGoto_Toolspojee_perences_Halp
革和
人還六
說
加條>人說全AA讓多你人
有Ps人人
LE：（gg
Li所本
SO人【
LEEEL
Bookmarks：Togglecr-P2
Buud：CancelRE
Build；NewBuildSystem
|Changelog
|CodeFolding：FoldTagAttributesLE
一OO
ConvertCase；LowerCaseCtrlvkCtrl+L
|ConvertCase：swapCase
|ConvertCase：TitleCase
|上
||
|HATabSize：4HTML
ll3E畫：
步驟的點選「PackageControl」後，連選「PackageControl：InstallPackage」，再
點選「Markdownpreview」，SublimeText會自動安裝。
packageControlwassuccessfullyinstalled
UsetheCommandPaletteandtype"Installpackage”"togetstarted
再點選一次「Ctrl+Shift+P」，輸入PackageControl：InstallPackage後會出
符繞堆品
現等待輸入要安裝的新套件名稱：Markwonpreview後按Enter。
須眉
232g22952
1|
Av加
和八人：|
多說了MiarKdOWnprevieW|
人：
AMarkdowrnPreview
人PELEL5LENOC
<絡ELELLEL
|SILI
多ALLLLL
|EL生LEALLE
|StrapdownMarkdownPreview
|LTLE[加和Jr
一installv2015.02.27.18，.23.45；github：com/michfield/sublime-strapdown-preview
|GitHubFlavcredMarkdownPreview
|LELELE
ENLA
二】haractersselectedNTabsge：4HTML
MorkdwonPreview套件安裝成功的畫面EE
思packageControlMessages-SublimeText（UNREGISTERED）而而說妥畫
加加工人
4了如2LA
LA0本，避和
同還
SublimeText2/3MarkdownPreview
EL加，各
ELLE
33Youcanusebuiltin[python-markdown][19]parserGeusethe[Bithup
PE|
5人
EL交几2
四本你
同四51下下入1生二說下廬生必生
了宮和加光全
和
和
人=
人有人人下人誤各下
informationz約人本
人|
En侶1全列誤3
RE卅剖給ON人四全|
RE和
步驟侈》重好es二
步驟滲》重新啟動SublimeText3，點選「Preferences->KeyBindings」。在[]
輸入：
人keyse：[Dalt+ve]，"command"："markdown_previewpargsn：PE生
點2382user-PCxDownloadsuhtmhhelloworld.html-sublimeText（UNREGISTERED）而轉單
FleEdtselectionFindyiewGotoToolProjectPreferencesHelp
（>heiowerd.html有2
ee本
1人才穫及全生
|
Fi
>
條
chello
5
2二
BR人上
儲存後，重新啟動SublimeText3。在SublimeText的編輯網頁
在空白處輸入網頁程式碼如下：
周cusersusepownloadsxhelloworld.html-sublime-一一口XX
FleEditSelectionFindView“Goto”ToolsProjectpreferences
Help
PL
1<1html>
有人<v
和>ExamplepaBex/v
4人>>
33
Lv
人>
</>
EL和21
按下「alt+v」，即可啟動瀏覽器預覽網頁畫面。
人直選3盂
口bamplepageN人
人Q[@fez7/7CZUsers/UsER/Desktop/helowordhtml生
Helloworld
2.新增一個buildsysfem並將Chrome設定為預設的瀏覽器
（1）Tools功能表下選BuildSystem下的的NewBuildSystem一
（2）將以下指令輸入到檔案存檔如下圖：
（"cmde：[Propen""-a""GoogleChrome""$file"]）轉unttledsublime-build。-sublimeText（UNREGISTERED區]弓廳詞
PleEdtooToolsProjectpreferencesHelp
說昂PEeEL下
RE【
|2襄引1辣抽襄還呈信二全三語計ce生9人1全9生下二中二生
只了GE加人_點
另存新檔，檔名為Chrome.sublime-build，後存檔如下圖。

AA1：
國一此了
C圖），<AppDatayRoamingy四）Si》4||和的-
一加如4才點4兮
說人全和所人條憫日有基層大小
一宮謂出PackageControLcache2017/2/14下入0查加盜補天
財團各而引|Chrome.sublime-build2017/2/18上往1-suU8UME-8UiLD-1kB
間。咽是近的位軒口Defaut（Windows）.sublime-keymap2016/10/7上竺1..5SUSUME-KEYMA1K8

口packagecontrolsublime-settings2016/10/7上竺1sSUSUME-SETTIN1K8
思洲點口preferencessublime-settings2017/2/15下字0_.。SUBUME-SETTIN_1K8
國文件
馬獸光
回況記
回圖片
TEChrome.sublime-buildee~
存寢林型（D：[JSON（jsonjsublime-settin9s*.sublime-menu；*sublime-keymap；*sublime-mousemapisublime-themesublim~|
畫
加Lza@][昭」
再次點選Tools下的Build即可看到預設瀏覽器為Chrome見下圖。時udedsubimebunds-subimeTetuNREGSTERED[加本ga
[ep
說圖謹3353aS90Cti+shift+p
（smippets
5"cmd"：["openEn二Automate2
了1吧主ge_5
BuildWih人
|SEE25n
吧在0-
<5之9到5|
RecerdMacrecd+Q|Eng
Playbackacrectlvsh+Q|Haskell|
saveMacroJavac
|
|Developer>
python
人
|Ruby!
|如
|SntaxTess
|讓RE
ee人
3.另一個最簡便的方式，將*.himl檔案拖曳到瀏覽器視窗即可。
條
1-4HTML5的文件結構
HTML5文件結構區塊化，使得文件結構更具邏輯性，章節分明，簡圖描述如
下圖。HTML5的標籤與結構，每個都代表著各種含意，相較起來<div>卻無法區別林
籤之間的意義，<header>標籤意義就對應著大標的意思，<section>標籤是文章的章
節，<article>標籤是每個章節的內容再加以區分，<nav>標籤是表達網頁的連結，
HTML5標籤相對在結構上，讓人更好上手。

1-5HTML5常用標籤
品叨

.一段完整，可獨自被外部參考的的網頁文件內容。可以有自己的
加聞header，footer。

林栓。|將網頁內容依他時分節綱輯。節的內容通常會搭配休題組成。setos
的內容可以被儲存到資料庫或word。

用以標示內容的標題，也可以包含資料表格、表單logo圖片等。

用在頁腳處做備註、作者資訊、版本、聯絡方式等。

|ae>林紡。「mav用以定義過一個上的超還自。|
figure用以配置圖片、影音檔、圖表（可能是canvas或是svg）或是一

如

其圖圖設計一個網頁，使用<section>將花的種類分為種，含圖與超條

結做說明。

全提示

第18列與第33列<img>標籤用到style參數，將在後續章節中補充說明。
|程式碼檔名：E1_l.himl
-<html>l
2<head>!
」3<metacharset="UTF-8">
4<!--[ifItIE9]>
5。<scriptsre=https：//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shivjs"></seripf7

6_<![endifl-一bi計7_</head>

8._<body>

9<header>

10<hl>花廊<hl>

11<hr>

12</header>

13<article>

14<section>

15<h2>百子蓮</h2>

6人

gacE

18<imgsrc="lotus.jpg"alt="百子蓮"width="304"height="228"style="margin：15px'">

19_</figure>

20。<sectionstyle="width：300px；float：left；'"一

21<p>原生於南非，多年生草本植物，花妮是藍色呈漏斗形，花莖直立，最高可在長到
一公尺，大約有10個不同的顏色與種類。葉子的型狀呈披針形，長度可達六十公分左
右。分球繁殖或是用種子繁殖均可。</p>

22”<p>~攝於雪霸國家公園</p>

23<nav>

24。<ahre所"https：//zh.wikipedia.org/wiki/%E7%999%BE%E5%AD%909%6E89939%AE9E59%B1l
%AC'">百子蓮</a>

No公司

aeASO2E5

27</section>

28一<divstyle="clear：both；"一</div>

29“<section>

30_<h2>台灣龍膽</h2>

31<hr>

32。<figurestyle="float：left；'>

33_<imgsrc="longtang.jpg"alt="台灣龍脆"width="304"height="228"style="margin：15px">

對人讓

3人3若申必和“36<p>台灣原生種，台灣龍膽生長於海拔500到3000公尺山坡，路旁向陽處。花斤細放
約3公分，裂片三角狀卵形，花但管筒狀，多年生草本，株高5-15公分，全株光滑無，
毛。具藥用功能：苦、涼、降肝清火，解暑熱，健胃。花期在每年5到7月，又稱龍脆
。草、阿里山龍膽。<fp>
37_<p>~攝於雪霸國家公園。</p>
38<nav>>
AdEASERIES
BE%8D%E89%86%BD">台灣龍膽</a>
40</nav>
41</section>
42。</section>
人人
44</body>
45。</htm世
|程式說明
本範例是製作一個簡單的圖文介紹網頁，第10列的<hl>花廊<hl>就是我們的
標題。接著製作介紹每一種花卉的圖與文，第15列使用<h2>百子蓮</h2>打出花卉
的名稱當成小標題，會發現<h2>這個HTML標籤，裡頭的數字2是可以修改成其他
正整數的，其數字修改越大，字體越小。
接著第17列我們使用<figure>插入一個區塊（注意!<figure>標籤不支援IE8以
前的版本），在第18列裡頭放置HTML圖片的標籤img>，給予img>圖片路徑的
屬性sre，在此範例中，由於圖片是存在本機端，所以圖片的路徑就是該網頁存放的
r相對路徑」圖片位置，亦可使用網路的圖片位址。
在第21列使用<p>來打上花卉的文字敘述，通常會將一個段落的文字打在一個
<p></p>元素裡面，一篇文章可以有好多個段落，且<p>預設上下會有空白（間隔），
很適合拿來打文字。|執行結果
花亡
百子運
厚生於南非，多年生量本植物，花尊是
藍色呈濕斗形"花束直立，最高可在長
到一公尺生玖放抽和
你代記Si
多同從多均可-
說說作四說回
人嬰s國nu
器
和生+台灣禿騰生長於海拔500到
踢3000公尺山寺，路旁向陽慮。花沽細小
Ni
光漲無毛。員鑄用功箇：苦、滬、隆肝
人和
你生和六攝於香吾國家公園<
同台灣蘿瞳
“1-6HTML5網頁文字格式編排
網頁內容依據文字的需要做格式的排版包含格式化一行文字、格式化某一段文
。字、表列清單以及表格等。依指令操作方法整理說明如下：
“回文字格式
HTML5提供幾種文字格式標籤整理如下表：
才功能
|hl>標籤[|設定文字最大標題，可以由最大<hl>設到最小<h6>。
加一可二，名稱功能
|竅租。|顯示文字，類呈~列
apmlm
Mr
[aa
設計一個網頁，使用section將花的種類分為2種，含圖與超連結
做說明。
程式碼檔名：E1_2.himl
1_<IDocTYPEhtml>|
2<html>|
3<head>|
4<title>Fontandlist</title>
5</head>
eACV-
7<hl>HTML5</h1>
8[<h2>HTML5</h2>
o”<h3>HTML5</h3>
10全V
11<h4>HTML5</h4
12”<h5>HTML5</hS>
13“<h6>HTML5</h6>
14<b>HTML5</b><br>由
15<i>HTML5</i><br>
6AEV
.17<p>HTML（hypertextmarkuplanguage）是指超文字標示語言。是一種藉由標準符號（或
指令）來標記並顯示在網頁中的字型、顏色、圖形、動畫以及超連結等內容。</p>
18</body>
|19</html>|程式說明
本範例是介紹在HTML上常使用於文字的元素，在第7列至第9列、第11列至
第13列中，可以看到HTML事先定義好的各種標題元素的大小，在不自訂字體大小
（例：style="font-size：26px；"）的情況之下，可以根據使用者想要的標題大小'直接使
用<hl></hl>標籤（裡頭的數字1可以依照使用者喜好自訂1~6的正整數）來顯示標
題。而第10列的<hr/>標籤則是分界線的意思，上下會預設留白。在第14列<b><
b>元素內的文字，會以粗體的方式作顯現；第15列的<i></i>元素內的文字，'會以
斜體的方式作顯現。
|執行結果
|[UNIT
區Fontandlistx多
<oolewezozoseseeetsee-對轉oil
撕產用三式是誤頁供訊圖說5四員放說品從EE匯入上1選國入說
HITML5
HTML5
HITML5
HITML5
HIML5
|HTML5|
人
jmMLqyperemarkupLanguage）是指超文字林二語言。是一種和由木痊
雪人；
【G相。
||範例1-3|使用<div>設定字型的顏色，有序號項目與無序號項目設計一個
網頁。
|程式碼檔名：E_1_3.html
1_<!DocTYBPEhtml>人
2<html>
3._<body>
4_<p>李白生於西元701至762年，字太白，號青蓮居士，唐朝詩人。</p>
5<divstyle="color：#0000FF">
6<h3>李白送孟浩然之廣陵</h3>
<p>故人西辭黃蕉樓，煙花三月下揚州。</p>
8<p>孤帆遠影伯空盡，唯見長江天際流。</p>
wAS
10<hr>
11_<h3>李白獨坐敬亭山</h3>
12<p>眾鳥高飛盡，孤雲獨去閒。</p>
13<p>相看兩不厭，只有<spanstyle="color：red；font-weight：bold">敬亭山</span></p>
14<hr>
15<ul>
16過人
17<li>夏<i>
當
19<li>冬<l>
20</ub>
21<hr>
22<olstart二207Teversed>
23<l>巨蟹</li>
24Av沖繩
25。<l>雙魚</li>
Av
27</body>
28_<html>說|程式說明
本網頁範例是要練習HTML父與子元素的用法，會發現第5列至第9列的<div>
元素中包含了三個元素（<h3>、<p>、<p>），以這個區段來說，<div>屬於父元素，其
中包含的三個元素則屬於子元素，因此在<div>標籤所寫的style="eolor：#0000FF"，
是包含媕Y所有的子元素（第6到第8列）的文字段落文字色彩都為藍色，第
13列<span>是格式化某列或某個字（例如：第13列<spanstyle="color：red；font-
weight：bold">敬亭山</span>敬亭山文字色彩變成紅色及粗體）第15列的<ul>用於
製作網頁的項目清單且是無序的項目，但第22列的<ol>它也是用於製作網頁的項目
清單，但它會自動顯示序列的項目清單，<ol>有序的項目也可以自訂的方式去排序，
例如：第22列的<olstart="20"reversed>，由此可知start可以決定項目開始的順序；
reversed則是設定此元素要使用降冪的方式排序，第16列至第19列、第23列至第
25列的<li>是指一個一個的內容項目。
[執行結果
ELx權WWW
fctopegBAESESE人加COe：|
撕加副廁洪圖弓頁快訊圖產品自林連結口從IE工入[已匯A>
李白生於四元701至762年，字太白，跟至運居士，唐朝話人。點
和李白|
故人相吧黃谷樓，規花三月下揚州。
孤帆遠影僚空蛋，嗆見長江天隙流。
李白獨坐敬亨山
眾烏高飛盡，孤當沁去閒。
相看兩不厭，只有角亭山
：員
隊3
20.巨角
呈光多
18.雙魚器四到若圖設計一個有顏色漸居的表格，並設計表格的樣式，樣式的進階使用
見後續章節。
|程式碼檔名：E1_4.himl
1_<!DOCTYPEhtml>
2<html>
3<head>
4<style>
5ftablet
6font-family：arial，sans-serif
7border-collapse：collapse；
8Width：1009%；
2
10
二
border：1pxsolid#dddddd；
13text-align：left；
14padding：8px；
15）
16
17trnth-ehild（even）（
18background-color：#F5F5DC；
197）
20</style>
21</head>
22”<body>
23<divstyle="color：#00008B">
24<h3>TIOBEIndexforMarch2017</h3>
AV
26。<tablestyle="width：1009">
8AV
28<th>2017March</th>29<th>2016March</th>
30<th>Rating</th>
31<tr>

$AV

33<td>1</td>

34<td>1</td>

35<td>Java</td>
36</tr>

AS

38<td>2</td>

39<td>2</td>

40<td>C</td>

41<tr>

42<tr>

43<td>3</td>

44<td>3</td>

45<td>C++</td>
說A5

AV

48<td>4</td>

49<td>4</td>

50<td>C#</td>
51<tr>

52<tr>

53<td>5</td>

54<td>5</td>

55<td>Python</td>
56<tr>

AV

58<td>8</td>

59<td>8</td>

60<td>JavaScript</td>61AV-
62A『N
63<td>17</td>
64<td>48</td>
65<td>Go</td>
66AV
SA
$AESV
70</html>
|程式說明

本網頁範例，HTML5表格及CSS用法，<table>的建立表格，再由<fr>建立列、
<td>建立欄；<th>建立欄標題。第26列至第67列就是在表格的所有內容，完成後
要修改表格的樣式，除了使用第26列逐一設定style的方法外，我們可以善用CSS的
語法來快速美化我們的HTML樣式。

第4列至第20列是由<style>標籤所包含，因此在這個標籤內所有的內容，即
為CSS語法。比如說：修改文字大小是用font-size、修改字型是用font-family““'等，
雖然寫在HTML裡面，但並不代表是HTML的語法。可以看到第5列的tablef），就
是對應到HTML所有的<table>元素；第11列的td，thf）則是代表HTML內的所有
<td>、<th>元素要套用此樣式；第17列trnth-child（even）（）只套用在偶數列上。|
執行結果
訕回人說人
pp>說
個cp|@和le：///C：/Users/user/Downloads/Toibe.htn次|：
和生容用程式eSAS@LogonManac
TIOBEIndexforMIareh2017
|2017March2016MarchRating
|1站Java
22
33C++
44C#
|55Python
88JavaScript
|1748Go
參考資料
芯https：//WWww.Ww3Schools.com/html/
臣https：//Www.tilobe.com/tlobe-index/1.”設計一個點擊就可以連結到外部網站的圖片超連結。
2.。試寫一個可以連結到外部網站的文字超連結，設定為在新的窗口打開。
3.。以有序號項目與無序號項目兩種方式列出自己的姓名、人性別、生日與職業。
4.”設計一個網頁，以文字圍繞著一個圖案的方式呈現。
5.。試著將youtube影片遷入至頁面上。
為提示
在<ifrome>中加入寬高屬性設置與src連結即可。
6.”隨意設計一個以CSS美化過的個人課表，以表格呈現。
3提示
hd標籤內的rowspon屬性設定可橫跨的行數。例：rowspqn="2"；colspon則為列數。
了怕圖NM
_0有名!|
|
106學年度上學期大三課表
者
al|和人-]|
各程式設計|Mwvcet琰
[am|||
11：10~12：00|入一~
am
HEx__I1
[aea||8[aao4mast||表單
2-1”<input>標籤
2-2”其他標籤
2-3補充說明表單（Form）是互動式網頁很重要的部份，HTML5的表單是由一組<fom>
</form>所組成，表單內可藉由文字方塊、按鈕、選單等標籤收集客戶端的網頁使
用者輸入資料後，傳送至伺服器端做處理。若只有HTMEL5的表單靈活性還不足，
需要JavaScript提高表單的實用性。本文先介紹HTML5的表單標籤的基礎功能，待
JavaScript章節再做後續補充。

HTML的表單（form）是為了透過網頁介面收集使用者輸入的資料，表單內可以配
置的標籤有：文字方塊、下拉式選單、選擇鈕、核取方塊、密碼、按鈕、日期等。

表單的格式如下：
<form>
標籤
</form>
2-1<inpuf>標籤

<input>標籤使用最廣泛，最常用的幾種形式整理如下表：

標籤功能

定義一個可以輸入年月日的欄位，提供使用者選擇年月日以及顯
<inputtype="date'"示月曆形式。

|定義一個可以輸入email的欄位，汐覽器會協助檢查email內是
人否含有@或.ecom等。有些瀏覽器不支援如IE9。
<inputtype="checkbox'>選項。生汪功能
本
<inputtype='button'>程式是伺服器端的一支程式，用以處理HTML傳進來的表單資
料。
2-2其他標籤
標籤讓
行（cols）屬性，設定文字方塊的寬度。
四時表單資料分組fieldset用以設定表單的輸入欄，及將相關的資料以標題加
框分組起來，輸入畫面視覺上一目了然。當同一組表單被放到fieldset標
籤時，瀏覽器會特別標示這組表單元素，分組表單內還可以有子表單。
可以使用legend標籤是fieldset的標題。
button標籤通常用以呼叫或執行某事件。button與<inputtype=button>的
3差別在以下章節補充。
keygen標籤提供一種對使用者進行認證的安全服務，在表單送出時產生
一對金鑰。私鑰（privatekey）存在瀏覽器端（client），公鑰（publickey）送
1_至伺服器端（server），可用於驗證使用者身份。目前支援RSA演算法
|[雪人
資料清單datalist與select功能很像都可以下拉選單供使用者選擇，差別
在於（1）datalist標籤選擇前為空白（無預設選項），而且其（2）提供的下
III
i屬性。2-3補充說明
歡<inpufiype="bulfom">與<bulfon>的差別

<inputtype="buttor">是<input>標籤其中的一種形蝕；而<button>是單獨的一個
標籤。兩者差別說明如下：

1.<input>的type屬性設為button時，可以顯示出一個按鈕，但不會傳送表單次

料，而<button>可以傳送表單資料。

2.<button></button>之問可以放要顯示在顯示於按鈕上的內容。
3.<button>也可以定義type=reset的按鈕，功能是重設表單資料。

不論input或button，可能都需要一個阻止提交表單的功能叫onsubmit，通常用
在客戶端驗證表單內容值。可在表單的屬性onsubmit的內容值設為false，阻止表踢
提交。搭配表單使用時，尤其是結合JavaSeript技術時，建議使用button提交表單而
不使用input提交單表。本章以<inputtype="button">為主，待到JavaScript等後續章
節時再說明<button>使用範例。

回活動屬性（qctfionqfributle）與方法屬性（meihodqifribufe）

表單中的活動屬性是定義當表單被提交時，活動就會被啟動。當使用者在HTML
Re
下：
<formaction='"/.../"method二get之

action活動屬性的雙引號內放置檔案放在伺服器端的路徑；method方法屬性是指
定提交HTML表單時使用HTTP方法，指定用get或post。參考格式如下：
<formaction="/.../"method='get"~

或
<formaction=="/..，/"method=='post'>回hitp傳送方法之gef與post的差別
資料在網路上傳送，get與post兩種方法使用時的安全性差別，就如寄信時使用
明信片或一般信件的差別。get方法的使用就如明信片，除了收件人與地址公開外，
也可以把想寫的話全寫在明信片，克許公開傳送資料的內容。post方法的使用也如一
般信件，只有將收件人與地址寫在信封外，使用者把想寫的話另外寫在一張紙上，如
同與信封獨立的另一個檔案傳送，信件內容是隱私的。
yget的使用時機：提交HTML表單的預設方法屬性是get。當方法屬性設定為
get時，提交出去的表單資料將會同時在網頁地址（URL）欄顯示。使用get方
法時，對傳送的資料有限制大小。
ypost的使用時機：當提交的表單資料較為敏咸或個人資訊時，會使用post方法
屬性。當方法屬性設定為post時，提交出去的表單資料不會顯示在網頁地址
欄。使用post方法時，對傳送的資料沒有限制大小。
若圖設計一個含文字方塊、下拉式選單等表單功能的網頁。
|程式碼檔名：E_2_1.himl
1_<!DOCTYPEhtml>
su公司
3<body>
4<p>輸入個人基本資料與簡述個人投資經驗：</p>
5”<formaction="personaldata.py"”method='"post'>>
6dagoV
7<legend>個人資料：<legend>
8姓名：<inputtype="text"name=name"><br>
9帳號：<inputtype="text"name="id"><br>
10密碼（至少8碼，含英文大寫與數字）：
11。<inputtype="password"”name="pwd'">>
12”加密：<keygenname="security'">><br>
13性別：<inputtype="radio"name="gender"value="male"checked>男性
|14。<inputtype="radio"name="gender"value="female">女性
|15<inputtype="radio"name="gender"value="gender_other'憲其他<br>16學歷：

17<select>

18。<optionvalue="phd">博士</option>

19。”<optionvalue="master'"碩士</option>

20”<optionvalue="undergrade">大學</option>

21。<optionvalue="senior'>高中職</option>

S人value="other">其他</option>

23~</select><br>

24出生年月日（西元）：

人吧name="bday'"><b說

26E-mail：

27。<inputtype="email'name='"email'><br>

28</fieldse選

29。”<fieldse選

30”<legend>投資經驗：</legend>

31<inputtype="checkbox"name="inv_exper"value="house"checked>房地產
32。<inputtype="checkbox"name="inv_exper'value="stock'>股票
33。<inputtype="checkbox"name="inv_exper"value="fund'">基金

34<inputtype="checkbox"name="inv_exper”value="warrant>權證<br>
35。<inputtype="checkbox"name="inv_exper"value="futureoption'>>期貨選擇權
36”<inputtype="checkbox"name="inv_exper'value="bond">債券
37。<inputtype="checkbox"name="inv_exper'value="savings'>定存<br>

38_<]abelfor="writing_exper'>個人投資經歷簡述：</label><br>

39~<textareaname="message"”rows="10”cols="30'>

40</textarea>

41</fieldset><br>

42。<inputtype='submit之

43。<buttontype="button"onclick="alert（HelloHTML510">button送出!</button>
44~<inputtype=reset>

45</form>

46~</body>

47。</htm只|程式說明

此範例為使用HTML作一個基本的表單資料頁面，會看到我們將各項需要輸入
的<input>都放在第5列至第45列的<form>元素裡面，主要是希鹿讀者可以練習各
種不同情況下使用者輸入<input>的使用方法，需要注意的是第8列的<br>元素，在
HTML是換行的意思，否則所有的輸入表格都會列在同一列，適時的加入<br>能夠
讓整體排版更加流暢。

第42列的<inputtype="submit'">，在HTML上是送出的按鈕樣式，當使用者按
下後會將第5列至第45列<form>元素裡頭的所有的<input>元素，用定義的name
來當作物件的key，value為<input>的值，傳送到第5列<form>裡頭action屬性所
定義的後端檔案位置。而在第43列的<button>只是一般的練習按鈕，onclick屬性是
指當「點擊」事件發生的時候，要去執行裡頭的JavaScript指令，在此就是彈出一個
提示視窗，上頭有"HelloHTML5!"此文字。

最後第44列的<inputtype="reset">在HTML畫面上也是一個button樣式，但當
使用者按下後，會將第5列至第45列<form>元素裡頭的所有的<input>元素裡頭的
值做清空。

[執行結果
ts
和生本太中eeEL全|：
su--加
全|
和姓名」
帳喜：」』
加碼，舍其交大下與數字）：下加348三晤可了
二•男性女性基地上
區生//一|
大作|!加
<澡店狡婦訕只時U殼店
c尖生宮說机
了
|
|
[De點區IIE圖設計一個整存整付財務試算表網頁介面。
|程式碼檔名：E22.himl
1_<!DOCTYPEhtml>
2<html>
3“<body>|
4_<p>整存整付試算表：</p>
5<form>
6<fieldset>
7[<legend>存款資訊：<legend>
8[存款金額：<inputtype="text"name="amount"placeholder="存款金額補<br>|
9年利率（%）：<inputtype="text"name="rate"placeholder="年利率（%）"><br>|
10期數（年）：<inputtype="text"name="period"placeholder=="期數（年）"><br>
11本利和：<inputtype="text"name="result"placeholder="本利和>
12</fieldset>
13。<buttontype="button"onclick="alert（'試算'）">試算!</button>
14~</form>
15</body>|
16</htmb|
|程式說明|
第6列<fieldset>標籤為當表格中資料過於龐大複雜時，可將表格中的輸入資料
分組，這有助於顧客輸入資料。第7列<legend>為<fieldset>標籤的標題。|
[執行結果
章
Dansymethodhtm”xx人
c[eeZeuassoseoemmesdnm外el
整存整付試和表：|
諾言寺。」
名本1
年利中99：隆dg|
|期數（年）：開數（年）
計杞和：茲8和喲」人1放加間蟬中他8給
本：
1.”設計一個用作註冊使用者帳號的表單。
各如且全續
口ELx2間
fooeENR：人em回
註冊頁面|一
使用者名稱
T|1||[|
使用者名稱可以包含任何文字或數字，但不包含空白!
|E-mail
|
請提供電子信箱
加有
|
密碼最短至少要4個字以上!
確認密碼
li
請重新輸入密碼
[WE
_y設計一個用來查詢股票代號/名稱的表單。
MEI二
口語x和>
；opegsA：人en國田押加號
網頁讀取即時股價資料
讀取即時股票資料.
說
起始日：ot7090上加加生一
資料頻率：凶日@秒
[守]3.。設計一個信用卡付款的表單。

加加加還ee一lee
口作舞3.htmlx多

個oopegSN女@向話回：
信用卡付款表單
付款方式
請選擇付款方式
信用卡卡號信用卡到期日

二|ie

帳單資訊：

名字姓氏城市

|一一一二

和|帳踢地址郵遞區號

_LT號

|國家電話號碼
[七]CHAPTER

人WII
資料型別

3-1JqvosScript在Web網頁的角色

3-2撰寫第一支JgvgsScript程式

3-3變數

3-4資料型別

3-5字串處理方法

3-6資料運算

3-7”JqvqsScript顯示方法

3-8JSON資料交換格式4JavaSeript是網頁的腳本（Seripg）語言，具有邏輯性的程式語言，前述的HTMLS
與CSS本質是屬於網頁標籤。本章會簡介JavaSeript在動態網頁設計的角色，之後表
介紹如何撰寫第一支JavaScript程式，以及變數（Variable）命名規則、資料型別、資
料運算以及JavaScript在網頁的顯示方法等。
$3-1JoqvqScripf在Web網頁的角色
HTML可以呈現靜態的網頁內容，若要做到與使用者互動的動態網頁就必須才
配JavaSeript語言。JavaScript是腳本語言，不需要編譯器即可執行程式碼。程式吉
行需要直譯器-瀏覽器（IE、Chrome、Firefox等），一列一列由上往下執行程式碼。
JavaScript的語法可以插入HTML之中，達到動態產生HTML內容元素或動態產生
CSS代碼，以達到網頁的多元互動性。
客戶端（cClient）藉由瀏覽器（Browser）向Web伺服器（Server端提出網頁連線服
務的要求，伺服器端確認後會將HTML網頁內容與JavaScript程式碼下載並回應給衝
LULEEPELE
伺服器端，減少資料在網路傳送的次數、減少伺服器端的運算負荷，並提升Web架
構的運算效能。
請求網頁
瀏覽器妥務web伺服器
Browser/ClientServer
執行客在館
回應客戶銷的計
JavaScript程式的
網路內容MY由

和撰寫第一支JGVQSCripf程式

要在網頁中放一段JavaScript的程式碼，要用<script></seript>，並在此成對標籤
中寫入JavaScript的程式碼。
加說還設計一個含有alert（）之JavaScript網頁。
|程式碼檔名：E3_1.himl
1<!IDOCTYPEhtm上說
2_<html>
3<head>
4八三叉page</title>
5</head>
6[<body>
7<hl>Helloworld</hl>
8<scripttype="text/javasScript'一
9alert（"ShowMessage）；
10</script>
11_</body>
12_</html>|
|程式說明

第8列至第10列是HTML的<seript>元素內容，意即在此HTML頁面插入一段
JavaSeript語法，所以第9列就是呼叫JavaScript的內建函式，彈出一個含有文字訊息
的提示視窗。|執行結果
歷時上
LELx吧
xo3全還Go
加上這個網頁顯示：多全
|ShowMessage
加到|
1ClL|||||||||!||!|||!」|
|三在等候pxmoatads.com.
按下確定後會出現Helloworldo
二加加持反和
口ExamplepageX|
<cn|lofe//D/cloudstation/LisAte如轉0@：
到國几加生國加
HelloWorld
$3-3變數
在介紹程式設計之前，先講此程式語言的變數命名規則，避免不當的變數命名
成錯誤，也養成良好的變數命名習發；另外也將介紹如何將字串或資料運算的結果寫
到網頁中。在寫JavaScript程式之前，有以下兩點要提醒：
1.程式碼每列結尾要加分號「；J。
2.註解用「//」，若要多行註解請使用「/*」與「*/」，前後多列括起來。
3-3-1變數命名規則

變數的目的是儲存資料，或是把運算結果儲存於某變數中，後續在使用時可以直
接呼叫此變數，即可取出儲存於此變數的值。JavaSeript的變數需要先使用var保留字
做宣告動作，可設定初始值如下：
varbuy=100；

例如：宣告buy變數，初始值為100。

JavaScript的變數命名可以英文、數字與底線組合而成。

變數的命名規則如下：

y第一個字元必須是英文字母或底線「_J。

y不能使用數字當開頭。

y字元之間不能有空格。

y變數名稱可以用底線，但不可用減號「-」與句號「.j。

y不要使用特殊符號，例如：%、#、@等。

y不建議使用中文命名。

y大小寫有區別，例如：Agent與agent視為兩個不同的變數。

y建議避免單獨使用的名稱：「I」（小寫是i）、TL」（小寫是1）、TO1（小寫是

o），乃因三字在字型視覺上，與數字的1和0容易混淆。

y變數名稱不能與JavaScript關鍵字（見下表）與未來保留字（見下表）或函數

名稱相同（見下表）。加JQvoScripf關鍵字，
區Jgvgscripf未來保留字
128
131_332_
為提示

JovqScript的未來保留字是將來有打算或有可能列為關鍵字。
3-3-2將字串或運算結果寫到網頁

JavaScript可以使用document.write（）方法將字串或運算結果寫到網頁中，除了可
以顯示字串外，也可以處理變數與HTML標籤。

JavaScriptdocument.write（）語法：
document.write（"放要顯示的字串"）；|範例3.2|在網頁中設計一個計算報酬率的網頁。計算報酬率：例如，買進價
100元，賣出價120元，報酬率=（賣出價-買進價）/買進價。
|程式碼檔名：E32.himl
1_<!DOCTYPEhtml>
2<html>
3<head>
上八三及page</title>
5</head>
6<body>
7_<scripttype='teXxt/javascript'>
8_//算術運算
9varbuy=100；
10varsel1=120；
11varroi=0；
12roi=（selL-buy）/buy；
13document.write（"報酬率="十roi+"br/>9）；
14</script>
15</body>
16</html>
|程式說明
第9列至第11列宣告變數並設初始值；第12列計算報酬率；第13列將"報酬
率刀的字串與變數roi相加後，再加上<br>標籤，之後顯示到網頁上。
[執行結果
國人
說tv|
_ropegP上上
邊作用程式圖網頁似訊圖鹿》
如=02|

$-4資料型別

學習每種程式語言之前，要先了解其資料型別，才能依其特性有效使用變數人謂
算。JavaScript提供多種資料型別，以進行資料運算。

常用的包含數值（nmumeric）、字串（string）、布林（boolean）、陣列（array）與物件
（object）。本節先介紹數值、字串與布林，陣列與物件後續章節會加以說明。
3-4-1數值

JavaScript數值資料型別包含整數與浮點數，儲存範圍沒有什麼差別。JavaScrift
預設是以浮點數來處理數值資料，可以使用NumberMAX_VALUE與NumberMIN_
VALUE顯示儲存範圍。

數值的最大儲存範圍是1.7976931348623157e+308；最小儲存範圍是5e-324。
ok人若

一個以上的字元組合在一起，即為字串。字串前後可以使用單引號也可以使用信
引號，本書字串前後一律使用雙引號。輸入（inpu6）或輸出（print）數值時，JavaScrit
預設為字串。數值在字串前，會先做數值算術運算再轉換為字串，之後再進行與字中
相加的動作。若數值是在字串之後則是以字串相加處理，見如下程式碼說明。
3-4-3布林

布林值，0表示false、1表示tue。JavaScript提供3種適合布林型別運算的邏輯
運算：且（and）、或（or）與非（not），相關討論見下節。葉到區區點示範使用整數最大範例、字串以及布林值的操作。
|程式碼檔名：E33.html

1_<!IDOCTYPEhtml>

2<html>

3“<body>

4_<scrip>

ouvarx=1；

6vary=0；

7document.write（"整數的最大表示範圍="十NumberMAX_VALUE+"</br>）；

8document.write（"整數的最小表示範圍="十NumberMIN_VALUE+"</br>9）；

9document.write（"2000十300+Lexus三：

10document.write（2000十300+"Lexus"十"br>9；

11document.write（"Lexus十2000十300三）；

12“document.write（"”Lexus"十2000十300+"</br>9）；

13documentwriteCX三1二09Xandy二十（太7）二"br；

14document.write（X三yy三0Xory二二（1y）+br）

gg品e+

16</scrip記

17</body>

18</htmb>
|程式說明

在此範例的第7列至第15列，皆是輸出JavaScript的運算式以及邏輯式的判別

結果，需要注意的是document.write裡頭要放字串（String），因此字串的相連我們使用
「+」號來作串接。|執行結果
一
口中也x多
hopegsbA圖Ge
回癌語獸王于加輻志加可要工容襄國>
|整數的最大表示範圍=1.7976931348623157e+308
整數的最小表示範圍=5e-324|
|2000+300+Lexus=2300Lexus
Lexus+2000+300=Lexus2000300
x三1；iY二0，xandy三0
|是|
Te|
[
$-5字串處理方法
JavaSeript提供多種常用的字串處理方法包含字串相加、搜尋、取出、取代、
大小寫轉換等。以下說明範例的字串變數名稱假設為strobj，字串方法的使用格式
如下。
strobj.方法名稱0
3-5-1”字串相加
字串相加可以單純字串變數相加。在字串雙引號前後加入空白，以區別字句。
strobj1+strobj2
3-5-2計算字串長度
length是JavaScript的內建函數可以計算字串的長度，含字串內或字串前後空白，
都算一個位元。語法如下：
strobj.length（）3-5-3搜尋字串

可以使用內建函數seareh搜尋某字元在字串中的位置，大小寫必須相等。字串
中的字元是有順序性的，索引值從0開始編。例如：第5個字元的索引值是4。語法
如下：
strobj.search（"搜尋目標9）
3-5-4”大小寫轉換

toUpperCase函數是小寫轉大寫；toLowerCase（）是將大寫轉小寫。語法如下：
strobj.toUpperCase0）
strobj.toLowerCase（）
3-5-5”取出某索引值的字元

charAt函數可以取出指定索引值的字元。語法如下：
strobj.eharAt（字串索引值）
3-5-6取出部分字串

JavaScript友許取出字串的部分內容，指定開始（start）與結束（stop）索引值位置。
語法如下：
Strojb.substring（start，stop）
3-5-7取代字串

找出舊字串（old），取代成新字串（new），大小寫必須相符。語法如下：
strobj.replace（old，new）加也圖示範字品的相加、取值與轉換的操作。
|程式碼檔名：E34.himl
1_<!DOCTYPEhtml>一
u人AV|
3”<body>|
*AV|
5varx="Hellol；]
6ge
7document.write（"x三hello；y三JavaScript"十"</br>9）；|
8document.write（"x與y字串相加二"十X+y+"</br>9）；
9document.write（"y字串的長度="十ylength十"</br>9）；
10document.write（C"x字串出現o的位置="十x.search（"o9）十"</br>9）
11document.write（"x字串轉換大寫="十x.toUpperCase0+"</br>9）；
12document.write（"x字串轉換小寫="+十x.toLowerCaseO0+"</br>9）；
13document.write（"取出x字串第5個字元="十x.charAt（5）十"</br>9）：
14document.write（"取出y字串第4到10個字元="十ysubstring（4，10）十"</br>9）；
15document.write（"搜尋出x字串的!，取代為~="+8|
LE|
17</body>
人號上有
|程式說明
此範例為練習前端網頁處理「文字」經常使用到的一些方法，而這些方法為內奸
JavaSeript的函式庫，因此不需引用任何外部的library即可使用這些快速、方便的函
式。[執行結果
|加品[|歡玉呈加閃玉和
詞口E34htmlx
fc2c人lofezzpzco.如轉Go
|抽誠用生式加網頁俯記圖証彈自林這結日從IE國人》
x三hello：y三JavaScript
x與y字串相加=HellolJavaScript|
y字蟬的長度=10|
x字串出現o的位置=4|
x字串轉換大寫=HELLO!
x字串轉換小罕=hello!
取出x字串第5個字元=!
取出y字蟬第4到10個字元=Script
搜尋出x字單的!，取代為~=Hello~
3-6資料運算
JavaScript提供多種資料型別以進行數值運算，本節將介紹運算式，包含算術運
算、關係運算、邏輯運算與指定運算。
3-6-1]算術運算子
JavaScript可藉由數值或變數的算術運算，以直譯方式將計算結果即時呈現。算
術運算子（見下表）：
運算子切入戰運算符號與盡數|範例3-5|示範資料運算的加、減、乘除、遞增與遞減等。

|程式碼檔名：E35.html

“1_<!DoCTYPEhtml>]
2<html>|
oAV|
aaAgeV-
ogo|
6varb=3；|
7“document.write（"a三9；b三3十br；|
8document.write（"加法運算：a+b=="十（a十b）二"br；|
9document.write（"減法運算：a-b="十（a-b）二"br；i
10document.'write（"乘法運算：a*b="十（ab）二mbr>9）
gg除法運算：a/b="十（a/b）十"</br>0）；
12document.write（"取餘數：a%b="十（a%b）+"</br>9）；|
13document.write（"遞增運算：二la三"十十a十mbr>0）；|
14document.write（"遞增運算：af二=十十十br|
15document.write（"遞減運算：--b=十--b++br>9）；|
16document.write（"遞減運算：b--Ag
17</seript>
18</body>|

和sm

|程式說明

此範例為練習前端網頁處理"數字"常用的算術尼輯，不論是整數或是浮點數，"
JavaScript皆可作一些基本的算術運算，讀者可以試試使用浮點數（float）/正整數（im
會發生其麼事喔!|執行結果
點aa
電口Ce2x
htopegsBAP人回Co=
|生產用旺式加網頁快訊圖產。單自訂連結號碎訓圖>》|
a二9：b二3人
加法運算：a+b=12和
減法運算：a-b=6=
乘法運算：a*b=27生
除法運算：a/b=3|
取餘數：a%b=0中
遞增運算：十a=10=
章上
遞減運算：-b=2||
遞減運算：b--=24
3-6-2”關係運算
關係運算子（見表）主要是比較兩個變數值之間的大小或相等關係，例如：判斷
兩個變數是否相等用雙等號（三==）。
嶼約示範資料的關係運算操作。
|程式碼檔名：E36.himl
ASes
2_<html>
3<body>全全
5vara=9；
6varb=3；
7document.write（"a三9b三3十br）
8document.write（"大於運算子：a>b="十（a>b）+"</br>
9document.write（"小於運算子：a<b="十（a<b）二"br）；
10document.wrlte（"大於等於運算子：a>三b=="十（a>三b）十br
IIdocument'write（"小於等於運算子：a<b="+十（a<b）十AV
12document.write（"等於運算子：a二b="二（abbr
13document.write（"不等於運算子：a!=b="二（ab）二br）
AS本V
15</body>
16</htm選
『執行結果
下
吃上3.6.htmlX
人opeg5xbAP上圖Ce_
3產用程式台潮池百時國加當加品當誰一一裕同國>》
a=三9；b=3
|大於運算子：a>b=tme
|小於運算子：a<b=false
大於等於運算子：a>=b==true|
自小於等於運算子：ab=false|
等於運算子：a一b=false
|不等於運算子：3!二b==true3-6-3邏輯運算
邏輯運算是在計算變數之間的邏輯關係，適用多個條件情境下，可判斷滿足某
些條件下該採取什麼動作。JavaSeript常用的三種邏輯運算子，包括：或、且、非（見
表）。
讓功能說明
|and|「且（and）的運算，所有運算元皆為真，才為真。
|not「非（no0的運算，扣為真轉為假；為假轉為真。
攻2划娃示範資料的邏輯運算操作。
|程式碼檔名：E37.himl
1_<IDOCTYPEhtml>]
u公司
oAV
Aa人gm
5vara=9；
|6varb=3；
7document.write（"a三9b三3十mbr>9）；
emdocument.write（"或（or）運算：a>10||b<5="+（a>10|lb<5）+AV
9document.write（"且（and）運算：a>10&&b<5="+（a>10&&b<5）+9</br>9）；
非（not）運算：1（a0=la三b+9<br>9）；
11doeument.write（"互且（xor運算：a>10^b<5="+（a>10^b<5）+9sbrm）；
12~</scrip馬1
3<body>|
1mp中生|[執行結果
癌症加各神玉藹菩天剖說歡記ml配售囊
口中“三x史
reopmco_
和產用程式加紡頁快訊圖宣戰加推口從正匯入>
a三9：b=3
或（on運算：a>101|b<5=true
和且（and）運算：a>10&&b<5=false|
和非（not）運算：!（a!二b）=false
互且（xor）運算：a>10^b<5=1
-N||||）））二
3-6-4指定運算
指定運算子除了等號「=」為指派功能外，其他運算子都可以與其他算術運算、
邏輯運算等搭配（見表）。
讓功能說明：市押罕調江欄弦
加攻拓如所本還
6A-1-：3示範資料的指定運算操作。
|程式碼檔名：E38.himl
1_<!DOCTYPEhtmb>
“2<htmb>
3<body>
4_<script>
5vara=9；varb=3；s=true；全false；全581
6document.write（C"a三9；b三3；s三true；t二falsei"十br
7document.write（"a二三b=十（a+b）+br
8document，write（"a三b=十（mb）十br；
9document.write（"a二b=十（ab）十"br；
10document.write（"a三b=十（a/b）十br；
11document，write（"a%三bb十（a20=b）十"br
gm
8各Amn+（人e+人
Egg
15document.write（"s紅t=十（sbr；
16全ge人
人9上-
18</body>
|19~</htmb>
|程式說明
在此範例要注意的是，這邊的指定運算指的是：將算術完的結果指定回去給原變
數。程式執行的順序是由上而下，a在第5列宣告的值為正整數9、b宣告的值為正整
數3，當執行完第6列a+=b的時候，a已經變成了12，以此類推往下的變數運算就是
用新指定的值來做運算。|執行結果
|說|Ping-Chen生生XX
口中三x，|
opsg5b8P上人轉COe@-
：產用王式品網頁歸訊圖重啟自訂這結口從EE其入>
aa三9.b三3.s三trmue：t一false
a+三b==12
一
olrHu》
ohrene
osirene
f>>=g=2
f<<三+
八Heho
ele
yenc|
3-6-5資料型別轉換
JavaSeript提供數值與字串轉換的功能（見表），可以將參數在二進位、八進位與
十六進位之間做資料型別的轉換；數值型別如整數、浮點數等轉換成字串，或將字加
轉換成數值型別。
回扣大全
|parseFloat0。ff「傳入的參數轉成浮點數。
_g8EG「傳入的參數轉成整數資料型別。
|Number0ff「傳入的參數轉成數值資料型別。
|String0|傳入的參數轉成字加型別。
wnggAr若圖示範資料型別轉換的操作。
|程式碼檔名：E39.html
1_<!DOCTYPEhtml>
2<htmb>
3<body>
*AC本
5varn27；varmm地2.14160；k20；bin二"10100；
6document.write（"n與m原資料型別="+typeoftn）+
7與"十typeoftm）二"br>9）；
8document.write（tVn二mm十（nmm）二br
9nm=parseInt（nm）；m=parseFloat（m）；
10document.write（"n與m轉成整數與浮點數後相加="十（n+m+br
11w=m+n+100；
12“document.write（"Ww三m++n+100二十WP<br
13ww三String（w）；!
14document.write（"w新資料型別="十typeof（w）+"</br>）；
15document.write（"k=20轉成二進位="十ktoString（2）+"</br>9）；
16document.write（"k=20轉成八進位="十k.toString（8）十"</br>9）；
17document.write（"k=20轉成十六進位="+十ktoString（16）+"</br>）；
18</scrip和
19</body>
LE：
|程式說明
雖然JavaScript在宣告上是屬於動態定型語言，但是在變數值的前後如果加上單
引號或是雙引號，在型態上一律都是「字串J，因此當我們要使用這些字串的數字做
運算的時候，一定要先將這些字串轉為相對應的整數或是浮點數，可參考第9列。『執行結果
則擴“tfMsttugsn[不回）|關副
estcxN
frop
說回副而培品網頁快訊圖量。論自訂連結1
an與m原資料型別=stnng與sting
n+m三22.1416
n與mm轉成整數與浮點數後相加=4.1416
W三m+n++100三104.1416
新資料型別=string
字串轉成數值=500
k=20轉成二進位=10100
k=20轉成八進位二24
上=20轉成十六進位=14
$-7JoqvdqScript顯示方法
JavaScript可以顯示資料的方法共有4種包含：innerHTMLO，document.write（），
alert（）與console.log0。其中，最後兩種alert（）與console.log（）是常用於程式設計除錯
的技巧。
3-7-1innerHTML
將資料寫入到網頁標籤內，可使用innerHTML。可以使用document.getElementByHd
（id）方法取得HTMEL標籤的id，並使用innerHTML屬性將資料寫入到指定id的標
籤內。
程式碼檔名：E3_10.himl
1_<!DocTYPEhtml>
2_<htmb>人
ouAV
生NM全
6_<serip選|
7document.getElementById（"result"）.innerHTML二9922；
8_</script>|
9_</html>店as

|程式說明

第7列使用document.getElementById方法"再利用innerHTML此屬性將9922顯

示在指定id為result的標籤上。

3-7-2“documenmf.wrife（）

document，write（）方法是將網頁內容或JavaScript程式碼寫入到網頁內文。如果要

顯示字串與數值型別的變數可以直接使用+號做，數值型別的變數會先轉成字串再與
其他字串相加後顯示。若要顯示中文可以設定charset屬性，指定使用UTF-8顯示中
文字。

|程式碼檔名：E_311.himl
1_<!DocTYpEhtml>
2_<html>
3_<body>
4_<scrip選
5varTAIEX=9922；
6document.write（"2017年3月22日台股大盤指數收盤"+TAIEX+"點9；

7<seript>
8_</body>
St

|程式說明

第5列設定一個變數TAIEX，第6列顯示字串加變數運算的結果。|執行結果
合生有剖凍有還
口testhtmlx/
個CC全|fie//D7av全|圈0：
下商用程式加網頁快訊圖主誤自訂之結y
2017年3月22日台股大盤指數收盤9922點
3-7-3qlerft）
alert0方法用在以訊息視窗對話方塊顯示特定的提示字串，配合確定按鈕。程式
設計師常使用alert（）訊息對話方塊來確認使用者輸入的資料是否正常。此功能是用在
程式設計階段，督試找出錯誤並修正，待程式功能完成正確後，即可刪除此列程式
碼；否則會干擾使用者讀取網頁的流程。
3-7-4console.log0）
console.log（）方法是將資料寫入瀏覽器的console視窗。以console.log（）取代
alert0讓JavaSeript程式碼除錯步驟更簡潔，少了讓alert（）視窗出現後要開閉視窗的
動作。若要檢查某變數的內容值可以放入console.log（）參數內，在瀏覽器視窗中如：
chrome中按下快速鍵F12或使用組合鍵「CtrlrShiftriJ，再點選Console即可進入
console視窗見下圖六
e
S1top了[lterDefauktlevels六
9922上312.htmli6
〉一|程式碼檔名：E3_12.himl
1_<!DOCTYPEhtml>
2<html>
3“<body>
nAV
5console.log（9900+22）；
6_</script>
7</body>|
8_</html>1
|程式說明
第5列加入console.log，可以使用chromeg顯示執行結果。
[執行結果
WU
|13和全
fop加
四加了店
|歡戰」EementsConsole_>|3x1|
1仿窗topy名Preservelog
9922test.，html：6
則
$3-8JSON資料交換格式
不論生活與工作，現代人離不開網路，程式設計也不能只會寫單機版（只能單機
執行的程式），而是要會寫網路版的程式設計。以Web為架構的網路程式之間，前端
瀏覽器（browser）與後端伺服器（server）需要很頻繁的資料交換（或傳送），接下來我
們將介紹目前在程式中普遍使用的資料交換格式一JSON。3-8-1JSON特性
JSON（javascriptobjectnotation）是由javascript提出一種目前最受歡迎的資料交換
格式。JSON特性在於：
y資料交換時具標準化格式，對持久性（persistence）傳輸資料的程式效率高。
>JSON資料結構多元化且簡潔，以JSON做資料交換相對來說使用較為輕鬆。
>延用XML樹狀結構，JSON定義的物件也是樹狀資料結構，提供的資料型史
包含數值、字串、陣列等，常用的資料型別都已包含。
>JSON具可攜性（portability），使得不同的資訊系統與網路平台之間資料轉移有
標準規則且變得容易。
>JSON雖獨立於程式語言之外，但仍以程式語言慣用的資料型別表示，使得各
種程式語言都能應用JSON格式做資料交換。
3-8-2JSON使用範例
在程式語言中常要將處理的資料以物件來包裝，以公司基本資料為例，JSON的
表示式如下：
《
arv
StockName"："ASUS
RE
二人209530000000，
時全CN全
）
JSON的資料格式很類似Python的字典，以鍵與值配對成一組，前後用大括弧{
）括起來。
ww可以透過以下規則來建立JSON物件：
y物件是用{）來輸入資料。
ykey（鍵）與value（值）是成對的，中間透過"："來區隔。
ykey要前後用雙引號""括起來。
y陣列可以用[]來輸入資料。
物件或陣列的value值（即資料型別）可以是以下型別：
y數字（整數或浮點數）
y字串（使用""括號）
y布林（Boolean）（其內容為true或false，且全部小寫）
yyNULL（空值
3-8-3JSON資料結構描述
即使資料再詳盡，傳送的資料也可能有誤，例如要一顆橘子，卻送一顆柳丁。此
為合適性驗證（conformityvalidation）問題，可能出現以下問題：
1.傳送資料者完成任務，不覺得有誤。
2.透過網際網路傳送資料給接收者，因為資料內容量多可能需要一些時間。
3.收到錯誤訊息，傳送的資料不符合接收者的需求。
4.修改錯誤後重複以上步驟。
帶有驗證機制的資料交換結構之處理程序可以改善以前資料傳送錯誤的時間成
本，此驗證機制可以對傳送方或接收方做資料驗證機制的服務。
回對傳送方
1.依雙方事先的協定，找出並修正資料傳送前可能的錯誤給傳送者。
2.傳送資料者做傳送資料的任務。
3.透過網際網路傳送資料給接收者，得到正確的回應，完成傳送任務。加對接收方
|
接收方把JSON的結構描述當第1線守門員，檢查傳送過來的資料合適性，疾|
以下檢驗：|
1.資料型別是否一致，例如：可以指定是數值或字串。
2.資料是否為必要的資料要求，例如：指定某些資料必須傳送，HE
LEEm
數、最大值、最小值等。|
可以使用定義物件的屬性來規範資料傳送的合適性：|
{
"schema"："http：//json-schema.org/draft-04/Schema#，
Ptle"："companyinformatione，
"properties"：（
StockID"：（
type"String
Dj
StockName"：（
type"String
j
"Listed
人type"："booleanm
j
"Marketvalue"：（
type”："number
7
TE
typee"String
一
和
"required"：[|GE
條上5
mTEL"
]
）
其中，s$schema是用以描述資料本身的格式，可以提供程式設計師或電腦讀取的
文件。JSON的結構描述比較方便做合適性驗證，可供系統自動檢驗資料傳送的正確
|性。
參考資料：
>https：//“www.w3schools.com/html/
http：//www.wibibi.com/info.php？tid=188
yyhttp：//harttle.com/2015/08/03/form-submit.html
+將一字串a="Hello"與另一字串b="JavaScriptt!"，兩字串相加後，在頁面上、
console.log（）與alert（）這三種方式顯示出來。
2.。試將一串任意大小寫的字串，分別以全部大寫與全部小寫顯示出來，也將字串長
度在頁面上顯示出來。
3.”試使用replace（）函數，將字串"HelloWorld!"取代成"HelloJavaScript!"。
4.”試計算一個上底為10，下底為15，高為6的梯型面積，計算完在頁面上顯示
出來。
5.。”試計算一個圓的半徑為15，圓周率為3.141592，計算出圓面積與圓周長後，在
頁面上顯示。6.”試撰寫一個程式，計算身高體重指數（BodyMassIndex，BMI），BMI是一種用
於大眾健康有關是否為肥胖的測量指數，只要輸入身高與體重即可算出BMI，
當身高（H，單位為公尺）為150公分，體重（W）為50公斤時，計算出BMI
值。計算公式如下：

如
BMI=7一

7.”將華氏溫度80度轉換為攝氏溫度在頁面上顯示。!
攝氏溫度=5/29*（華氏溫度-32）

8.將一串JSON格式的資料tnamee：Tom"agee：18，"city：NewYork"，"phonee：
"0912345678"}，透過Javascript的JSON.parse（），將json格式轉換至txt格式在
頁面上印出。

高提示
vgrobi三JS0N.porse（有效的json字串）
輸出範例：

ESEl說3
口位8htnxNM!
<>oo[ems2c對胃
姓名為，Tom日
|年紀為，18|
居住地為，NewYork|
電話謝，0912345678|和本
程式設計

4-1邏輯判斷

4-2重覆迥圈本章介紹如何撰寫JavaScript的邏輯判斷（ifelse）、重覆迴圈（forwhile）拉
LIULELT
RSSLLE
管實務的案例，增加程式撰寫的有趣性。

4-1邏輯判斷

BRLE
令；G）書狀ielse；（switehcase。主要功能是用於判斷不同情境來採取不同上
法。在並後面加上判斷條件，指令集寫在大括弧（）符號內。

4-1-1三

最簡單的if指令，當判斷條件式成立時（trme），即執行指令區的指令，逐列執和
指令1到指令ni若判斷條件式不成立時（false），則咯過指令區，結束軍輯判斷到
一列o

註語法如下：

註（判斷條件式）（
指令1#當條件成立時執行本指令區的指令
指令2
指令n

）

廬判斷流程圖見圖）。其中，判斷條件式可以是邏輯運算式。若判斷條件式
真（tue，1），表示該條件成立，接著執行站指令區內的指令直到結束。若判斷條ff
為假（false，0），跳過指令區直接到結束。True人False
247
判斷流程圖

|範例4：1判斷年齡（age變數）大於18，則印出"符合開車條件"字串。
<scrip忌
Varage=20；
放（age>18）（

document.write（"符合開車條件0；
）
人點已V
4-1-2ifelse

ifelse指令適用於有兩種條件擇一的情境。當判斷條件式成立時（trme），執行論
以下的指令集合，直到else前一列結束。接著跳過else指令區，離開邏輯判斷到下一
列指令（若還有指令要執行）結束ielse程式；反之，若判斷條件式不成立（false）
時執行else以下指令區中的指令直到結束。ifelse指令的語法如下：
註（判斷條件式）（
指令1當條件成立時執行本區指令
指令2
指令n
}elset
指令1當條件不成立時執行本區指令
指令2
指令n
）
ifelse判斷流程圖（見圖）。若判斷條件式為真（tme）時，表示該條件成立，接
著執行if指令區內的指令直到結束。若判斷條件式為假（false）時，則跳過放指令
區，直接執行else指令區後結束並離開尼輯判斷。
TrueFalse
判斷ff條件式
執行和執行else
指令區指令區
ielse判斷流程圖判斷年齡（age變數）大於1，則印出"符合開車條件"字串，否則
印出"違反開車條件"字串。
<script>二計
Varage=20；
if（age>18）（
document'write（"符合開車條件9；
jelset
document.write（"違反開車條件9；
）
人人
_或攝氏）溫度，計算攝氏（或華）溫度。
公式：攝氏溫度=（5/9）*（華氏溫度-32）。（注意：小數點取一位）
|華氏溫度=（9/5）*（攝氏溫度）+32。（注意：小數點取一位）
|程式碼檔名：E4_1.html
1_<!IDOCTYPEhtml>
2<html>
3”<head>
4</head>
5<body>
6_<p>攝氏華式換算器</p>
7<fieldset><legend>溫度轉換：</legend>
8<inputtype="radio"name="temp"value="1"id="Cel_Radio"checked>攝氏
9<inputtype="text"id="Celsius"name="攝氏"><br>
10。<inputtype="radio"name="temp"value="2"id="Fah_Radio">華氏
11一<inputtype="text"id="Fahrenheit"name="華氏><br>
12</fieldseb>
13“<br><buttontype="button"onclick="TempTrans（）>計算!</button>
EP
15<body>
16<seripb>
17functionTempTrans（）（118varc=document.getElementById（"Celsius"）.value；|
19varf二document.getElementById（"Fahrenheit"）.value；
20if（document.getElementById（"Cel_Radio"）.checked）（
21FtempCu
22document.getElementById（"result"）.innerHTML="華氏"+Ftemp+"度"；
23jelse（
24Ctemp三（f-32）*#（5/9）；
25document.getElementByIdC'result"）.innerHTML="攝氏"+Ctemp+"度9
26）
27
ML
29八寢日|
|程式說明
自訂函數TempTrans的範圍包括第17列至第27列，透過第13列的按鈕觸發滑
鼠單擊（onclick）事件來呼叫此函數，接著在函數內的第18列至第19列宣告變數，將
變數指定為上方文字框輸入的華氏與攝氏的值。
第20列用if的判斷式來判斷radio是否被選取（checked），如果判斷為是（true）的
話'則執行第21列至第22列進行華氏溫度的計算；判斷為否（false）的話，則執行第
23列內的else例外處理，進行攝氏溫度的計算。
『執行結果
dube國了3纏
<>Gvo[omezozcouds糾轉0
ELEL用林連結
上拉氏華式換算器
溫度轉換：
基站|上上
國
轉換後：華氏68度4-1-3ifelseif

ifelse放指令適用於有多種（兩種以上）條件擇一的情境。當判斷條件1成立
時，執行說以下指令區的程式碼，直到eseif前一列結束，其他指令區直接跳過，離
開本邏輯判斷。當判斷條件1不成立時，則判斷條件式2是否成立，若條件式成立為
trmue，則執行第1個else議條件式2以下的指令區的程式碼後，離開本邏輯判斷，以
此類推。當所有判斷條件式均不成立時，即執行else指令區的程式碼，而後結束本尼
輯判斷。

ifelse論指令的語法如下：
if（判斷條件1（

指令1當條件1成立時執行本區指令

指令n
jelseif（判斷條件2）（

指令1當條件2成立時執行本區指令

指令n
jelsef

指令1當以上條件式均不成立時執行本區指令

指令n
）4

ifelse聞判斷流程圖（見圖）。若議判斷條件式為真（true）時，表示該條件成
立，即可執行廬指令區內的指令之後就結束。若判斷條件式為假（false）時，跳過
許指令區，執行判斷else聞條件式，若else議條件式為真，即可執行else讓指令區內
的指令之後就結束，以此類推。檢查還沒有其他else議條件式，若還有就回到第i個
else論條件式，若所有判斷條件式均判斷完畢且不成立時，則執行else指令區後結束
並離開邏輯判斷。.（開維。）】。|開始檢吉第1個el判斷式
True2False檢查下一個al條件
第[個False
和一和
執行elif還有沒有True
指令區elif條件式
ielseif判斷流程圖
回有歡圖簡化版個人綜合所得稅試算
所謂「個人綜合所得稅」指凡有中華民國來源所得之個人，無論是否在中華晤
LEELEL
稅額功能實際應納稅額請依國稅局規定計算。以106年度綜合所得稅加算公式由
表（單位：新台幣元）參考如下：
綜合所得淨額同
|05%
|號
-399
和加上
一4330.001~10310.000台吧
10.310.001以上還間生一生呈本題採用累進稅制，依據使用者輸入淨年所得額（假設已扣除其他的免稅額），
後依級距與稅率計算應繳綜所稅金額。假設使用者輸入11，000，000，計算其應繳稅額
等於多少，累進稅的計算方式為不同的課稅級別乘上不同稅率再囚加，累進稅制的計
算方式示意（見圖四），合計的應繳稅額為3，645，000。

level1=540000*0.05

leve12=（1210000-540000）*0.12

leve13=（2420000-1210000）*0.2

level4=（4530000-2420000）*0.3

level5=（10310000-4530000）*0.4

人540000540001~1210000

38一

=27000中=80400+
levelllevel2

1210001~24200002420001~4530000

=242000六=633000

level3level4
4530001~1031000010310000萬以上
=2312000+=310500
和
level5
==3604900
累進稅制的計算方式|程式碼檔名：E42.himl
1_<!DocTYPEhtml>
2<htmb>
<head>
4<scripb>
5functionPersonTax（）（
6varincome=document.getElementById（"Text_NetIncome"”）.value；
7varlevel1=540000*0.05
8varlevel2=（1210000-540000）*0.12
9varlevel3=（2420000-1210000）*0.2
10varlevel4=（4530000-2420000）*0.3
11varlevel5=（10310000-4530000）*0.4
12。放（inceome<=540000）【//#條件1
13tax二income*0.05；
14jelseif（income<=1210000）（//#條件2
15tax二levell+（（ineome-540000）*0.12）
16jelse和（income<=2420000）【//#條件3
5tax三levell+Jevel2+（（income-1210000）*0.2）
18jelseif（income<4530000）{（//#條件4
19tax三]evel1+level2+leve13+（（income-2420000）*0.3）
20jelseif（income<=10310000）（/#條件5
21fax二level1+Jevel2+level3+level4+（（ineome-4530000）*0.4）
22jelse（
23taxrlevell+level2+level3+levelf+level5+（（income-10310000）*0.45）
k）
25document.getElementById（"result"）.innerHTML=tax+"元"：
26）
27</scrip寢
28</head>
29“<body>
xI簡易個人綜所稅試算：</legend>
31<labelfor="NetIncome">綜合所得淨額：</label>32<inputtype="text"id="Text_Netlncome"name="Netlneomer><br導1
33~</fieldse選|
34~<br><buttontype="button"onclick="PersonTax（）">計算!</button>|
ELEN：
36_</body>|
37~</html>8
|程式說明
自訂函數PersonTax的範圍包括第5列至第26列。在此範例的第12列至第24
列，皆是JavaScript中的ielseif的多重判斷式，如果符合條件則進行條件式內的運
算並結束，離開邏輯判斷。
『執行結果
7
|op6SCAN圖@|
放量窗用王式口生到國加四所曾說》
ELE
放呈生全加|
計算!
應繳稅額=3604900元
4-1-4swifch
switch用以多個選項的條件控制指令。當邏輯運算式的值符合某一選項case後的
檢查值時，即執行該ase後面的指令區，執行完畢即跳出switch敘述區塊。若邏輯
運算式的值沒有符合任何一個ease的檢查值，則執行default後的指令區。switch指
令的語法如下：switeh（變數或運算式）{
case檢查值1：
指令區；
break；
case檢查值2：
指令區；
break；
case檢查值nm：
指令區；
break；
default：
指令區；
）
點條國亂數產生1-6點，對應顯示國字的點數，例如產生1就顯示壹點等
|程式碼檔名：E43.himl
1_<!DOCTYPEhtml>主
2<htmlz
3<head>
4Aa鬧V|
5functionRandomNumber0（|
6varnum三Math.floor（Math.random（）*6）+1；|
7varpoints；
加switch（num）（）
9case1：
三5
各說breaky亡12case2：濕劑
points="貳點史
14break；
15case3：
16points="參點中
17break；
18or
廚記汐汐：
20break；
21case5：
22points=伍點站
23break；
24case6：
25points="陸點和
26break；
27】
28”document.getElementById（"result"）.innerHTML三（"本次="十points）；）
~
30</scrip記
31</head>
sA&y
33<buttononclick="RandomNumber0'">擲骰子</button>
全AV
35</body>
36</htmb>、
[程式說明
第6列為使用JavaScript中Math的方法。
Math.random（）可以隨機產生一個介於0~1的隨機浮點數，Math.floor（）可以進
行小數點的無條件捨去，Math.floor（Math.random0*6）+1則可以隨機產生一個1至6
的數字。第8列至第26列為switchcase的邏輯判斷式，第8列switeh後的括號內代表要判斷的變數，下面的每個case來判斷此數字為哪個值。需要注意的是通常會在和
個ease語句結束後都加入break指令，來代表此次switeh邏輯判斷的結束。
高還
條
|執行結果
、〔【@MenundsnJJca上回了
*opegBO一
表
擬毅子
本次=參點
區ZIEE紋設計一個下拉式選單選擇基金，依輸入的購買金額換算單位數，依
2017/03/24日的淨值為例參考如下：
基金名稱淨值（2017/3724）
忠萊德世界黃金基金ja
安聯收益成長基金和99
聯博-中國時機基金js9
|程式碼檔名：E.4_4.himl
加<!DOCTYPEhtml>
“2<html>
3_<head>
aa公司
5functionUnitsCompute（0（
eoVaritems=document.getElementById（"sel'）.selectedIndex；
!7varamount三parseInt（document，getElementById（"amt"）.value）；
en9case0：
10Units=amount/31.71；
1break；
12case1：
13Umits三amount/9.02；
14break；
15case2：
16Units三amount/15.09；
17break；
8
19document.getElementByIdC'result"）.innerHTML=（Units，toFixed（4）+"點0；
20）
21</scrip記>
22。</head>
AV
|24基金選擇：
25<selectid="sel"onchange="UnitsCompute（）'~
26”<option>貝萊德世界黃金基金</option>
27”<option>安聯收益成長基金</option>
28”<option>聯博-中國時機基金</option>
29</select><br>
30購買金額=<inputtype="text"id="amt"name="amount"value三"10000">
31<br/>換算單位數=<divid="result"style="display：inline；"></div>
SASSV
33_</html>
|程式說明
第6列以selectedIndex屬性來取得<select>的索引值，可以取得使用者在下拉式
選單選中的索引號。第8列將取得的索引號進行switehcase判斷。
第25列onchange事件，會在下拉式選單的值變換時進行觸發動作。『執行結果
|同間為加而還
be上
《<-onl|ofezpzc二：
圖泊合十呈地加國人
衝衝襄英語一
購買金額=|10000
換站單位數=1108.6474501108648點
4-2重覆迴圈
日常生活常需要做重覆性的工作，在程式語言中若需要一組指令重覆執行，則可
以使用迥圈來控制。迴圈每執行完一次，就會檢查是否到達停止條件。重覆迴圈包合
for與while兩種指令；for迥圈又分為單一迴圈與巢狀迥圈；另外，也將介紹comtints
與break的用法
4-2-1”單一for迴圈
重覆人性的工作若知道要執行的次數（回數），可以使用for迴回。明確的說，只要
知道要執行的次數，就可以使用fur來撰寫迴圈程式。若未滿足終止條件，則繼續革
行迴圈內1到n指令，直到滿足終止條件時，即離開迴圈。語法如下：
RE
指令1
指令n
）重覆迴圈有三個基本任務如下，配合迴圈流程圖如下：
1.計數器設定初始值。
2.檢查迴圈結束條件。
3.調整計數器的內容。
迴圈開始執行時的步驟：
步旺答設定計數器起始值與終止值以及遞增或遞減的數值。
ELELLE
步驟窟》繼續執行迴圈內的指令區。
由導入離開迥圈前，先執行計數器的遞增或遞減條件再回到步務2。若滿足結束條
件為ttue，即結束迴圈。
1設定計數器起始與結束條件
2計數器是桔ˋ\true
達到結束條人
zi離開迥圖
lse
3繼續婁行迴
點內指令區的
程式碼
單一for迴圈流程圖其33區講紡迴圈依序印出0到10，遞增2的序列值。
|程式碼檔名：E45.html
1_<IDocTYPEhtml>
2<html>
3.<body>
4AV
5/迴圈依序印出2到10，遞增2的序列值。
6forG=0；i<10；i-2）（
7LE
87》
9</scripb>
10</body>
11_<html>
|程式說明
第6列使用forloop迴圈，起始值設為j=0，當符合條件i<=10時，則會執行
document.write（i+"</br>"），之後每次i會遞增2，只要當不符合條件i<=10時，則會
離開此迴圈。
[執行結果
enmdtao回說詩人

口Fx/

fope

店國誤三惠品王國加>

0

2

4

6

8

10家IM江計算面積，試寫一個程式計算積分的面積近似值。
je+b。
其中，dx愈小，愈蟬近真實解，dx假設為0.00001。本例計算積分
面積的說明如下：
5
「St
人
n+
3六
信人
六3
fx）
1二
上入還
$議還還還
一一
q2夠-點回圖
和ll
25
積分計算面積示意圖|程式碼檔名：E46.himl
1_<!DocTYPEhtml>
2<html>
3<body>
4<h3>計算面積<h3>|
5_<script>|
6vardx=0.00001；vararea=0；Vary==0；VarxX；|
7for三2x<5；x+=dx）（|
8y=（Math.pow（x，2））+1；
9area=area+（y*dx）；
10）
11document.write（"面積=十area+e<br>9）；1
AS
AV|
14_</html>
|程式說明
第7列使用迴圈，起始值設為x-2，當符合條件x<=5時則會執行下方程式，之
後x每次都會遞增dx值0.00001。第8列使用JavaSeript的Math方法，經常用於進
行數學方面的運算，此範例的Math.pow（x，y）則可以取得x的y次方的值。
|執行結果
條全肌時用人回全人
全生
fop@
基產用程式品網頁歸訊圖生》
計算面積
面積=42.00015500007885|範例4-9|用迴圈處理字串，顯示中華民國金融監督管理委員會旗下的四個業
務局：銀行局、證券期貨局、保險局及檢查局。

|程式碼檔名：E4_7.himl

1_<!DOCTYPEhtm只

2<htmb

3<body>

4_<h2>中華民國金融監督管理委員會<h2>

5<h3>旗下四個業務局：</h3>

eAV

7varunits=["銀行局"，"保險局"，"證券期貨局"，"檢查局過；

8vartemp三"；

9var

10for（1=0；i<units.Jength；+）（

11temp+三units[訓7<br>5

垃#

13document.write（temp》；

14</scrip生

15</body>

16</htmb
|程式說明

第7列使用aray陣列，將銀行局、保險局、證券期貨局、檢查局當做元素存進

名為umits的陣列裡，units[0]則代表銀行局，unmits[1]則代表保險局以此類推。第10
列的迴圈，初始值i=0，迴圈的結束條件為i<units陣列的長度4，之後每次i都會
遞增1。|執行結果
加交還

口ooXX和
fop轉0e@
EL划問
中華民國金融監督管理委員會
旗下四個業務局：
銀行局
保險局
證券期貨選
徐查局

4-2-2集狀for迴圈

所謂巢狀迥圈是指迴圈內包含另一個迴圈，若有必要它可以組合2個以上的迴
圈。執行順序是外圈執行1圈，內圈要執行所有圈數（內圈要執行1遍）。
指令的語法如下：
for（起始條件；結束條件；增減量）（
for（起始條件；結束條件；增減量）（
指令1
指令n
）
）集狀迥圈同單一迴圈，每一層（內外圈）均有獨立的三個基本任務不再重覆說
明，巢狀迴圈流程圖（見圖）。巢狀迥回是從外圈開始執行步驟說明如下：
步驟翻）會先檢查外圈是否達結束條件，若為假（false）則進入外圈指令區。
步驟名）》檢查內圈是否達結束條件，若為假（false）則進入內圈指令區。
步驅鶴）執行內圈指令區的指令，再回到步驟2檢查是否達到內圈的終止條件。
若內圈已達結束條件，檢查結果為ttue，即滿足終止條件，結束內圈的迴圈，回
到步驟1的外圈檢查是否達結束條件。若為假（false）則重覆執行內圈一次，即把內
圈的所有圈數（元素取完）都執行完，再回到外圈。若外圈已達結束條件，檢查結果
為真（true），則結束集狀迥圈。
1.檢電外圈是\true
否已這結束條
件
4加增或
遞權計數器加
2檢查內圖是\tue
人
上遞增同件
授茹計點false
3執行指令區
程式友
巢狀迥圈流程圖人
外圈執行一圈，內圈要把所有圈數都執行完畢，才會回到外圈繼續執行下一圈，
加IN圖用打狀迥圈印出9*9乘法表。
|程式碼檔名：E48.himl|
1_<!DOCTYPEhtml>
Wu<html>
3[<body>
4<h3>巢狀迴圈：9*9乘法表<h3>
S1<tableborder一"1一
6<seript>|
7fortvar生lii<=9；iH）（|
8document.write（"<tr>）；
9近凡人|
10document.write（"<td>"+i*二十td
區]）|
12document.writeC"</tr>
137）
14~</scrip選
Ag|
16</body>
17~</html>4
|程式說明
此範例為一個集狀迥圈，第7列為外圈，第9列為內國。當跑第一圈外圈時，僵
印出<t>的標籤，接著到第9列的內圖，會印出9次的<td>標籤與內容，接著再印
出<t的結束標籤，這樣就是1次的外圈迴回，執行完9次就可以完成此梨獎名回。|執行結果
口table99.htmlX人
<oo[eeZozcosovueoeoe可轉De
3應用程式器網頁快訊圖廁只自訂這結口入司品>二戰國>》
梨狀迴圈：9*9乘法表
2567889
Be510pv613Pv7PP8716|P>919
TE下
人
的42075237630|5v723引89340294
TE
TE
一出划人
加回了NO上ERE
4-2-3“while
若要執行重覆性的工作，但是不確定要執行多少次時，則不能使用for迴圈，可
改用while迴圈。while迴圈可使用邏輯條件式做為判斷結束的條件。當邏輯條件為真
（true）時，即進入迴圈內執行指令；直到邏輯條件為假（false）時結束迴圈。
指令的語法如下：
while（邏輯條件式）（
指令1
指令n
）while的第1列只放邏輯條件式，判斷繼續執行或終止迴圈。但是，計數器入
的初始值以及每圈計數器其值的調整，必須要在其他地方設定。while迴圈流程圖全
圖）說明如下：

1.檢查while闊false
輯條件式
3.遞地
遞洲計true
2.執行指令區
while迴圈流程圖

while迴圈架構較單純，檢查邏輯條件式，若條件為真（true）則進入迴圈執f撕
令區的程式碼，執行完再回到while指令檢查條件式是否成立，若為真（tme）帕
續；反之，若為假（false），則結束迴圈。

天到加重覆產生亂數（0至6的整數）直到產生的值是0時結束，印崗

次產生的亂數值，並計算個數。

[程式碼檔名：E49.himl

1_<!DocTYPEhtml>
2<htmb>|
3<body>|
，4<h3>重覆產生亂數<h3>人
ooABS|
6VarX70和說17x三Math.floor（Math.random0）*6）；|
8count三1
9while（x0）（
10documentwrite（x十"br>9）；
二三Math.floor（Math.random0*6）；
12count=count十1；
13）
14documentwrite（x+"<br>9）；
15document.write（"共產生亂數"二count+"次9；
16</script>
17</body>
18</html>
|程式說明
第7列的Math.floor（Math.random（）*6）可以取得一個0至5的隨機亂數。
第9列進行while邏輯判斷，當符合x不等於0時，則繼續進行while判斷，會
持續產生亂數直到x等於0時才會離開while判斷。
[執行結果
信光作戰還
口whilerandomhx
個opeg5SbARM加COe
3產用程式口網頁快訊圖襄旨自訂連結》
重覆產生亂數（0至6的整數）0時結束
4
5
自4
1
0
|共產生亂數5次
點4-2-4bo大和Confinue

有時候迴圈執行到一半時需要判斷，符合某種條件情境時要中斷迴圈，可以使用
break與continue指令。break指令用於中斷迴圈，忽略以下的指令不執行後，跳離該
迴圈；continue也是中斷迴圈，但忽略continue以下的指令，回到迴圈的第1列繼續
執行owhile與for均可以搭配break與continue做控制間

以while為例，其指令的語法如下：
while（邏輯條件式）（while（邏輯條件式）{

if（邏輯條件式）（if（邏輯條件式）（

continuebreak；

while要使用break或continue要搭配說的條件式判斷是否滿足條件。以continue
為例，若論判斷條件式為真（true），一樣放棄執行以下的程式碼，回到迴圈開始，摔
續執行下一圈；若論判斷條件式為假（false），則往下執行其餘的程式碼，再回到加
圈的開頭，直到迴圈滿足結束條件（見圖左）。另以break為例，若iF判斷條件式放
真（te）執行廬指令區指令至break後，接著跳過break以下的程式離開迥圖，若
if判斷條件式為假（false），則級續執行指令區其餘程式碼。指令區的程式碼執行完畢
後，再回到while檢查是否滿足結束條件（見圖右）。檢查while表輯\_false仿查while折輯\_false
條件式條件式
了true
而
執行指令區執行指令區
程式碼程式碼
while迴圈配合confinuet（左）與breqk（右）流程圖
若蟬名以while迥回產生9*9乘法表結合break與continue，遇到第4列
跳過，遇到第7行就結束。
|程式碼檔名：E410.himl
1_<!IDOCTYPEhtmb>和
2_<html>
3_<body>|
4<h3>while配合continue與Break的9*9乘法表</h3>
o和A必SIEV
eAg|
7var太1var本13：
8while（i<=9）
2document.write（<tr>2）；三寺放你三到（
1上|
12continuey
和1】|
14whileG<=9）|
15EL
16break；|
7
18全|
19辣+1|
20|
21。1|
22生1|
23document.write（"</tr>）；|
24）
AS
AS|
27_</body>|
28_<html>
程式說明
第8列while判斷，當列數<=9時，則判斷式持續進行以下程式直到列數不符台
ho。
第10列當列數為4時，將列數+1後，執行continue語句中斷迴圈，但回到
的第1列重新執行。
第15列當欄數為7時，則執行break語句中斷迴圈，後面的程式皆不執行，孖
顯示的結果如下圖，沒有了列數4的內容，但後續的列數持續執行；與沒有了柚數？
的內容，後續的欄數全部停止執行。|[執行結果
[study[rc中回|關公玉
區whileBreakCc_Xx丰采能
人Opeg5SBAoM圖Ge@
關訓曾料口油頁供訊圖生膏自訂這結2
while配合continue與Break的9*9乘法表
222333用4汪555用6
TTbv5710|P*613
LT
加REEEEEILRN」
LE
REREELRLEILERNE
此
也19213322王國選
一各所二條人
利用迴圈撰寫一個程式，小雅想存到人生的第一個100萬（FV），求：
（1）每年存12萬
（2）每個月存1萬（PV），存款年利率2%（r）
請問小雅需要多少年才能達成願問？
高提示
（1）FY=Py*（1+rj"，FV：終值，PV：現值，r：年利率，n：期數；）|程式碼檔名：E411.html
1_<IDOCTYPEhtml>二
5<html>|
3<body>
4<h3>儲存人生的第一桶金：利用迴圈握寫一個程式，小雅想存到人生的第一個100貳
（FV），求：（1）每年存12萬2）每個月存1萬（PV），存款年利率2（），請問小牙需要，
多少年才能達成願對？</h3>|
wAg
6varmpv=10000；varypv=120000；varr二0.02；vartarget=1000000；varmfv==0；varn1
Varyfv三0；varmm三0；]
7while（mfv<targeD（
8mfv三（mpvy+mfv）（1+r712）；|
w中上
10）|
11document.write（"月存1萬元，約"+（m/12）+"年可以存到"+Math.round（mfv）+"元"+
Kg|
12while（yiv<targeDt|
13yyf=（ypv+yf）*（C14p；
和日二|
15）|
16doceument.write（"年存12萬元，約"+m+"年可以存到"+Math.round（yfv）+"元"二
5|
17</scrip馬|
18</body>|
19八號日|
|程式說明
第7列以while判斷當mfv未達到目標時，會持續進行運算，直到達成目標4并
開while迴圈。
第11列的Math.round（），可以將有小數的值進行四捨五入。[執行結果
條信條[ec回全劑人

/口whilesavings.htmlx多

個0全「Gfie///D：/cloudstation/LISAt女|圖0會
3說用程式口網頁快訊圖宣。強自訂這結。口從正華入口己藻入>
儲存人生的第一桶金：利用迴圈撰寫一個程式，小雅門
|存到人生的第一個100萬（CFV），求：（1每年存12萬（2）個
|月存1萬（PV），存款年利率2%6）。，請問小雅需要多少
年才能達成願黎？

月存1萬元.約7.75年可以存到1006719元

年存12萬元，約8年可以存到1050555元加

1.景氣對策信號，類似交通號誌有5種論號，代表景氣狀況。目前是以股價指數、
工業生產指數以及貨幣總計數MIB變動率等九種指標加權組合而成之綜合分
數。依綜合分數的級距，分5個等角，分別給不同的燈號。如果景氣對策信號
顯示「綠燈J，表示目前景氣穩定、「紅燈」顯示景氣熱絡、「藍燈」顯示景氣低
迷，至於「黃紅燈」及「黃藍燈」二者都屬於警示性燈號，要密切觀察後續蛀氣
是否有轉向。試撰寫一個程式，輸入綜合分數來判斷景氣對策信號，分數的級距
說明如下：
38~45分：「紅燈」，'顯示景氣過熱，政府宜採適當的緊縮措施，讓景氣回穩。
32~37分：「黃紅燈」，顯示景氣活絡，但短期內有轉熱的可能，政府不宜再近刺
激經濟成長的政策。
23~31分：「綠燈」，顯示景氣穩定，政府應採取能穩定促進成長的措施。
RE
9~16分：「藍燈」，顯示景氣進入衰退，政府有必要採取強力刺激景氣復聽政策。
資料來源：國發會、MoneyDJ/財經百科

2.。計算加值型營業稅：按進銷項差額課稅。營業人（企業）在某一期間，銷售貨物
或勞務所收取之稅額，減去買入貨物或勞務所支付之稅額求得應納稅額。
計算公式：銷項稅額-進項稅額=應納（溢付）稅額
銷項稅額=銷項總額*5%，例如：10000
進項稅額=進項總額*5%，例如：8000
舉例說明：
銷項稅額：10000元*5%=500元
進項稅額：8000元*5%=400元應納稅額：500元-400元=100元

輸入銷項總額與進項總額，網頁自動算出銷項稅額與進項稅額'並計算應納稅額。

功能以本題要求為主，國稅局試算供參考。參考以下網頁畫面：https：//www.etax.

nat.gov.tw/etwmain/front/ETW158W3

3.。”計算非加值型營業稅：依銷售貨物或勞務之毛額計算應繳稅額（不考慮進項）。

計算公式：銷售額*稅率=應納稅額

稅率參考如下：

（1）小規模營業人及其他經財政部規定免予申報銷售額之營業人：1%

（2）保險業之再保費收入：1%

（3）銀行業、保險業、信託投資業、證券業、期貨業、票券業及典當業經營專屬
本業之銷售額之收入（不含銀行業、保險業經營銀行、保險本業收入）：2%

（4）銀行業、保險業經營銀行、保險本業之收入：5%

（5）銀行業、保險業、信託投資業、證券業、期貨業、票券業及典當業經營非專
屬本業之銷售額之收入：5%

（6）夜總會、有娛樂節目之餐飲店：15%

（7）酒家及有女性陪侍之茶室、咖啡廳、酒吧等：25%

（8）農產品批發市場之承銷人及銷售農產品之小規模營業人：0.1%

舉例說明：

假設營業人為保險業之再保費收入，稅率為1%，某一期間銷售貨物或勞務總計

200，000元，應納稅額為200，000元*1%=2000元。

稅率以下接式選單為主，功能以本題要求為主，國稅局試算供參考。參考以下網

頁畫面：https：//www.etax.nat.gov.tw/etwmain/front/ETW158W34試撰寫一個程式+計算身高體重指數（BodyMassIndex，BMI），BMI是一種呎
大眾健康有關是否為肥胖的測量指數，只要輸入身高與體重即可算出EL
算公式如下：

訴
BMI=和
其中：W為體重（公斤）；H為身高（公尺）。
世界衛生組織（WHO）公佈人體理想的BMI指數是22，分級標準如下：

中王宮
則一is
回的
加天天
有

重度肥胖>-35|
請設計一個網頁輸入身高與體重，顯示BMI值。可以參考以下網頁畫面，葵
以本題為主。http：//tiger168.com/luckytop/bpage01.htm

5.”延續前題，試撰寫一個計算體脂肪率（Bodyfatrate，BFR）的網頁，體脂肪率恥
計算脂肪含量占總體重的百分比。計算公式如下：

BFR%=1.2XBMIH0.23X年齡-5.4-10.8X性別（男性X1；女性xe
依據行政院國民健康局公佈，國人的體脂肪率標準值如下：

he
請整合第1題設計一個網頁：

（1輸入身高與體重，顯示BMI什

（2）輸入年齡與性別計算BFR。
參考以下網頁畫面：https：//peter88850.github.io/6.。試寫一個網頁，提供使用者選擇（一次只能選一種）做以下四種利率因子試算。
使用者只要選擇那一種利率因子、利率（）、期數（）即可算出利率因子。另外，
產生利率因子試算表。四種利率因子為FVIF、PVIF、FVIFA及PVIFA，計算公
式如下：

終值利率因子=PP八
（1）輸入利率2%（0.02），期數5年，計算終值利率因子。
（2）利率設1%到5%，期數設1到5年，試寫出一個利率因子試算表的程式見
下圖。
人條有公有全回畫
人Xi
個C_人lofie//D/clot旭|轉：
_划悶用三式還網頁歸訊圖時論員訂這結同
|利率因子計算雍點
|一利率因子選玩：上
%全值利率因子同
ooez_一一二|上
期數年財
則
狡值利率因子=1.1040808032|
1.01001.02001.03001.04001.0500|
1.02011.04041.06091.08161.1025全
1.03031.06121.09271.12491.1576圖
1.04061.08241.12551.16991.2155
1.05101.10411.15931.21671.2763圖7.試寫一個網頁，提供使用者選擇（一次只能選一種）做以下四種利率因子試算。
使用者只要選擇那一種利率因子、利率（）、期數（0）即可算出利率因子。站種利
率因子為FVIF、PVIF、FVIFA及PVIFA，計算公式如下：

終值利率因子=）=（1+光
1
現值利率因子=7JZFG7）7（1
本大了
NASULELORI
~和1~
SiThMr
年金現值因子=PPZFG0-LT一0斑了~
另外，產生利率因子試算表，？設1%到10%；#設1到10年。
執行畫面參考如下：
廬tddben』[下回|加
Pi人
個ope人玄|圈0：
下窗用登基品粥頁信也圖昌外邊訂之結蟬從EE【國入口記入下
利率因子計算器：
利率因子選噴
•餅什利實因子G現什利率因子G年金終信因子年金現們因子
利率（%9）10.02
一一9
[8
利率因子=1.1040803032
1.01001.02001.03001.04001.05001.06001.07001.08001.09001.1000
1.02011.04041.06091.08161.10251.12361.14491.16641.18$11.2100
1.03031.06121.09271.12491.15761.19101.22501.25971.29501.3310
1.04061.08241.12551.16991.21551.26251.31081.36051.41161.4641
1.05101.10411.15931.21671.27631.33821.40261.46931.53861.6105
1.06151.12621.19411.26531.34011.41851.50071.58691.67711.7716
1.07211.14871.22991.31591.40711.50361.60581.71381.82801.9487
，1.08291.17171.26681.36861.47751.59381.71821.85091.99262.1436
1.09371.19511.30481.42331.55131.68951.83851.99902.17192.3579
1.10461.21901.34391.48021.62891.79081.96722.15892.36742.59378.。標準常態分配：常態曲線及分配是一種統計的理論模型，透過平均數及標準差的
假設，可以對實證資料分配，推論與描述其資料行為。所謂的標準常態分配是候
設其平均數為0，變異數為1的常態分布。假設連續型隨機變數，若其機率密
度函數的計算公式如下：

15

ToPi8AMASB

則y的機率分配稱為標準常態分配（StandardNormalDistribution）。

試設計一個網頁，計算標準常態分配函數試算表。

PCZ>z）_e

文NVEIT人BB

說明：

（1）先計算單一值，xST
機率是0.1587（2），見下圖。

（2）輸入一個>值範從0.0000到3.409（如：例的標頭+行的標題），計算標準當
態的果積機率試算表。

（3）永設為0.00001。

（4）表的行標題與列標題均設粗體，並設列顏色的間隔。pa、xN臣和人加
teop守宮本轉0|
說加還四加加才二容回>加>回口L4|
標準常航分配機率計算與試算表地
EECEEEa|
机率值=0.15$7
中名詞

eg0.010.020.030.040.050.060.070.080.09

0.000.50000.4960。049200.44880。。0.448400.4801。。047610.47210.46810464f本
0.14004602044562045220.4483044430.44040.43640.43250.42860427|
0.20。。0.44207。。04168。。0.41290.40900.4052。。0.44013Pa0.3936。。0389703859

0.30eg037830.3745es0.36690.36320.35940.35570.3520034831

0400.34460.34090.33720.33360.3300PS0.322803192031580312（|

0.500.30850.30500.3015029810.2946029120287702843028100276|

0.600.27430.27090.26760.2643。。0.26110.25780.2546。。0.25140.248302451一

0.7002420eyeeyees0.22970.2266ee0220702177ce

0.80021190.20900.2061。。0.2033pg0.19770.1949。。0.19220.18940.1867

0.900.18410.18140.17880.17620.1736eg二0.16850.16600.163501611

1000.15870.15620.15390.1515。。0.1492。。0.1469。。0.1446。。0.14230.140101379

1.10et0.13350.13140.12920.12710.1251es0.12100.119001170

AN和[etdands而回
ee|

<。G人loezZ/DzcoudsetousAteachng/e/bookfntechpythorhomeworzprogramming/normadsCRshtml如圖0：
拓大用全二加沽頁你號轉宣回條謹容器>中回>LTBookmarks對

egeg00013ee00012000120.001100011。。0.0011。0.001000010

3.400.0010000090.0009”，0.00090.0008[0.00080.00080.00080000700007

3.200.0007000070.00060.00060.00060.0006ggeg000050.005

egcgS00005000040.000400004。。0.00040.0004。。0.00040.00040000

3.400.00030.00030.00030.00030.00030.00030.00030.00030.00030.0002!
|資料來源
Yhttps：//smallcollation.blogspot.tw/2013/08/normal-distribution.html#gsc.tab=0CHAPTERP
自訂函數與內建范數
5-1自訂國數介紹
5-2呼叫函數
5-3參數
5-4變數生命週期
5-5內建物件JavaScript是腳本語言，其程式碼是指令集'可以簡單看成一組程式碼由上而
執行，指令集內可以撰寫自訂函數（function）。
本章會介紹：
1.自訂函數的特性與寫法。
2.如何呼叫函數以及其回傳值的用法。
3.參數的種類、形式與用法以及參數傳遞的方式。
4.區域變數範圍、全域變數範圍與內建變數範圍。
5-1自訂銷數介紹
HEELLU
EL
5-1-1定義
函數是依特定規則撰寫且能夠重複使用的程式碼，可以設計成一個單一或
有相互關連指令集的程式碼，善用自訂函數的寫作技巧，可以提升程式的模組化，以
減少程式碼重複使用的問題。自訂函數可以依照使用者自己的需求設計特定的功能，
此功能往往是內建函數沒有提供的，自訂函數又稱使用者定義的函數（userdefmd
functions）。若要客製化某個內建函數不提供的功能，就必須自己動手撰寫自訂函數"
5-1-2”特性
1.自訂函數程式碼區域內的第一個保留字是ftnction，後面接函數名稱、小#
r（）J、括弧內的參數群「（parameters）」之後以一對大括弧「（）」將函數內的指人
集前後括起來。
2.自訂函數內的指令區要內縮對齊。3.回傳指令（retum）負責將指定變數的結果或運算式回傳給呼叫函數的程式，並
且將要回傳的變數或稱物件實體寫在retum右邊。如果沒有寫retur的參數，可
以省略不寫，視同retumNone（沒有回傳任何物件）。

4.自訂函數的名稱盡量避免與JavaSeript保留字、內建函數以及國數內的識別字相
同。

5.自訂囤數的程式碼撰寫建議寫在呼叫函數者之前，也就是先定義好自訂函數並放
在HTMLS網頁內容的<head></head>內。

5-1-3語法
自訂函數的撰寫格式第1個保留字是ftnetion，范數的程式主體是為達到函數功

能而所寫的相關指令集：傳入參數或叫引數（argumenis）是從呼叫者的變數傳遞進

來，若沒有要傳入的參數，則小括弧內是空的，傳入的參數可超過一個，傳出的回傳

生

_自訂函數架構的語法如下：

function函數名稱（傳入參數）{

指令1#當條件成立時執行本指令區的指令

指令m

_retum變數名般

名

時呼叫函數

_國數撰寫完成後，要執行該函數必須要先呼叫它。自訂函數的執行可以在

+<script></scrip愉內呼叫自訂函數。

2.自訂函數呼叫自訂函數。

3.網頁的<inputtype="button"onclick="自訂函數吃啟動事件後呼叫自訂囤數。5-2-1。<scripf></scripf>內呼叫自訂銷數
JavaScript的程式要用<seript></script>前後括起來，包含function程式碼。
JavaScript的程式碼可以放在<body></body>，也可以放在<head></head>之中，差別
在於：
y在HTML<body></body>內的JavaSeript會在頁面載入時被執行。
y在HTML<head></head>內的JavaScript會在被呼叫時才會執行。
<body>和<head>可同時存放無數的腳本。以下範例是寫在<head></head>內。
假設<body>內的<script>呼叫單一層自訂函數sumnfunc的意示圖（見圖）。
bodhead
下
script呼叫單一自訂函數意示圖
|範例.5：1|n設為10，從1累加到n，使用自訂函數的寫法。
|程式碼檔名：E_5_1.himl
|1_<!DOCTYPEhtmb
2<html>
o公司&V
naAV
5functionsumnfunc（n）（
6Sumn=0；
>TE
8sumn+=1
9returnSumn；
10）
11_</script>12。</head>
13_<body>
14_<h3>script內呼叫自訂函數</h3>
Ag
16varnum三10；
17document.write（"累加1到10="+sumnfunc（num））；
18</scrip選
19</body>：
20</htm選3
|程式說明
本網頁範例是介紹在網頁中的自訂函數，第4列至第11列的<seript>跟第15列
至第18列的<seript>有何差別呢？先看到寫在<head>的<scripb>，由於網頁開始跑
的時候，會先跑<head>的部分，所以<head>裡的<seript>會比<body>來的先執行，
但通常<body>才是網頁顯示的部分，如果先執行程式部分會擾亂網頁整體架構，但
<body>的<seript>是因為網頁主要顯示在<body>部分，因此將分類成<head>的自
訂國數執行與<body>的呼叫自訂函數。
[執行結果
由章
口“x人
_fopeg二：
點
seript內呼叫自訂函數
累加1到10=55
此範例的自訂函數放在<head>，由<body>內的<seript>去呼叫。程式執行時的
切入點並非由上而下，而是從自訂函數程式碼區塊以外的第一列varn=10進入執行
程式。程式呼叫自訂函數的步驟如下：
步驟輒程式執行進入點
本範例「程式執行進入點」是第16列請見如下對照圖。宣告num並設定初
始值為10。
步限究）》script內呼叫自訂函數
script內呼叫自訂函數，將變數mum的值指派給被呼叫函數中的變數n。由
document.write內呼叫sumnfunc自訂函數見第17列，小括弧內代入num，傳
入<head>內的自訂函數sumnfunc，和此函數定義一個傳入變數n來接受呼叫
程式傳進來的值，假設num的值是10，則n也會被指派10的值見如下對昭
圖。執行自訂函數內容到retum，會將函數內變數sumn的值傳回給呼叫程式。
EL
自訂函數執行完畢時，若有回傳值則將指定的變數回傳給呼叫者，本範例呼
叫者是<body>內的script的document.write函數，最後印出累加結果，見執
行結果圖。
網頁吉入
1
-functionsumnfunctn）{|步驟2Script內
sumn=0；二品時加怕生時
|同；
-sumn+i1
-_）人
-returnsumny
-
時調前肉失守!!
進入點!!
4IVarn三10；一
|document.writet"累加1到10="+sumnfunc（n））；
ce
步雇3，回傳值給呼叫者
呼叫自訂函數的步驟意示圖5-2-2自訂函數呼叫自訂函數
自訂函數內部也可以呼叫另一個自訂函數，可以依程式架構的需求無限伸展。
若考慮程式的可讀性以及大程式的維護修改需求，不宜太多層以免過於複雜。以下示
範多層的自訂函數呼叫自訂函數的架構（見圖）。<seript>內呼叫自訂函數callfunc，
callfunc再呼叫自訂函數sumnfunc與prodnfunc。
head
品
上名輸入一個正整數n，計算從1到n的果加及累乘，使用自訂函數呼
叫自訂函數的寫法。
|程式碼檔名：E5_2.hfml
1_<!DOCTYPEhtml>
2<htmb
oo<head~
4<scripb>
5functioncallfunc（m）（i
6document.write（"累加1到10="十sumnfunc（n）十Ag）
7document.write（"困乘1到10="+prodnfunc（nm））；
人
wfunctionsumnfunc（n）（
則11宮中）

5Sumn+=1

13Teturmsumn；

14）

15functionprodnfunc（n）（

16prodn=1；

17for三11<n；i+）

18Prodn*=1；

19retumprodn；

20）

21</scrip選

AV

BASEV

24<h3>自訂函數呼叫自訂函數<h3>

25AV

26varnum三10；

27callfunc（num）；

28</script>

ouASSV-

30</html>|
|程式說明

本網頁範例是網頁中自訂囤數呼叫自訂函數，通常將自訂函數放在<head>中，

再將<head>中的自訂函數去呼叫自訂函數。先看一開始第27列呼叫callfune自訂囤
數，接著執行第5列callfunc自訂函數，第6列與第7列都是呼叫自訂函數，第6列
會去執行第9列sumnfune累加的自訂函數，則第7段會去執行第15列prodnfunc累
乘的自訂函數，這使得程式更加精簡、更加易懂。[執行結果
[egtoedlsaJ避忌]本5時
/7bhkxN此
人【6三PE
ELT回宮銜人
自訂函數呼叫自訂函數
累加1到10=55
累乘1到10=3628$00
5-2-3引用外部自訂函數
如果想在幾個頁面中執行相同功能的程式，就不需在各個頁面中重複的寫這些程
式碼。可以有幾種寫法說明如下：
回*.js獨立檔案
可以把程式碼獨立寫在一個外部檔中，副檔名為js。只要維護一個js檔，可以
使用無數個網頁共同載入。
區天甘圖計算本利和=存款金額*（1+年利率）期數。
訪提示
存款金額=100；年利率=0.03；期年=5。
|程式碼檔名：E_5_3.himl
1_<DOCTYPEhtm>人1還
2_<html>
3_<head>，|
LEEL
8V人|
6_<body>$
.73>引用外部自訂函數<h3>說同8_<formaction="/result/"method='"get'一|
9<fieldset><legend>計算本利和：</legend>|
10存款金額：<br>|
二一<inputtype="text"id="amount"name="amount"value="100"><b說
12年利率：<br
13。<inputtype="text"id="rate"name="rate"value="0.03"><br>|
14期數：<br>一
全
16</fieldset>
5人SAtype="button"id="btn"onclick="futurevalue（）">送出!</button>|
18</form>
20</body>|
21_</html>品

|程式碼檔名：myjsfile.js
1functionfuturevalue（）4|
2varpv=三parseInt（document.getElementById（"amount"）.value）；|
位vari=三parseFloat（document.getElementByIdC'rate"）.value）；|
4varn三parseInt（document.getElementById（"period"）.value）；|
5、fv=pv*（Math.pow（l+bm）；1
6document.write（"本利和="十和+"</br>9）；|
S人；一

|程式說明

本網頁範例是引用外部自訂函數，第4列<seript>的type語法是代表指定哪和

態，比如說text/javascript就是JavaScript，'而src語法是代表連接的檔案。回時避二

例中連接上myjsfile.js。

第請列button中onclick表示使用者按下button按鈕時會執行Onclick，我們

可以看到在oneliek中則是去呼叫futurevalue這個自訂函數，而先前src所連接到的

4myjsflejs檔，在myjsfilejs檔可以看到document.getElementById的用法，這是抓欠id，比如說document.getElementById（"amount"）.value是抓id為amount的元素，而後面
的value是取得其值，所以document.getElementById（"amount"）.value就會是100。
[執行結果
個回回
Bb
req_GSSAES%_】
ec2各=11592740742999999
<>cr人olofez/czuseru.人圖0o：
生共用三守器EL二日可理結口從正國和人&
引用外部自訂函數|
計寬本利和：
存款金用
娜||||
品||[||
區區
彈使用GelVol函數呼叫自訂函數一
另一種寫法是在網頁端利用自己寫一個GetVal（）函數取得網頁標籤值後轉換後再
送到自訂函數。
E53.html第17列網頁程式碼置換成以下：
<buttontype="button"id="btn”onclick="futurevalue（Getval（amount），Getval（rate'），
GetvalCperiod0）；一送出!</button>
其他程式碼都不變，另外自訂函數myjsfile.js要改成如以下程式碼。
1fumctionfuturevalue（pvi，n）t誤
旋varfv三pv*（Math.pow（1+im）；
3document.write（"本利合=十）</br>9）；
全
加人_functionGetval（name）t說計說6varval==document.getElementById（name）.value
sTetumvaly|
•）|
1
|程式說明
本網頁範例事先將所有物件套入到Getval0）的自訂函數，而Getval（）自訂函數會
事先將value值抓取出來，並傳回到<buttontype="'button"id二"btn”onclick="futurevalue
（Getval（amount0，Getval（rate），Getval（period90）；>所對應值，而onclick部分就會去
呼叫futurevalue（pvi，n），在futurevalue中就不用去抓value值，而是去做程式運算
部份了。
『執行結果
與E53.html相同，優點是自訂函數不需要因讀取網頁標籤而被綁死，但缺點是
需要另外寫一個GetVal自訂函數。
5-$參數
程式語言的參數（parameter）是指資料從一個程式函數傳到另個函數。當呼叫
的程式將參數傳遞給函數時，范數會有自己的參數來接收傳進來的資料，兩者即有比
定（binding）關係。函數內的變數是有區域性的，看不到函數外的變數，基本上珀
靠傳進來的參數與回傳值與外界溝通。本節將討論參數傳遞方式與用法，呼叫程式與
被呼叫的函數之間，其參數的傳遞方式分為傳址（callbyreference）與傳值（call吵
value）。
>傳址：傳入參數所參考的記憶體位址，函數內的對此參數進行修改，會影響
參數的內容值。因為，傳入者與接收者同一個記憶體位址。
y傳值：複製一份傳入參數的內容值，給函數內負責接收的參數，兩者是相互
立的參數，不同記憶體位址，若函數內的對此參數進行修改，不會影響原婦
的內容值。在JavaScript程式語言，傳址或傳值與資料型別有綁定關係，若要傳送的參數之
資料型別是字串陣列、物件、陣例與函數，其參數傳遞方法是傳址。數值合整數、浮
點數、字串與布林的參數傳遞方法是傳值，見下圖。

傳址參數傳遞的資料型別
（sw（0
隼gg數
傳值參數傳遞的資料型別若寢圖測試傳信與傳址的參數傳遞方式，整數、字串陣列與物件。
|程式碼檔名：E5_4.himl

1<!IDOCTYPEhtml>

2<html>

3<head>

上AV

5functionfta，b，c）（

6ol

7中品

C.first三false；

27

10</scrip記

11~</head>

12”<body>

13<h3>參數傳遞方式</h3>

14<script>

15varx三4

16vary=[Ilike"，"JavaScript中；

17varz三（sex：truej

人

19“document.write（x十"</br>十y+"</br>"十zfirs60）；

20</scrip信

21~</body>
人人；
|程式說明

整數的值改變不會影響原來的值；字串物件與物件會影響原來的值。[執行結果
全各回生
j/ba.xN
op吉|：
ME編頁快訊圖宣y》
辦繼裕文央
上
IlikeJavaScript，Funny!
false
依E54.html中整數與字串的參數傳遞方式，細步的說明和示意圖如下。
回整數為傳值的參數傳遞方式
在<seript>（主程式）內設一個變數x，內容值為4。呼叫f自訂函數，由a變數
接此值，因為是整數為傳值的參數傳遞方式。因此，會複製一份內容值給a，x與a
是獨立的記憶體位置，即使a的內容值更改為3，也不會影響x見下圖。
ee
EL了
人wo41|!
|下se，||
wo一rar||
wo8||
iri；
weee|
一一
SI|
1
dd回字串陣列為傳址的參數傳遞方式
字串陣列為傳址的參數傳遞方式。因此，在<script>內設一個變數y，內容償旋

"Ilike"，"JavaScript"，f自訂函數有b變數去接受內容值。因為，y與b是同屬一個記
憶體位置，因此b的內容值新增時，也會影響y，見下圖。

EE

記惟震位址（Address）內容稍

wo一？

wo，一

8

888一

1b一

一|

一一

os|

l

ae

當呼叫f自訂函數，y變數的內容值由b變數接收，因為是整數為傳址的參數傳

遞方式。因此，若在自訂函數使用push0）方法，可以在b變數內新增一個字串元素
"Funny"，則y也會同步新增Fumny元素，即y與b的變數內容均已被改變為'Ilke，
"JavaScript"，"Funny"，見下圖。

和和性III

一記惟芷位址（Address）內容什

we。一

wo，一

人88S

8B|T

|b全

|!

!12s2i4s8一和~“|5-4變數生命週期
變數是有生命週期的，有產生也有結束。變數名稱會指向物件實體，而變數實際
儲存的地方叫記憶體。在JavaSeript程式語言中，函數、資料型別、物件實體等都是
物件。當宣告變數時，即產生物件。變數類型的特性主要分以下兩種。
加區域變數（locqlvqrigble，L）的特性
1.定義在函數內的變數（含形式參數）均為區域變數。
2.區域變數是暫存在記憶體，其生命週期只存在函數執行期間，當該函數執行完
SELL
EP域
變數。
回全域變數（globolvorigble，G）的特性
1.定義在主程式的變數為全域變數。
2.所有的函數都有權讀取全域變數，區域變數的讀取權僅限於所屬函數。
3.全域變數的生命週期從該變數產生開始即會存在於記憶體中，直到離關閉程式，
全域變數才會從記憶中消失。
回自訂函數呼叫全域變數
JavaSeript之自訂囤數內可以讀取全域變數。在Seript之內宣告的變數即為全域
變數，而在自訂函數內的變數即可區域變數。以下範例測試在自訂函數內呼叫並印出
全域變數。
上小尖繞測試在自訂函數內呼叫Script內的全域弦數。
|程式碼檔名：E5_5.himl
點<!IDOCTYPEhtml>同1
sw全踢了1人oAa
4<scriptcharset="UTF-8">|
5varMPhoneName="ASUS"；/全域變數|
>xillllllllllllllllllllllllllll|
8functionCallFunction（）（|
9document.getElementById（"result"）.innerHTML=MPhoneName；|
10）|
二公%喇V
12</head>
13<body>|
14_<h3>呼叫全域變數</h3>|
15。<buttononelick="CallFunction0">呼叫</button>
16<pid="result'></p>
17_</body>：
18</html>品

|程式說明

此網頁範例在CallFunction（）自訂函數中，inmnerHTML語法是先抓取物件記後，

並將使用者寫入字串、HTMLCode寫入id物件中，而MPhoneName是放在全域內，

所以可任意呼叫，而第16列的<pid="result"></p>，才會變成MPphoneName變數。

[執行結果

加自而點
cxN這處
個cpGb
邊作用程式加網頁估訊圖是分
呼叮全域變數
品到
ASUS5-5內建物件

JavaSeript所有的資料型別都是物件，包含內建物件。JavaScript的內建物件分為
隱性物件（Implicitobjects）與顯性物件（Explicitobjects）。本節將介紹顯性物件的內建
函數，包含陣列物件（Aray）、數學物件（Math）與日期物件（Date）等。
回隱性物件（lmplicifObjects）

前述介紹的資料型別，先宣告變數的方法均為隱性物件，宣告方法如下：
varn三5；
LE
Varfag三"truee
加顯性物件（Explicifobjects）

使用new建立的物件即為顯性物件，建立後顯性物件的實體（instance）可以使用
內建的方法（method）。宣告方法如下：
vartoday=三newdate（）；
alert（today.getFullYear0）；

today是一個物件實體，是藉由newdate這個日期的內建物件所建立的。
getFullYear（）方法可以取得today物件實體的系統日期的西元年份。
5-5-]”陣列

陣列也可以是一個變數（即物件實體名稱），內儲存多值，通常會使用陣列處理
大量數據比較好用，陣列物件也提供多個方法做資料的操作運算。JavaScript內建的
Array物件不須要額外引用套件，隨時可以用new來建立陣列的物件實體。陣列物件
內可以儲存不同的資料型別，例如字串、數值等。1.建立陣列
建立陣列有隱性與顯性的宣告方式，隱性物件所建立的陣列使用中括弧日將資料
前後括起來，語法如下：
varstocknames=["大立光"，"台積電"，"華碩
或顯性物件所建立的陣列則使用小括弧（），語法如下：
varstocknames=newArray（"大立光"，"台積電"，"華碩9）；
2.存取陣列
存取陣列的元素要使用索引值，索引值從0開始編號，假設陣列的元素有n個，
則索引值編號從0到nm-1。
阿存取單一個陣列元素
存取陣列的元素使用中括弧，並輸入所需要的索引值如下。
document.write（stocknames[1）；
測試在Script內宣告一個陣列資料，並存取第1個元素。
|程式碼檔名：E_5_6.himl
1_<!DOCTYPEhtmb~
2<html>
3<head>
4</head>
5<body>
6<pid="FirstElements'></p>
7。<scriptcharset="UTF-8'>
8varstocknames=["大立光"，"台積電"，"華碩中
9document.getElementById（"FirstElements"）.innerHTML=stocknames[1]；
AS
11</body>
12</html>1程式說明
在第8列的stoeknames陣列建立三個元素，分別是"大立光"、"台積電"、"華
碩"，而最後在第9列是將stoeknames[1]顯示出來，而就是"台積電"這個元素。
[執行結果
|了各0回生
品•x/
人Ope避文：|
一四碌此人WWW一
|了還2
|台積電
|
回存取全部陣列元素
存取陣列的全部元素，只要寫陣列名稱如下。
document.getElementById（"FirstElements"”）.innerHTML==stocknames；
若繞測試在Script內宣告一個陣列資料，並存取所有元素。
|程式碼檔名：E5_7.himl
1_<!DOCTYPEhtml>：許
2<htmb
3_<head>]
4”</head>一
wASEV-
6<pid="FirstElements"></p>
7。<scriptcharset="UTF-8'>
8varstocknames=["大立光二才台積電"，"華碩中
9document.getElementByIdC'"FirstElements"）.innerHTML三stocknames；
10</scrip屋人
人
|程式說明
想逐一顯示陣列名，用陣列名[0]就可以了，而陣列開頭則是從0開始，若机史
出整個陣列，用陣列名就可以了，比如說stocknames[1]是陣列第2個、stocknams
是整個陣列。
|執行結果
人
人Clo0fe//DZC雪|：
邊湊用全若加到加國多
大立光，台積電，華碩
加陣列可儲存不同資料型別
同一陣列的物件體內的資料型可以存放不同資料型別，例如可以儲字串，整數，
數值或其他內建函數。
加本點測試在Script內宣告一個陣列，儲存整數>字串與浮點數資料，並
存取所有元素。
|程式碼檔名：E5_8.html
語IN
0人和和
<body>
6<pid=DifferentDatatypeinArray7/p>
“AS|8varseoreA=[10422152，"John"，85.51]；店|
9document.getElementById（"DifferentDatatypeinArray'"）.innerHTML=scoreA；（
10_</seript>]
11_</body>|
公司：|
|程式說明
而在網頁中的陣列可以存放著不同的資料型別，比如說第8列的scoreA=
[10422152，"John"，85.51]，而在seoreA中就有整數、字串、浮點數的資料型別。
[執行結果
人及放全回夫人
口•xAA、天
leolei2g61
PT才
10422152.John.85.51
3.陣列的屬性與方法
length是陣列的屬性，可以取得陣列合計的元素個數，見下表：
EE功能
|length|取得陣列合計的元素個數。
回前加使用length方法，計算陣列內的元素個數。
|程式碼檔名：E59.himl
1_<DOCTYPEhtmE全
2_<html>
3<head>有
LeSi5<body>約
eAg]
7varscoreA=[10422152，"Johnm，85.51|
8document.write（"陣列元素個數="十scoreAlength）；
w人點同一
10</body>
11_<html>|

|程式說明

scoreA陣列有著10422152、"John"、85.51三個元素，若想計算陣列長度可以使

用length，則seoreA.length就會計算陣列長度為多少。

|執行結果

二[凶andhasJ回2
2擊歇
<crnlofez//Dzc雪|：
|指實用班戒明絹頁估記圖宣樣
陣列元素個數=3
常用的陣列方法：
方法選漲

_338有

Ge畫

_|可提定特定符合與陣列元素合併。

|pop0|「移除陣列最後一個元素並回傳該值。

|push0|在陣列尾端加入一個元素。

|reverse0「逆序反轉陣列元素的順序。|範例5-10|使用陣列元素相加、排序、合併、移除、新增與逆序等方法。
[程式碼檔名：E_5_10.himl
1_<!DOCTYPEhtml>
2_<html>
3_<head>
4</head>
5_<body>
。AS
、三
wegl
9varbuydate=["20177，"039525中
10varcombine=scoreA.concat（scoreB）；
1vartemp；
12document.write（"陣列元素相加="+combine+r<br>9）；
13document.write（"陣列元素排序="十seoreB.sort0+"<br>"）；
14document.write（”指定符號合併="十buydatejoin（"-9）+"<br>9）；
15temp==scoreA.pop（0）；
16document.write（"移除最後元素="+十temp+移除後"十scoreA+"<br>）；
17“scoreA.push（temp）；
18document.write（"尾端加入元素後"十scoreA+"<br>"）；
19document.write（"逆順陣列元素"+scoreA.reverse（）十”<br>"）；
20</script>
21</body>
22<html>
|程式說明
第10列的陣列相加是coneat的方法，而scoreA.concat（scoreB）合併後，為一個
字串型態，而陣列相加也可以scoreA+"，"+scoreB的方法。
第13列的陣列排序是sort，而原本3，2，1的陣列排序後就為1，2，3的陣列。原本將
陣列顯示直接打陣列名，如果想指定符號合併那就需要用到join，而第14列buydate-.
Join（"-"）用法，就將buydate陣列合併為2017-03-25。而將尾端新增及移除則是pop0）與push（）的用法，第15列pop（）是將陣列移除最
後的元素，並放在temp中，而第17列push（temp）再將原本被移除的temp放回至尾
端。而reverse（）是將陣列顛倒過來，所以用在陣列排序中，也可以將原本由小到大顫
倒過來。
[執行結果

全法teajJt直如：檀
Sa凍
ce[egZezusasusE回
陳列元素相加=10422152John.85.51.3.2，1
陣列元素排序=1.2.3
指定符號合併=2017-03-25
移除最後元素=85.51：移除後10422152.John
屁端加入元素後10422152，John，85.51
逆順陣列元素85.51.John，10422152
4.迴圈陣列

當要建立的資料很多，自動建立陣列時可以使用for迴圈，還可以暫時把資料儲

存在變數中，以進行後續的資料運算。

加一維陣列

產生1-6之問的亂數共10個。
|程式碼檔名：E_5_11.html

1<!DOCTYPEhtml>

!2<htm只

3_<head>

4</head>

，5<body>

6_<scriptc

BEARD8_for（G=0；1<10；1（當：
9num[=Math.foor（（Math.random0*6）+1）；
10document.write（num[訂+"<br>9）；
17）
12</scrip選
13_</body>：
14</html>|
|程式說明
第9列Math.random0）是隨機產生一個0~0.999（無窮小數）的變數，因此Math.
random（）*6就是產生一個0~接近6的浮點數，+1是表示Math.random0）範圍從多
少開始，而Math.floor是將該值做出一個小於等於該值的最大整數，比如說Math.
fioor（5.1）=5、Math.floor（5.9）=5、而Math.floor（-5.1）=-6，所以（Math.random0*6）+1產
生一個範圍在1~接近7的浮點數，再使用Math.floor就會隨機產生一個1~6的整數。
|執行結果
多9回主
口E5_11h全上電
<colemeZpzco-可還：
抽大有扣賓關網頁俯記國定店日林連結六
15
5
2
1
4
6
2
2
1
1
6區二維陣列
JavaScript內建的Array物件不提供建立多維陣列的功能，但一維陣列內允許再

建立物件，包含陣列本身。因此，多維陣列可以由一維陣列之下再建立陣列。
|範例5：12|產生一個2維陣列，元素為1-6之間的亂數，共10列、20行。
1程式碼檔名：E_5_12.himl

1_<!DOCTYPEhtml>

2<html>

3<head>

4</head>

5<body>

6Aa

7varrow三10；varcol三20；

8varnum=三newArray（row）；

9vartemp三由

生條

11num[品=三newArray（col；

12）

性
E人

15num[四一Math.floor（（Math.random（0*6）二1D；

16temp=temp+num四由二"站

1

18document.write（temp+T"<br>）；

19temp=則

20）

21</script>

22~</body>

23</html>|程式說明
第8列num=newArray（row），先將mum建立一個10元素的陣列，而在第10列
的for中，再將原本是一維陣列的num每個元素在新增一個20個元素的陣列，所以
num最終為一個10*20的陣列。
[執行結果
還昌說生和人
nix1
<clomez/D：吉|：
人且還
11656313455331254646
45424525111324165566|
25352525114414563123
|226133535543352524332
|24365456212453554363
11551141134241135242
|55656236643416213152
和54334164655231443511
I34623241642313133216
45315416666654226361
REF
。數學物件提供亂數、最大、最小、次方、四捨五入等方法，做基本的運算。最党
用與資料運算有關的數學物件方法如下表：
常用的數學物件方法：
中功能
Math.log0）回傳以e為基底的自然對數。
Math.log20回傳以2為基底的對數。
Math.log100回傳以10為基底的對數。
Math.PI回傳圓形周長與直徑比例的常數，是屬性不需要小括弧。
_Math.sqrt0|「回傳某數值的平方根。品功能
|Mathabs0。回傳某數什的絕對值。|
_g59選回可|
[Mtew0WWWR歡。
[yame0mg|
[yo「mgfgt
|Math.pow0|「回傳某數值開n次方根的值。一
|Math.mndom0|傳回介於0到1之問的亂數。
[yes「mmtaggfmmA@8
點條們歡使用數學物件產生指數、四捨五入、平方根、自然對數、絕對值與
Pl等方法。

|程式碼檔名：E_5_13.html

1_<!DocTYPEhtml>

2<html>

3._<body>

nAa

5和說

6varb二-2.1252；

7document.write（"a三5；b三-2.12527十"</br>）；

8documentwrite（"Math.log（a）="十Math.log（a）二"br

9document.write（"Math.log2（a）="十Math.log2（a）十"</br>）；
10document.write（"Math.log10（a）="十Math.log10（a二"br

11document.write（"Math.PI="+Math.PI+"</br>9）；

12“document.write（"Math.sqrt（a）="十Math.sqrt（a）十"</br>）；
43documentwrite（'Math.abs（b）一"二Math.abs（b）+"sb
14document.write（"Math.exp（a）="十Math.exp（a）十"</br>9）；
!15document.write（"Math.floor（b）=十Math.floor（b）十"br>）；
|16document.write（"Math.max（6，0，-2）="十Math.max（6，0，-2）+"</br>）；
）17document.write（"Math.min（6，0，-2）="+Math，min（6，0，-2）+"br>9）；
」18document'write（vMath.pow（a，3）="+Math.pow（a，.3）+"<br>9；人當玖
20~</body>
21_</htm記人二

[執行結果

[2-gtunrdtaeJ回二
二圖
個op|@file///DZCI主|
自養用生式四加到國加》
；a三5：b=-2.1252
Math.log（a）=三1.6094379124341003
Math_log2（a）三2.32192$094$$7362
Math.log10（a）=0.69$9700043360189
Math_PI=3.1415926535$9793
Math._sqrt（a）=2.23606797749979
Math_abs（b）=2.1252
Math_exp（a）=148.4131591025766
Math_floor（b）=-3
Math_inax（6.0.-2）=6
Math_min（6.0.-2）=-2
Math.pov（a.3）=125
5-5-3日期物件
LE
常用的日期物件方法：
六法紀計
getDate（）傳回系統月份日期值。

|ggtDay0|使用本地時間傳回一週中的星期名稱值。

|getFullYear0。|使用本地時間傳回年份值。

|getHours0|使用本地時間傳回小時值。

使用本地時間傳回毫秒值。

|getMinutes0|使用本地時間傳回分鐘值。

|getMonth0|使用本地時間傳回月份值。2功能
|getSeconds0|「使用本地時間傳回秒數值。
傳回Date物件中的時間值，這個值是自1970年1月1日午夜零點

3
Leam0人ms人
EE圖顯示系統的日期、星期與時間。
|程式碼檔名：E_5_14.himl

1_<!DOCTYPEhtml>

2<html>

3<body>

4<pid=result'></p>

wAg號

6vartoday=newDate（）；varday；varyear；

7varhour；varminute；varsecond；

8switch（today.getDay0）（

9case0：

10day="星期天和

11break；

12。case1：

13day="星期一站

14break；

6eue

day="星期二中

17break；

18。case3：

19day="星期三生

20break；

21case4：

22day="星期四和

23break；六case5：2
day二星期五5|
26break
27case6：
28day="星期六5
2）|
30year==today.getFullYear（）；4
31hour=today.getHours0）；
32。minute=today.getMinutes0）；$84
33second=today.getSeconds0；

“34document.getElementById（"result"）.innerHTML="今天是西元："+year+"年；"+day+一
"</br>"+"現在時間："+二hour+"時"+minute+"分"+second+"秒5
35</script>
36</body>~
37</html>

|程式說明

此網頁範例為在程式中傳回時間的各項方法，因為JavaScript支援才能使用傳回
時間的各項方法。

在第8列switehcase多項選擇，因為today.getDay（）回傳當天的星期只會用1、
2、3、4...表達，所以要將它自動轉換有效星期，而使用switchcase方法'第8列
switeh（today.getDay0）為判斷變數，而case為判斷條件，因此case1判斷為1時，就
會將day變數轉換為"星期一"，而break就會自動跳離switchcase。

[執行結果
[本半生

有
frooeg
加
今天西元：2017年：星期一
說9時50分30秒

HA全
1.。試寫一個自訂函數，計算下列方程式的值：
111和
es三2十2十2二十光
n若輸入10，result=0.99902344
2.。利用while迴圈撰寫一個程式小芳想買房子，需準備300萬，而小芳選擇年
資報酬率12%的投資標的，每月固定投資1萬元，請問小芳何時才能買到房子？
高晤
了二PPZYx（1二廬
輸出範例：
小芳幾年後就可以買到房子。
3.。試寫一個可以顯示系統日期（年、月、日、星期）與時間（時、分、秒）的網頁，
畫面參考如下：
0回一%」
口DatehtmlLhtml讓
+op一
本
今天是西元：2017年：2月21日星期二
現在的時間：15時26分16秒
4.|已知變異數為離差（資料值與平均的差）平方和的平均，假設有n筆樣本資料，
計算並輸出此n個樣本的資料以及其平均值、變異數“、標準差s、最大值"旺
2了人
ry字
5.當X，Y兩隨機變數不互為獨立時，表示兩者問有關聯。其關聯的形式有很多
種，最常見的關聯為線性的共變關係。隨機變數X，Y間的線性關係可用統計量
來測量共變數（covarianee），共變數能衡量兩變數之問是否有線性關係存在。依
計算樣本X與Y的共變數Sg公式如下：
en爺
名
共變數的範例
1補人EEGyEG）G-ECGO）G-EG））
136-24$
222020
人13上，》
有和，廬113
513才12
o~二w24
30605$5
xI5
So（n-1）人
BLLTLT
/為名目年利率；刀為1年複利的次數。假設名目年利率為12%，部份輸出結果
參考如下：
EAR=（1+評眠-17.。撰寫一個資本預算的程式，對企業長期投資案的資金進行規劃與決策。評估方寺。

如下：

（1）淨現值法：投資方案的評估方法包括「淨現值法，PPJ。計算公式說明如
下：pp：將各期現金流量折現到期初之後加總。其中，Ci為第/期的現金
流量，可為正也可為負，C7o為第0期現金流量；為折現率5%；#為投資
計劃的期數。

CCE，
NPV=2好7婦
（2）「獲利指數，PIJ：計算投資計劃的成本效益比率（獲利指數）。
a_CF，
了1（+元
gu
（3）「現值報酬率，PVRJ：求NPV=0的折現率。
RE
和YIXX

Vf+Vp：基年投資實值，第0年度現值；Ft：現金流入Fl：現值因子Fl=

III+rm]；F2：現金折現因子F2=1+2）An]；PIV1：現金流入現入

PIVI~Ft*FI；P2V2：現金流入現值P2V2=Ft*F2；rl：第一估計500%：!

必：第二估計5.50%。資料來源：假設某公司有A、B、C三個互斥投資方灶

進行評估分析。資料來源：假設某公司有A、B、C三個互斥投資方案要進行評估分析，現金流

量如下：

y試分析以WPZ7、肪、人只等方法評估A、B、C三個方案。顯示結果參考如下
表，可以分開顯示。

yNP了要大於0；訪要大於1或7座要大於資金成本率才值得投資；三個方
案獨立評估。

yMWP/、號、P只分別以function方式撰寫，輸入現金流量以及折現率（#），回
傳評估值。其中，/設為5%。

部分輸出結果參考如下：

3會計的折舊方法-共有三種，試寫幾種折舊方法的自訂函數，並顯示各種方法的
折舊費用表。

（1直線法：會計學上對固定資產提列折舊費用是指在固定資產的使用年限內，
按指定的方法對應計折舊金額進行的系統分攤。提列折舊費用的方法最常見
是直線法（平均法）公式如下：
折舊費用=（成本-殘值）/使用年限=（100000-10000）/10=$9，000假設華陀醫院購入一醫療儀器其成本$100，000，估計殘值$10，000，估計
使用10年；第1到10年度；每年折舊費用；累計折舊；期末帳面價值（次
產價值減掉累積折舊）；試計算直線法每年提列同額折舊費用。

年度若虞兩記累計折舊期末帳面價什
國歡加各加還半點
國站站加加還
還寬尖加還還各還國型還加
Tegg8-5一
（2）生產數量法公式如下：折舊費用=單位折舊率，預計總使用量為200，000人
次，則
單位折舊率三（資產成本~估計殘值）/預計總使用量=（100000-10000）/
200000=0.45
若實際使用量為100，000則折舊費用三0.45X100，000一45，000每年提列的
折舊費用，視當年實際使用量而定，假設1到10年的實際使用量見下表，
請寫以自訂函數撰寫方法完成下表其他資料。

自調顏尼禮記師革虎填記累計折舊EE選本上1
TT盡TT
iT
To_BLTT（3）年數合計法公式如下：
第一年折舊費用：1TT23T~7X（成本一殘值）
-1
第二年折舊費用：1+2+57一+X（成本~殘值）
以此類推（折舊率會不斷的改變）
計算第一年與第二年的折舊費用說明如下：
10
第一年折舊費用：21+3T一十10X（100000一10000）二16，364
9
第二年折舊費用：2+3+一二10X（100000~10000）二14，727
以此類推，請寫以自訂函數撰寫方法完成下表其他資料
9.設計一個程式可以檢查輸入的身分證號碼是否正確。檢查號碼的規則如下：
由※代號說明
A：英文字母，代表出生地編碼。
N1：數字，1男2女
N2到N8：數字，真正編號
N9：檢查號碼

※驗證規則

（1）英文字母與出生地編碼對映表
若假設身份字號為Hxxxxxxxxx，表示A的代號輸入的是HH，而H對映的紡
碼為：17，令X1=1（十位數）X2=7（個位數）；若Sxxxxxxxxx則對映數字
為：26一樣令X1=2；X2=6。

（2）檢查式
Y=X1+X2*9+N1*8+N2*7+N3*6+N4*5+N5*4+N6*3+N7*2+N8*1+
N9*1。Y若能夠被10整除，就可以判斷是正確之身份證號碼。6-1選擇器（selecfor）
6-2_CSS套用方法
6-3C3SS的格式設定CSS（CascadingStyleSheets）是一種可以描述或格式化HTML網頁的標籤語言，
可以重新定義網頁標籤、頁面配置與排版設計，並美化顯示的樣式。CSS提供的功能
含選擇器可以依HTML標籤格式來設定；類別（class）則可以依同一標籤設定不同的
類別，增加套用的多樣性；樣式分內、外部套用方式，外部檔案套用方式增加樣式與
網頁的獨立性；CSS提供多種介面格式的樣式設定售背景、字型、邊框等。

6-1選擇器（selecfor）

選擇器可以是HTML的標籤，大括弧內是成對的屬性名稱與屬性值，兩者以財
號隔開，而屬性與屬性之間以分號隔開。語法如下：
選擇器（

屬性名稱：屬性值；

屬性名稱：屬性值；

）

選擇器可以重新定義整個網頁適用的<p>、<span>、<table>等標籤的格式全
如：重設<span>標籤的顏色、字體或字體大小等。格式如下：
span（

color：DeepPink；

font-family：標楷體；

font-size：30px；

）

選擇器可以依編號（id）、類別（class）、屬性（attribute）找到相對應的HTML標籤*
彈id選擇器
。生選擇器使用HTML標籤的id屬性來選擇特定的元素，此i屬性在此網頁了
拓是唯一識別，才能順利找到此過屬性的HTML標籤。要在此記命名之前加上弛
號，語法如下：#p1f
color：DeepPink；
font-family：標楷體；
font-Size：20pX；
）
HTML標籤內呼叫引用，需要使用id屬性，並輸入選擇器並加雙引號，引用
方法如下：
<pid="pl">空山不見人，但聞人語響</p>
問世說設定細頁標籤格式<p>。
1程式碼檔名：E61l.himl
1<!DOCTYPEhtml>【
2<htmb>
3<head>
4<metacharset="UTF-8'>>
5<style>
6_#p1t
7color：DeepPink；
8font-family：標楷體；
9font-size：20px；
10）
11</style>
12</head>
AV
14<pid="pl">空山不見人，但聞人語響，返景入深林，復照青苔上</p>
15<hr>
16<spanid="pl'">功蓋三分國，名成八陣圖。江流石不轉，遺恨失吞吳。</span>
17</body>
18</html>|程式說明
此網頁是介紹ess中記的範例，#字號為id的用法，如同第6列扣1，而在看
css的時，此時第14列的<p>標籤，就會套用pl的css樣式。
『執行結果
關
區E61lhtmlx
fop怕人圖
3商用王式還彈頁快訊圖重啟自訂這結口說生加>戰國>》
空山不見人，但逆人語響，返景入深林，復照靜各上
功蓋三分國，名成八陣圖。江流石不轉，遺恨失吞異。
|
||
苛clgss選擇器
class選擇器是針對特定的HTML標籤定義一個類別「.」句號再加上一個屬性名
稱，語法如下：
.backgrd（
background-color：PaleGreen；
）
HTML標籤內呼叫引用，需要使用class屬性，並輸入class選擇器再加雙引忠!
引用方法如下：
<hIclass="backgrd">鹿柴王維</hl>EE設定網頁標籤格式<h1>的class類別。
|程式碼檔名：E62.himl
1_<!DOCTYPEhtml>
2<html>

3<head>

4<metacharset="UTF-8>

5<style>

e六

站color：DeepPink；

8font-family：標楷體；

wfont-size：20px；

10》

11.backgrdf

12background-color：green；

13）

14</style>

Av

16<body>

人Bo"backerd">鹿柴王維</hl>

18<pclass="backgrd"id="pl'">空山不見人，但聞人語響，返景入深林，復照青苔上</p>

19<hr>

20<spanid="pl'">功蓋三分國，名成八陣圖。江流石不轉，遺恨失吞吳。</span>

21</body>

22</htmL>
|程式說明

此網頁是介紹ess中class的範例，「點」為class的用法，如同第11列.backgrd，

而在套用css的class時，此時第17列的<hl>標籤，就會套用到backgrd的ess樣式；
而id與class有一個極大的差異，id不可以重複套用，而class可以重複套用。[執行結果
[點加aa
口E6.2htmlxx回
個cw[ezceudsetonsAtes-如轉Go區
_操天品參到國加各說一奏國>一口還
還
』功蓋三分國，名成八陣圖。江流石不轉，遺恨失吞吳。
|
區ifribute選擇器
attribute選擇器可以針對HTML標籤定義一個屬性或屬性值。例如：以<>李
定義一個target屬性，語法如下：
altarget]（
background-color：yellow；
》
HTML標籤內呼叫引用，如下：
EL
</hl>
設定網頁標籤格式<h1>的class類別。
|程式碼檔名：E63.himl
1_<!DOCTYPEhtmr>一
2_<htmr>3<head>

4”<metacharset="UTF-8">>

5<style>

6bodyt

》background-color：MediumAquaMarine；

8）】

whl

10color：MediumOrchid；

二）

12pt

13color：BlueViolet：

14font-family：標楷體；

15font-size：30px；

16）

~當

18color：DeepPink；

19。”font-family：標楷體；

20font-size：30px；

1

和

23background-color：PaleGreen；

24）

25altarget]（

26background-color：yellow；

27》

28</style>

29</head>

30“<body>

31<hl><ahre朱"http：//fanti.dugushici.com/ancient_proses/5608"target="blank'">鹿柴王維
</a></h1>

32_<pid="pl>空山不見人，但聞人語響，<p>

33_<pclass="backgrd">返景入深林，復照青苔上</p>8堆AV人；】|
35</html>|
|程式說明
此網頁範例為attribute選擇器，與id跟class不同之處在於：attribute選擇器是寫
入屬性值中，所以attribute選擇器寫入的ess樣式會套用到相同屬性值中，比如說第
25列altarget]會將所有<atarget>套入ess樣式，而it跟class是套用到指定標籤，共
指定的標籤才會套入記或class樣式，但其他未指定的標籤就並不會套入到it或elas
樣式。
|執行結果
[包-gpdtaeJ選加還g到
/和Badamundhm
人G人lofez/D/coudst如回0：
則窒用三式晤紀頁選中圖宣TH-》
式
|空山不見人，但聞人語響，
上
了id、clgss的使用差別？
id、class與attribute三者是用來指定標籤要套入何種樣式，記與class的用法比
較普遍；而attribute比較不常用，因為通常樣式不太會隨屬性不同而有差異。id與
class最大的差別在於：
yii選擇器在HTML標籤樣式的設定只能被使用一次，而class選擇器在HTML
標籤樣式設定則沒有次數限制。y使用id可以搭配JavaScript的getElementById函數使用，方便取出網頁標籤的
值進行運算。

若沒有要用到JavaSeript取HTML標籤則建議用class，因為class的樣式設定較
為靈活，包括一個class可以有多個物件實體（instance）以及多重class的應用，說明
如下：

回一個clgss可以有多個物件實體

一個class的樣式可以同時定義多個不同的物件實體，語法如下：
span.format《

color：DarkOrange；

）

divformat（
color：DarkOrchid；

）

HTMEL網頁碼使用如下：
<spanclass="format'">言師採藥去。</span>

與
<divclass="format">只在此山中，雲深不知處。</div>
加多重clgss

同一個標籤可以同時套用多個class，語法如下：
hl.colorf

color：DarkRed；

）

hlthick（
font-weight：bold；

）hl.family{

font-family："標楷體
）

HTML網頁碼使用如下：
<hlclass="colorthickfamily">尋隱者不遇買島</hl>
|範例6：4|設定網頁標籤格式的多重class。

程式碼檔名：E64.himl
1_<!DocTYPEhtml>
2<html>
o<head>
4”<metacharset="UTF-S>
5<style>
6span.format（
color：DarkOrange；
。）
wdivformatf
color：DarkOrchid；
和
12hl.colorf
13color：DarkRed；
14）
15hlthick（
16font-weight：bold；
17
18hl.family{
19font-family："標楷體中
20）
21</style>
VARV
&$AS24<hlclass="colorthickfamily">尋隱者不遇、賈島</hl>
25松下問童子，<spanclass="format">言師採藥去。</span>
26<divclass="format">只在此山中打雲深不知處。</div>
27</body>-
28</html>
|程式說明
此網頁範例為多重class樣式，第24列<hlclass="colorthickfamily">h1同時

套用到color、thick、family樣式，而在class中只需要用空白相隔，就可以套用更多
class。在第6列span.forma與第9列div.format，而<span>標籤與<div>標籤同時使
用.forma的名稱，那就可以在.forma前加上對應標籤，而（標籤.forma）就不會衝突
到。
|執行結果

站及全全回本人

2品xi自8

<-coloms/0zw1|

各抽和呈當

尋隱者不遇買島

松下問童子，言師採藥去。

只在此山中，雲深不知處。
6-2CSS套用方法

將C88的樣式套用到HTML支件中，可以用以下三種方法（1）可以獨立儲存成

一個CSs檔案再引用至網頁中，網頁與樣式個別獨立成不同檔案，可以提高整個系
統架構的可讀性；（2）定義在<style><fstyle>之中，<style>是放在<head>內：3）定
義在同一列的標籤內。回外部連接套用（ExfernqlSfyleSheefLink）

可以藉由外部檔案套用CSS樣式，亦即將所有CSS樣式定義在另一個外部必
檔案與.html檔案獨立並儲存在同一目錄檔案下。套用方法是在HTML文人#
<head></head>之中，將.ess檔案引用匯入到網頁中，語法如下：
<head>
<linkrel="stylesheet"type="text/css”href全"style.css'>
</head>
回內部樣式套用（infernolSfyleShee）

內部樣式套用是在<head></head>內的<style></style>之中，個別定義標籤的剛
式，語法如下：；
<head>
<style>|
body（

background-color：linen；

）
hlt
color：maroon；
margin-left：40px；
》
AS
ASRV
彈行內套用（inlineshyles）

若只需要只少部份的樣式設定，可以用套用在HTML文件內的標籤直接定癌
式'，語法如下：
<h1style="color：blue；margin-left：30px；">標題樣式設定</hl>如果網頁較為複雜，專業的處理方式，建議以第一種方式，將css定義在外部檔
案，再連結引用進網頁。就程式碼與網頁內容維護效率而言，建議ess獨立到外部檔
|案，增加程式可讀性與維護性，日後樣式調整也會較為輕鬆。本章以前均使用內部樣
式套用與行內套用為主。本文以下的ess範例均改為以外部連接套用為主。
6-3CSS的格式設定

CSS格式設定，可以定義網頁外觀的設定包含：背景、字型、排版、框線、邊
鬧
台背景tpqckground）
CSS的背景格式設定有以下屬性，包含前景色與背景色、圖片等整理如下表。

常用CSSbackground背景屬性：

品AR戰

|eolor設定前景色（字的顏色）
回加
由

※有關HTML5顏色（colon）的設定可以上網查：https：//www.w3schools.com/
colors/colors_names.asp
區綁對難設計一個.css檔案定義樣式，再引用進.html檔案
|程式碼檔名：E65.himl
1ASEL：，
2<htmb|
公司RU：
全8人；加江y5<linkTV位
6_</head>|
7<body>
8._<hl>新嫁娘<hl>|
9_<p>作者：王建<p>|
10<p>三日入廚下，洗手作羹湯。</p>
11<p>未諺姑食性，先遺小姑嘗。</p>|
12</body>|
13</html>
|程式碼檔名：E65.css
1bodyf一
ucolor：yellow；|
3FIGe|
4background-position：righttop；
6_ht
7background-color：green；
人
wpt|
10color：blue；|
11background-color：yellow；|
5總
|程式說明
PT
type="text/ess”href"E_6_5.css">，rel為目前網頁與被連結文件的關係，styleste4t
表外部樣式•type中text是指對象為網頁中的檔案，css是指當前指定的檔案煤
href-"E_6_5.ess"為連接文件。[執行結果
bttueresm呈ee
HE站
*oo轉品1|
說店公轉只店在回>
社咪.上說
三日人廚下，洗手作幾湯。
|
人
回字型相關設定（Foni）
CSS提供字型各項設定，常用的CSS字型屬性表如下。
常用CSS字型屬性表：
屬性功能
|funrfamily。|設定字型，例如：標楷體。
|fonrsize|設定字型大小，以px為單位。
|ftstyle|設定字型樣式，例如：mormal、italie等。
|mrweight|設定字型粗細，例如：除funrstyle設定外，還有bordelighter等。
加字型對齊（Align）
網頁排版，最常用的文字格式化相關的屬性整理如下。常用CSS文字格代化的屬性表：
屬性可

letter'spacing設定字與字之問的距離，單位是px。

|line-height|設定每一列之問的高度。
設定文字的對百方式，right（右），left（左），center（置中），justiy（左右
置中）。
設定文字上的格式，例如：underline：文字下加一條線；overline：文
字上加一條線；line-through：文字中間加一條線；blink：文字閃爍。

|texCindent|設定每一段的第一列要內縮多少px。

加方框模型（BoxModej）

方框模型以HTMLdiv，span等命名區塊為基礎做延伸。將div定義的空間視為一
個方框，可以調控內部的距離（padding）、外部距離（margin）以及標籤的邊界（borde，
目的是格式化整個方框呈現出來的效果。方框模型的設計架構如下圖：

top
margin
border
padding
和網頁內容
bottom區border
在HTML5中，可以藉由CSS的border設定邊框，CSS常見的邊框（border）屬性
有以下幾種見下表。
常用CSS邊框屬性表：
ja功能
border-style設定邊框的樣式。
borderwidth設定邊框的寬度，使用%。
border-color設定邊框的顏色太
Lorerborom|設定下權人」
|brderlet。「設定左邊槿。
|barderright|設定右邊槿。
2到設計<p>標籤具有邊界功能的網頁。
|程式碼檔名：E66.himl
1_<!IDocTYPEhtml>
公司V：
<head>
4<metacharset="UTF-8">1
5<linkrel="stylesheet"type="text/css"hre所"EE_6_6.css'
6</head>
7<body>
8.<h3>邊框（border）屬性</h3>
9<peclass="dotted">點線邊框</p>
EL
11<pclass="solid">實線邊框</p>
E雙線邊框</p>
13“<pclass="groove'>凹線邊框</p>
14<pclass='ridge'"凸線邊框</p>15。“<pclass="inset'">骸入線邊框</p>|

16<pclass="outset">浮出線邊框</p>|

17“<pclass='none'">無線邊框</p>|

18<pclass="mix">混合邊框</p>

19</body>|

20</htmb1
|程式碼檔名：E66.css

1_p.dotted{border-style：dotted；border-color：Blue）

2p.dashed{border-style：dashed；border-color：BlueViolet）|

3p.solid{border-style：solid；border-color：Brown）

4p.double（border-style：double；border-color：BurlyWood》

5p.groove{border-style：groove；border-color：CadetBlue》

6pridge{border-style：ridge；border-color：Chartreuse）

7p.inset（border-style：insetiborder-color：Chocolate）

8”p.outset{border-style：outsetiborder-color：Coral）

9p.none{border-style：none；border-color：nflowerBlue）|

10p.mix{border-style：dotteddashedsoliddouble；border-color：Crimson）|
|程式說明

此網頁範例是介紹各種<p>標籤邊框樣式，在E.G6Gess中，border.style是站

的樣式（如下圖），border-color是邊框的顏色，而border也有許多css樣式，比如說
border-width邊框的粗細或是borderradius邊框的圓角邊界等，都可以增加網頁的美
威。|執行結果
口gAx
個cpeg5Sb即二|
才
邊框（border）屬性
還
二時二二二二二
全一
店僻）一
Ni
[加8位約斤
了一
|無線論慌
還
]
區morgin
邊界（margin）是邊框（border）以外的空間，用以定義標籤的距離。範例合併
padding一起說明。
回pgdding
留白（padding）是在網頁內容以外的第一層，CSS常見的margin與padding屬性
同兵常用CSS邊界與留白屬性表：
屬性功能
93生天生芽生天寬天生半
|margi-right|「設定右邊槿。
點
_103人
站
品
[paddinglet。「設定左留白。
不論margin或padding有一個簡便的組合設定方式（toprightbottomleft}）。例如：
設定div標籤的邊界語法如下：
divt
marein-top：90px；
margin-bottom：90px；
LA
margin-left：50px；
》
也可以設定為一行：
div（
margin：90px90px50px50px；
）|範例6-7|設計<div>標籤具有邊界、邊線與留白的網頁功能。
|程式碼檔名：E67.himl

1_<!DOCTYPEhtml>

2<html>

3<head>

4<metacharset="UTF-8">

5<linkrel'stylesheet"type="text/css"href"E_67.css">

6_</head>

7<body>

8_<div>邊界、邊線與留白一起設定。</div>

9._</body>

10<html>

|程式碼檔名：E6_7.css

1divt

smargin-top：30px；

3margin-bottom：30px；

4margin-right：50px；

5margin-left：50px；

6border：25pxsolidblue；

7background-color：yellow；

8padding：25px50px50px80px；

|程式說明

此網頁範例是介紹邊界，在E67.css中，margin-top、margin-bottom、margin-

Tight、margin-left為上下左右邊界單位為px，也有margin：30px50px30px50px用法，
分別為上右下左邊界，而border：25pxsolidblue，分別為粗細、樣式、顏色，padding：
25px50px50px80px為上右下左的內距，多使用邊界的設定，才可以增加網頁排版。『執行結果
[gugrdanJ回畫有人
>口3人人
hoNA到|轉0：
四加疝只馬加國入加前誰容語國口王國和了
阿CSS表單
HTML的表單可以藉由樣本做美工的修飾，例如下拉式選單可以設定背景與字的
顏色；文字方塊也可以設定背景、字型與字的顏色等。
|範例6：8.|試設計一個以共同基金單位數換算的網頁，並將表單美化。
基金單位數=購買金額/淨值
相同的購買金額，選不同的基金，其淨值不同，得到的單位數會不同。
|程式碼檔名：E68.hfml
1_<!DOCTYPEhtml>
2<htmb>
3<head>
4<scripttype二text/javascript"src="E68.js"></scrip選
5<linkrel="stylesheet"href="E_68.css">
e<metacharset='UTF-8"一
7</head>8<body>
9.<span>基金選擇：</span>
10“<selectid="sel'”onchange="UnitsCompute（）">
11_<optionvalue=0.1>貝萊德世界黃金基金</option>
12“<optionvalue=0.2>安聯收益成長基金</option>
13“<optionvalue=0.3>聯博-中國時機基金</option>
14</select><br>
15<span>購買金額：</span>
16一<inputtype=text”1d=三"amt"name="amount"value三"10000>
17<span>換算單位數：</span><pid="result"color="BlueViolet"></p>
18</body>
19</htm只
|程式碼檔名：E68.css
1_input[type=text]（
2Width：100%；
3padding：12px20px；
4margin：Spx0；
5box-sizing：border-box；
6border：2pxsolidCoral；
》border-radius：4pX；
_•background-color：BlanchedAlmond；
eecolor：BlueViolet；
10）
1span（
12。color：blue；
3
14select（
15width：100%；
16padding：16px20px；
~border：2pxsolidCoral：
18borderrradius：4px；19background-color：BlanchedAlmond；
20color：BlueViolet；|
21font-size：medium；i
2
|程式碼檔名：E68.j
1functionUnitsCompute（（|
說varw=document.getElementById（"sel"）.value；
2document.getElementById（"result"）.innerHTML==w*10000；
還生
|程式說明
此網頁範例使用html新增所需物件，比如說select清單、text文字等，接著再大
入css樣式設計網頁，比如說border邊框設計或是font-size文字的樣式等，然後再用
javascript寫入內建程式，將基金換算利用document.getElementById抓value值，在做
運算，就能寫出一個實用的網頁。
『執行結果
|
fop6gSRo_
讓加三料中吧點時國個
基金選擇：
當小說時齊汐從外他
購買金額：
換算單位數：參考文獻

誠http：//WWW.Wlblbi.com/

說https：//WWw.Ww3Schools.com/html/htmlcss.asp
臣http：//WwWww.l1keydata.com/css-tutorlal/tw1.。設定一個CSS的id選擇器給指定的HTML碼，CSS需採外部引用。
2.”設定一個CSS的class選擇器給多個指定的HTML碼，CSS需採外部引用。
3.”以CSS設計一個導航列。
了國
口宮若條
reop同BYE回
國還加上
Shop
sitSometexthere
AboutSometexthere
https：//www.w3schools.com/css/css_navbarasp
4.。以CSS設計一個下拉式清單。
EEEE關
口作苹4htmlxW
eeop%
下拉式清單
LVRE
|之結1|
和之結3
TTJJ）
https：//www.w3schools.com/css/css_navbar.asp5.設計一個計算股票報酬率的頁面。
G試算工具
買信人
村人
一一一一一

和各
_（賣出價格一買入價格）
報酬率=買入價格
請試輸入張數、買入價格與賣出價格後計算報酬率，並對本網頁標籤的CSS表
。單做設計。
http：//www.cnyes.com/Money/InvestCalculation.aspX？t36.。設計一個計算老年年給給付的頁面。
4老年年金給人
各才年年金給全Te
其71
出生年度：[歡一全
年齡：[_60|歲[0中個月|
|最高60個月之平均找保薪資：[10000一屆|
參加保險年資：[15]年又[0v]個月（保險年資滿15年以上，始可請領年金給付）
|
糙半潑灶澆說半潑半說半廚尖閃半准岩准閃閃半閃洁潑央說閃閃誠養誠說半說
可請領老年年金給付（以下兩式擇優發給，請參考）：
第一式計算金額：[4463]元。
第二式計算金額：[2325]元。還|
※第一式：（保險年資x平均月投保薪資x0.775%+3000元）x（1+增給比例或
1-減給比例）。
※第二式：（保險年資x平均月投保薪資x1.55%）x（1+增給比例或1-減給
比例）。
※保險年資末滿1年者，依實際加保月數按比例計算，未滿30日者，以1個月
計算。
https：//www.bli.gov.tw/cal/oldPay.asp7-1“HTMLDOM物件樹狀圖
7-2_DOM節點瀏覽JavaScript可藉由DOM（DocumentObjectModeD）存取HTML的標籤與設定標籤的
屬性。一旦瀏覽器下載完要顯示的網頁後，即會建構一個DOM網頁的物件樹狀圖見
下圖。DoM提供HTML網頁標籤與JavaSeript之問溝通橋樑。本章將說明如何以物
件的屬性、方法與事件的觀念來存取HTML標籤的資料，以及說明如何瀏覽、新增、
刪除、取代HTML的標籤（節點）。JavaScript可以藉由DoM動態更改HTML的網
頁內容與狀態包含：

yJavaSeript可以存取網頁內所有標籤。

>JavaScript可以存取網頁內所有屬性。

yJavaSeript可以存取網頁內所有樣式。

yJavaScript可以刪除網頁內所有標籤與屬性。

yJavaScript可以新增（create）與回應（react）網頁內的事件（even6）e
7Y-HHTMLDOM物件樹狀圖

DOM是把網頁文件物件模型化，以HTML的標籤與屬性為節點（mode），將各節
點連結成一個樹狀圖。以一份HTML網頁內容為例如下：

基櫥圖使用<h3>，<div>，<p>等標籤顯示五言絕句的網頁，做為後續說明
HTMLDOM結構的範例。
|程式碼檔名：E_7_1.himl
上1<!DOCTYPEhtm記
2_<html>
oAV
<metacharset="UTF-8"呈
5_<title>五言絕句</title>
e</head>
7<body>
.$3說江雪<63>說9_<div>千山鳥飛絕、萬徑人蹤滅。</div>人
“10<p>孤肯基笠仍，<ustyle="color：red">獨釣寒江雪。</u>~作者：柳宗元</p>
11_</body>
12_</html>由
|程式說明
在DOM中，html為根節點，而html有兩個子節點，分別為head、body，所以
html均為head、body的父節點。在head中也有fitle子節點，而在body也有4個子
節點分別為ht3、div、p、u，所以說在DOM中每個事件均為一個節點。
『執行結果
口崗加當多
人Opeg5sbAEST人圖ce@-
1產用程式開絹頁快訊圖宣8自訂之結口從下匯入》
片點
千山鳥飛絕、萬徑人蹤滅。
孤髓羲登翁，獨釣寒江雪。~作者：柳宗元|
RE于生和
上述HTMEL網頁內容的樹狀結構如下圖，每個節點均為物件，皆包含標籤與屬
性，可藉由DOM的屬性設定或方法取得指定節點的內容。[alfee
3由

地季候衝衝9

Attribute晶

最上層節點是document，其之下有HTML節點，接著往下分出<heaty貞
<body>。<body>下可以依需要設定<h3>、<p>與<u>標籤；<p>標籤下有網頁和
與另一個<u>標籤，<u>標籤內有設一個樣式，屬性為color。以<h3>為例，網其
容值為「江雪」。
7-2DOM節點瀏覽

樹狀結構中的節點有上下層關係，上一層節點稱為父節點（parentmodeg），下
節點為子節點（childnode），左右兩旁為兄弟節點（siblingnode），最後一層節點用對
點（leafnode），文字內容為文字節點（textnode）。

DoM提供使用者瀏覽節點並存取節點內容值，其瀏覽的順序如下國了
<body>的第一個子節點（firstChild）是<h3>，firstChild的下一個兄弟節點人
是<div>，最後一個子節點（lastChild）是<p>，lastChild的前一個兄弟節點（DE
Sibling）是<div>。還
RElastchild
7
previousprevious）人
Sibling5iblingce|Node
DoM提供瀏覽、存取與更改HTML標籤的節點集合，其屬性整理如下表。
DOM常用的節點關係表：
讀詳和功能
Los加，
frstChild回傳第一個子節點物件，含此節點以下的子節點。
Le回傳最後一個子節點物件，含此節點以下的子節點。
|extSibling回傅下一個兄弟節點物件
|wodeNameff「回全標籤節點的名稱，如：<h3>，<div>“sp>。
「wederype|回傳標久節點的種類，如：標籤“屬性、文字內容。
|範例7-2.|存取、顯示、修改網頁內HTMLDOM節點內容，搭配外部.css與
.J檔案。

|程式碼檔名：E_7_2.html
，1_<!DOCTYPEhtml>說
Nu公司V一
3<head>，
4_<metaBEST已全；
5<linkTc]二stylesheetEPTHSyByV
AIsrc=選72.js"></scrip選|
、head>08<body>二還

9<ulid="fclass"><li>房地產<li><li>股票</li><li>基金<li></ul>
10一<inputtype="button'onclick="showfirstChild0"value="firstChild'">
11一<inputtype="buttom'onclick="showlastChild0"value二"astChild'">
12。<inputtype='button"onclick='"shownodeName（）"”value="nodeName">
13<inputtype="button"onclick="shownodeType0"”value="nodeType>
14<inputtype="button"onclick="showparentNode（）"value="parentNode">
15<pid="result"></p>

16</body>

17_</htmlb>

|程式碼檔名：E7_2.css

1_input[type=button]{

2background-color：DarkSalmon；

3border：none；

4color：White

的padding：6px10px；

6text-decoration：none；

margin：3pX1pX；

8cursor：pointer

|程式碼檔名：E7_2.j

1functionshowfirstChild0（

6varw=document.getElementById（"”fclass"）.frstChild.innerHTMEL；

3document.getElementById（"result"）.innerHTML=Ww；

4）

5functionshowlastChild0（
6varw=document.getElementById（"fclass"）.lastChild.innerHTML；
7document.getElementById（"result"）.innerHTML=Ww；
8）
9_functionshownodeName（）t10varw=document.getElementById（"fclass"）.nodeName；
11document.getElementById（"result"）.innerHTML=w；
12）
13“functionshownodeType0）（
14varw==document.getElementById（"fclass"）.nodeType；
15“document.getElementById（"result"）.innerHTML=Ww；
16》
17functionshowparentNode（0《
18varw==document.getElementById（"fclass"）.parentNode.nodeName；
19document.getElementByIdC"result”）.innerHTML==w；
20）
|程式說明
此網頁範例，第2列lastChild傳回第一個子節點物件，而<ul>的第一個子節點
為<li>房地產。第6列lastChild用法大致相同，只是傳回最後一個子節點。在第10
列nodeName為此節點的標籤名稱，所以傳回值為UL。第14列nodeType為節點類
別，節點為標籤傳回1、屬性傳回2、文字內容傳回3、註釋傳回8，而此節點為<ul>
標籤，所以會顯示1。第18列parentNode會傳回父節點，而此節點<ul>的父節點為
<body>，所以顯示body。
『執行結果
ML
口中yy三x吧
人opegSBAES5EE圖CO@
引產用程式加網頁快訊圖插。誤自訂連結[|從下匯入口已匯入六|
*房地產二
|.螺計
|：相|
l
|還EE還IEDME了ll1
和房地產4弛存取HTML標籤的屬性與方法
DOM最重要的功能是存取HTML標機的網頁內容，DOM存取HTML標籤的屬
性與方法如下表。
DOM常用的屬性與方法：
時功能
5ff|人基于改HTML人和內
方法功能
getElementById（參數）依指定參數的HTML標籤取出其值。
getElementsByTagName（參數）依指定參數的HTML標籤名稱（TagName）的陣列
或清單。
依指定參數的HTML標籤的Name屬性名稱（Name）
EI參
getementsByName（數）的陣列或清單2
getElementsByClassName（參數）依指定參數的HTML類別名稱（ClassName）的陣列
或清單。
區表圖存取、顯示、修改網頁內HTMLDOM節點內容，搭配外部.css與
市蔬將。
|程式碼檔名：E_7_3.himl
1_<!DOCTYPEhtmb>
2<htm只
o人8V
<metaPE
5<linkrel="stylesheet”hre握"DOM_CSS03.css>
6<scripttype="textjavascript'src="DOM03.js"></scrip>
7人Av
@AV
9<spanclass="format">存取HTML標籤</span>
10<divclass="format">屬性與方法</div>
1<h12。<ulid="fclass"><1i>房地產</li><li>股票<li><1i>基金</li></ul>
13“<inputtype="checkbox"name="inv_exper"value="warrant">權證
14。<inputtype="checkbox"name="inv_exper"value="stock'">期貨選擇權
15“<inputtype="checkbox"name="inv_exper'value="fund">債券<br><br>
16<hr>
17。<inputtype二"button'onclick="ById0"value="getElementById'
18“<inputtype二"button'onclick="ByTagName（0）"”value="getElementsByTagName'><br>
19。“<inputtype="button”onclick="ByName（0”value="getElementsByName'>
20<inputtype="button"onclick="ByClassName（）”value="getElementsByClassName'當
21<pid=result></p>
SAECSV
|程式碼檔名：E7_3.css
1muf
2Jist-style-type：Square
3color：Brown；
*）
5input[type=button]t
6background-color：DarkSalmon；
7border：noney
8color：white；
同padding：6px10px；
10。text-decoration：none；
1margin：3pX1pX；
12cursor：pointer；
3寺
14。span.format（
15color：Indigo；
16）
17div.format（
18color：IndianRed；
9當汪|程式碼檔名：E7_3.1

1fumctionByIdO（狠

udocument.getElementById（"result"）.innerHTML=三"getElementById09；|
加人

4functionByTagName（）（|

5varww三document.getElementsByTagName（"TLT）；

6document.getElementById（"result"）.innerHTML=w[2].innerHTMEL；
區）

8functionByName（）（

9varwW=document.getElementsByName（"”inv_exper”）[0].tagName；

10”document.getElementById（"result"）.innerHTML三w；

1

12functionByClassName（）（|

13varw=document.getElementsByClassName（"format"）；|

14Yartemp0

15for（Gi三0；i<wlength；i+）（

16temp+三w[.tagName二上站
還二）

18”document.getElementById（"result"）.innerHTML=temp；
且29）
|程式說明

j檔中，第2列document，getElementByIdC'resultn）.innerHTML先抓取說為

result的物件，並修改或存取內容，而內容為vgetElementById0"。第5列documett
getElementsByTagName（"LI"）取得所有的ii，並放在w陣列中，因此第6列<選
就等同於Hi的第3個"基金"。第9列document.getElementsByName（"inv_expe門
[0].tagName取得所有name為inv_exper，並取得第1個的物件名稱。在funeti0t
ByClassName0，第13列抓出所有class為format的物件，並在第15當當圖同本是
示出來。執行結果
人點區臣信胎生回章
smDolrx7口gr和
個0C全|Gfiez//D：/cloudsta女|圈0：
下產用程式還網頁快訊圖宕銳自訂轄結口從下若入》
存取HTML標從
屬性與方法
。房地產
|“股票-
"基金
口權證口期貨選擇權口債券
Bo
回CSS選擇器存取標籤
DoM提供以csS選擇器存取HTML的標籤，兩個方法可以HTML標籤為參數
存取節點物作見下表。
六加和
回傳網頁內所有指定參數相同的標籤。
|querySeleetor（）|「同上方法，只回傳第一個符合條件的標籤。攻表下俺加Dow提供CSS選擇器存取HTML標籤。
|程式碼檔名：E74.himl
1_<!DOCTYPEhtml>
2<html>
3<head>
4”<metacharset="UTF-8'>>
5<linkrel="stylesheet"hre信"已74.css之
6。<scripttype="text/javascript"src="E_7_4.js"></scrip乜
7</head>
8<body>
9<spanclass="format">CSS選擇器存取標籤</span>
10“<divclass="format">querySelectorAlI（）與querySelector0）方法</div>
11<hr>
12。<inputtype="button"”onclick="SelectorAl10O”value="querySelectorAll>
13。<inputtype="button"”onclick="SelectorFirst（）"”value="querySelector'><br>
14<pid=result></p>
15</body>
16八號是
|程式碼檔名：E_7_4.css
1span.format
2color：Indigo；
pp
4div.format（
color：IndianRed；
6》
7hrformat（
8color：HotPink；
e*
10input[type=button]t
1background-color：DarkSalmony|12border：none；1
13color：white；
14padding：6px10px；
15text-decoration：none；
16margin：3px1px；
17cursor：pointer；
11
|程式碼檔名：E7448
1functionSelectorAI10（
2vartagname三"nput0；
3varseltag三document.querySelectorAll（tagname）；
4alert（"共有"+seltag.length+"個"+tagname+"標籤9；
we
6functionSelectorFirst（）
站Varclassname三"format"；
8varSelclass三document.querySelector（classname）；
9alert（"class的第一個元素是"+classname）；
讓0
|程式說明
在functionSelectorAll（）中，querySelectorAll為抓取所有input，但在function
SelectorFirst（）中，querySelector則是抓取第一個classname。|執行結果
計全有
品DONX和
OOoESBNR%
站產用程式關網頁快訊圖劑》
CSS選擇器存取標籤
oo與querySelector0）方法
加DOM與CSS樣式
一般CSS樣式設定是寫在網頁標籤內或CSS外部檔案內，但缺乏網頁內容維護
的彈性。DOM提供樣式物件（Styleobject）的屬性，可以提供程式設計人員依需求寫
在JavaScript內，方便藉由程式碼修改樣式物件的屬性，增進動態網頁的顯示效果。
但樣式物件屬性與CSS屬性是獨立的，兩者常用的屬性對照表如下：CSS與DOM的
樣式屬性各有幾十種。本例只列最常用的5種。
EL相1GSS屬性
Le
RSS
站
8
了[加DoOM程式動態設定CSS樣式。
|程式碼檔名：E_7_5.html
1_<!DOCTYPEhtmb>
2.<html>
3.<head>
“4<metacharset=UTF-8>
5<linkrel="stylesheet”hre所"EE7_5.css">
AS
7</head>
ed
9.”<h3>DOM程式動態設定CSS樣式<h3>
E"format">《送別》</div>
11<spanclass="format">作者：王維<span>
12。<pclass="format"id="fsize">山中相送罷，日暮掩柴扉。春草明年綠，王孫歸不歸。
AS
13人AV
14。<inputtype="button"onclick="fontsizesetting0”value="字型大小設定>
15一<inputtype="button"onclick="fontstylesetting0value字型樣式設定必
16。<inputtype="button"onclick="colorsetting0Pvalue二字型顏色設定"><br>
17</body>
18<htmb>
|程式碼檔名：E_7_5.css
1span.format（
2color：Indigo；
3》
4divformat（
5color：IndianRed；
6）
>hrformat（
8color：HotPinky
號10p.format（

11color：blue；

12background-color：yellow；

13font-size：16pt；

14font-style：normal：

15）

16input[type=button]f

17background-color：DarkSalmon；

18border：none；

19color：white

20padding：6px10px；

21text-decoration：none；

22margin：3pxlpx；

23cursor：pointer；

24）
|租式碼檔名：E75.8s

1functionfontsizesetting（）【

多varf三document.getElementById（C"fsize"）；

3說（fs.style.fontSize一"16pt0）（
4fs.style.fontSize=10pt；

多jelsef

6fs.style.fontSize三"16pt，

》

87

9functionfontstylesetting（）

10varf=document.getElementById（"fsize0）；
11放（fs.style.fontStyle一"normal）（
12fs.style.fontStyle=talic9
13jelsef

14fs.style.fontStyle三"mormalr；
15）161|
17functioncolorsetting（）
18varfs三document.getElementById（"fsize）；
19（fs.style.color二"blue"”）（
20fs.style.color三"red5
21jelsef
22fs.style.color=三"bluee；
同
24）
|程式說明
在E_75.js中，在functionfontsizesetting（）中，透過按鈕傳回值判斷字體大小，
而在第4列f.style.fontSize抓取物件的字體大小，再將原本16pt的文字改成10pt，而
在其他function中概念也是同樣的，先透過fs.style判斷，再改變其值。
[執行結果
說
|口EZ5htmlx1
I<>c人[ofez/DzcloudstationLisAteaching..玄|回0G@：
抽產用程式關紀頁歸訊圖店單自訂這結口從EE匯和戰國>>
poM程式動態設定CSS樣式
《送別》
作者：王維
IM山中相送罷，日莫掩柴扉。眷草明年緣，王孫歸不歸。|
呈二一一-一一
RE+以作業第7題資本預算的程式為例，對企業長期投資案的資金進行規劃與決策。
對其執行結果的表格與網頁背景進行DOM的CSS物件屬性設定。動態設定背影
顏色、表頭顏色、字體改為標楷體。

品NEV加[人
_>人因國
國加各扣加加生衣加回癌下直可加加站
oo。59_5還加加宮_

2.”撰寫一個輸入銷貨收入與銷貨成本，即可計算毛利額跟毛利率的頁面，請將檔案
分.html，.css，：js以DOM的方式撰寫。
計算公式：

毛利額=銷貨收入-銷貨成本：
毛利率={（銷售收入-銷售成本）/銷售收入）*100%

3.。撰寫一個輸入毛利率與銷貨成本，即可得知銷貨收入與毛利額應為多少的頁面，
請將檔案分.html，.css，.js以DOM的方式撰寫。

4.。撰寫一個貨幣轉換器，可以將新台幣與人民幣、日元、歐元、美元、英鎊做匯率
的轉換，請將檔案分.html，.css，.js以DOM的方式撰寫。

※假設人民幣與新台幣的雌率為1：4
※假設日元與新台幣的匯率為“1：0.3
※假設歐元與新台幣的匯率為“1：35
※假設美元與新台幣的匯率為“1：30
※假設英鎊與新台幣的匯率為“1：405.”基礎代謝率（BMR）是指：我們在安靜狀態下（通常為靜臥狀態）消耗的最低熱
量，人的其他活動都建立在這個基礎上。那麼，如何計算自己的基礎代謝率呢？
美國運動醫學協會提供了以下一個公式：

BMR（男）=（13.7X體重（公斤））+（5.0x身高（公分））-（6.8x年齡）+66
BMR（女）=（9.6x體重（公斤））+（1.8x身高（公分）-（4.7X年齡）+655。
試寫一個BMR計算器，請將檔案分.html，.css，.js以DOM的方式撰寫。事件處理
8-1JgvqsScripfInlineEvenf
8-2JogvgsScripfDOMEveniLisfener事件（Even0）處理的功能是當HTML標籤被觸動時'JavaSeript可以做適當
應處理，例如：啟動執行對應的JavaScript自訂函數進行後續的處理程序。事件有可
能是由瀏覽器（或作業承統）觸動也可能由使用者從表單或標籤中觸動。事件被人生
的可能時機如下：

y當瀏覽器下載完畢時。

y文字方塊輸入完畢時。

y下拉式選單變動時。

y按鈕被點選時。

y其他。

JavaSeript的事件處理有分為兩種分別是：JavaSeriptInlineEvent與JavaScript
DOMEventListener，說明如下：
8-1JovqScripfInlineEven+

JavaScriptInlineEvent，按下按鈕標籤之後呼叫事件，啟動JavaSeript自訂子數人
行處理。

優點Fi
r標籤與程式合在同一行，程式與HTML不易分開維護，不利程
式規模化。
站
還拓光y不支援同個標籤設定多個相同事件，無法應用在較複雜的情境。
y寫在HTML的JavaScript不會被快取

JavaSeript可以九許當事件觸動時，執行指定的自訂弛數做後闌的運算。最和
用的事件是oneliek0，當使用者在表單上的按鈕按下滑鼠左鍵即會啟動相對應的
LE
即選項被改變，會啟動相對應的JavaSeript自訂函數，進行運算。JavaScript常用的事件處理：
加避
|mmBlur0|當使用者離開某一欄時即觸動事件。
|nehange0|當標籤的項目被改變時即觸動事件。
|wnelick0ff「當使用者按下按鈕時即觸動事件。
|wnmouseovert）「當使用者將滑鼠移動進標籤範圍即觸動事件。
|mmouseout0|當使用者將滑鼠移出標籤即朋動事件。
|wnkeydown0ff|當使用者按下鍵盤即觸動事件。
|onload0。|「當瀏覽器下載完畢即觸動事件。
|qnFocus0ff「當使用者的輸入焦點進入表單的某一欄時即觸動事件。
|wnSelect0。ff「當使用者點選某一欄的內容時即觸動事件。
「mmSubmit0|當使用者確定送出某表單時芭妥動事件。
[aumsad0當正在顯示的網頁被改變時即觸動事件。
區弧澡圖零存整付（月）試算
月存20000元（本金，PV），利率6%（年利率），存24個月，本利合511182.30，
IFVIFA為25.559115。
公式如下：
本利合=PV*FVIFA（年金終值利率因子，FutureValueInterestFactorofAnnuity）
l+月利率）X（（l+月利率））-1
FVIFA=月利率
年利率
月利率=12
|程式碼檔名：E8_1.himl
1_<!IDocTYPEhtml>
2_<html>
3<head>
lnkrerstylesheet'hrefr"E.8_1.ess只>5<scripttype="text/javascript"src="E_8_1js"></scrip選
6<metacharset="UTF-8">
7</head>
8<body>
9<p>零存整付試算</p>
10<formid="depositform">
11_<p>存款金額（元）：<p>
12<inputtype="text"id="amount"name="amount"value="100"><br>
13<p>年利率（90：<p>
14一<inputtype="text"id="rate"name="rate"value="3"><br>
15<p>期數：</p>
16一<inputtype=text"id="period"name="period"value="59><br>
17。<inputtype="button"id=="deposittype"onclick="clubsavings（）"value="試算必
18“<inputtype="reset'
19</form>
20<br>
21一<pid二"result"></p>
22~</body>
23</html>
|程式碼檔名：E81.css
1input[type=text]（
2Width：10%；
padding：12px20px；
4margin：8px0；
5box-sizing：border-box；
6border：2pxsolidCoral
>border-radius：4px；
8background-color：BlanchedAImond；
9color：BlueViolet，
107）
11input[type=buttonj，input[type=reset]【12background-color：DarkSalmon；
13。border：none；
14color：White
15padding：6px10px；
16text-decoration：none；
17margin：3pX1pX；
18cursor：polnter
）
20pt
21display：inline；
22color：blue；
23）
|程式碼檔名：E81.js
1functionclubsavings0（
2varpv三parseInt（document.getElementById（"amount"）.value）；
3vari=parseInt（docunment.getElementById（'rate"”）.value）/100；
4varn三parseInt（document.getElementById（"period”）.value）；
5ee
6fif三（（1+（/12））*#（Math.pow（（1+6/12）），已
~入三fvlfa*pDv；
8document.getElementById（"result"）.innerHTMT=本利和三主十fvtoFixed（2）
ee人；
|程式說明
此網頁範例為零存整付試算，onclick觸發將網頁上，所有物件以id形式傳到程
羿中，並白取value值使程式加以使用，而在程式運算中，也利用parseInt將value轉
成繼數方便計算，最後再將計算完畢的解答顯示在網頁上。|執行結果
零存整付試算
swamp：[選
sw]
8
區到
|資料參考來源：
LALE
6-2JoqvqScripfDOMEvenfLisfener
新式的JavaSeriptDOMEventListener，讓按鈕標籤與JavaScript程式獨立，
JavaScript藉由標籤中的id屬性啟動事件監聽進行相對應的處理，優缺點如下：
商盎缺點
HTML標籤與JavaSeript切割，增加網頁與|
程式的維護性與可讀性。電務可光攻。
一個listener可藉由輸入參數'啟動多個事
件處理，彈性較大。
可支援同個標籤設定多個相同事件，無法應
用在較複雜的傅境。
8-2-1“EvenfLisfener的介紹
JavaScript可以藉由addEventListener（）與removeEventListener0）等進行監聽與移
除事件物件的功能說明見下表。JavaScript監聽相關的事件處理：
下功能
addEventListener（）將事件處理的程序附加到網頁內容中指定的HTML標籤。
移除某一個addEventListenert）的方法。
停止addEventListener（）方法繼續向下或向上的其他事件傳播程序。
回新增一個事件處理監聽的語法
object_instance.addEventListener（event，function，propagation）；
人提示
obiecf_insfonce是物件實體才
監聽事件處理的參數說明：
還生叨劑
ai物件實體可以藉由getElementById（）函數取得HTML標籤或是windows
Pa5e|物件，指定被監聽的標籤"（必要變數）
|wwent|要觸動的事件名稱見上表。（必要參數）
HR
布林值，true或false，設定執行時要用capture（true）或bubble（false）的
|事件處理方式。（非必要參數）
加事件處理傳播（propqgoHion）流程
當使用者點擊標籤（例如：按鈕）時，事件即會被註冊，但如何在網頁中所有的
標籤找到那個標籤才是首要被觸發此事件的呢？也就是說網頁DOM所有節點都有機
會處理，找到指定節點負責處理的這個流程，即稱為事件傳播（eventpropagation）。
addEventListener方法提供第三個參數設定事件處理傳播流程分為兩種：
capture（設定為true）與bubble（設定為alse）。舊版瀏覽器只支援bubble傳播方式，建議此參數先設定為false，確認瀏覽器
支援capture時，再設為true。
1.cgqplure（由上而下）

事件由上而下做事件處理傳播。若採capture傳播方式，事件會從document先起

作用，再往下傳播，首先段落會收到點擊，然後才是超連結。傳播流程見下圖實

線箭頭。

2.bubblet由下而上）

事件由下而上做事件處理傳播。在bubble期，時間從外部起作用，所以，超連結一

會比段落更先收到點擊。

傳播流程見下圖虛線箭頭：

由
-
】一一一capture用作合描
1
8-1-2撰寫EveniLisfener的時機與方法

EventListener監聽的程式碼可以放在網頁檔案html檔案內的<body></body>或

放在JavaScript程式的.js檔案內。加網頁檔案內
EventListener程式碼要寫在<body></body>內，而且這段<script>程式碼要寫在
form表單之後。
區焉到零存整付的範例結合EventListener監聽的程式碼
|程式碼檔名：E_8_2.himl
1_<!DOCTYPEhtml>紡
2_<htmb>
3.<head>
4<metacharset="UTF-8>
5<linkrel="stylesheet"”href"E_8_1.css">
6<scripttype="tex4avaseript"srce="E_8_1js"></scripb>
7</head>
8._<body>
9_<p>零存整付試算</p>
10<formid="depositform>
11<p>存款金額：<p>
12一<inputtype="text"id="amount"name="amount”value="100'"><br>
13<p>年利率：</p>
14一<inputtype="text"id="rate"name="rate”value=3><br>
15<p>期數：</p>
16一<inputtype="text"id="period”name="period”value5><br>
17一<inputtype="button"id三"deposittype”value二試算>
18<inputtype="reset'">
19</form>
20<br>
21<pid="result"></p>
AC
23varx=document.getElementById（'"deposittype"）；|
24。”x.addEventListenert（"click"，clubsavings，false）；
.25cpLU信和26_</body>|

27_</html>|
|程式說明

此網頁範例與E81範例相像，但有些許不同，此網頁在html中寫入
addEventListener，而addEventListener為一個事件發生時，addEventListener所套入的
標籤就會運作，比如說第24列x.addEventListener（"click"，clubsavings，false），click為
點擊時人觸發，而addEventListener寫入標籤為<form>，因此觸發button就會執行，而
執行事件為clubsavings，所以還是會套入到ES81.js檔中，並作程式運算，最後false
為程式執行由上而下，反之為trme時，就是由下至上。
gbadg檔案內
EventListener程式碼也可以寫在.js檔內，其獨立於自訂函數之外，由window視

窗呼叫addEventListener監聽。
|程式碼檔名：E8_3.himl

1_<!DOCTYPEhtml>

2<htmb

3<head>

4<metacharset二"UTF-8"一

5<linkrel="stylesheet"hre全"ES_1.css">

oaAREA

7_</head>

8<body>

9<p>零存整付試算</p>

10<formid="depositform之

11一<inputtype="texf'id="idamt"name="amount"value二"20000">

12一<inputtype二"text記二”1drate”name=rateValue三"6

13“<inputtype="text"id一"id_period"”name="period”value="24'>

14。<inputtype三"button"="deposittype”value=試算$

全號語上16</form>

17<br>

18<pid='result"></p>

19</body>

20</htmb>
|程式碼檔名：E_8_3.js

1functionclubsavings（）（

2varpv三parseInt（document.getElementById（C"id_amt”）.value）；

3vari=parseInt（document.getElementById（"id_Tate"）.value）/100；

4varn三parseInt（document.getElementById（"id_period”）.value）；

5varfv；Varfvifa；

6Bif=（（1+6G/12））*（Math.pow（CI+6/12）），m-0）/（1/12）；

7學字區

8document.getElementById（"result9）.innerHTML二本利和=$"+fv.toFixed（2）；

字

SEEEL

1varXx=三document.getElementById（"deposittype

12x，addEventListener（"click"，clubsavings，false）；

re
|程式說明

此網頁範例與前兩題接近此網頁將addEventListener寫入到ES83.js中'而
寫在程式中的addEventListener又如何去判斷點擊的事件。在網頁連接到程式，而
在E83j中第10列視窗載入時addEventListener觸發，並執行imetion0，所以將
E82的概念再呈現一次，達到在程式中也能執行addEventListener。
[執行結果
同前題。上陸才能
8-1-3結合移除事件監聽功能
本案例是結合事件監聽與移除事件監聽的功能。
我們加入6個按鈕，移除監聽與啟動監聽，並於js檔案內先啟動所有事件監聽，

再按下按鈕決定移除或啟動監聽。

加EE圖啟動與移除事件監聽。

|程式碼檔名：E84.himl
1_<!DOCTYPEhitml>3繼
2<hfml>
3<heod>
4<mefgchorsef="UTF-8">
5<linkrel="sfylesheef'href="propqgqHion.css">
6<scripftype='"exijqvqscripf'src="propqgofion.js"></script>
7</heod>
@AUOQV
9。<h3id="h3_Hile">《宿建德江》作者：孟浩然</h3>
10<divid="div_poefry'>移舟泊煙渚，日暮客愁新。
11<pid="p_poehry">野曠天低樹，江清月近人。</p></div><br>
12_<inputtype="bulion"onclick="remove_H3_evenitj"vqlue="移除h3監聽
13<inpuftype=“buffon'onclick="sfqrl_H3_evenit"vqlue=+啟動h3監聽吃
14<inpuffype="buiion'onclick="remove_P_event0"vqlue="移除p監聽心
15<inpuffype="butiononclick="sgrlP_event0"vqlue=+啟動p監聽必
16<inpultype="buffon'onclick="remove_DIV_eventt'volue=-+移除div監聽>
17一<inputfype="buffon'onclick="stgrl_DIV_evenitj"vglue=啟動div監聽必
18</body>
19</hfml>ma：E84.css
1
|2color：DarkOrange；
4divt
1background-color：AliceBlue；
16color：DarkOrchid；
7border：lpxsolid；
|8padding：20px；
人
10“input[type=button]（
11background-color：DarkSalmon；
12。border：none；
13color：white；
一padding：6px10px；
15text-decoration：none；
16margin：3px1px；
17cursor：pointery
18》
|程式碼檔名：E84.j
1window.addEventListener（"load"，function0（
多start_P_event0；
3start_H3_event（0）；
4start_DIV_event（）；
IsD》
6functionremove_H3_event（0（
7varh3_node=document.getElementById（Ch3title9）；
8h3_node.removeEventListener（"click"，click_h3，false）；
9
10functionstart_H3_event（（
1varh3_node=document.getElementById（'h3_title"）；12。h3_node.addEventListener（"click"，click_h3，false）；只
13
14functionclick_h301
15alert（"您點選的是<h3>"）
16）》
17functionremove_P_event（）（
18varp_node=document.getElementById（C'p_poetry）；
19”p_node.removeEventListener（"click"”，click_p，false）；
a）
21functionstartP_event（）（
22varp_node=document.getElementByIdC'p_poetry）；
23p_node.addEventListener（"click"，click_p，false）；
24）】
25functionclick_p0（
26alert（"您點選的是<p>"）
7
28“functionremove_DIV_event（）（
yo上-
30div_node.removeEventListenerC"cliceke，click_div，false）；
31》
32“functionstart_DIV_event0（
33vardiv_node=document.getElementById（"div_poetry"）；
34div_node.addEventListener（"click”，click_div，false）；
357）
36functionclick_div0（
37alert（"您點選的是<div>"）一
%
|程式說明
此網頁範例是說明如何移除addEventListener，程式第1列就先局生
addEventListener，所以在一開始只要觸擊對應標籤，網頁就會顯示對應標籤名"IM何移除addEventListener將一開始新增的addEventListener改為.TemoveEventListener時
並且所有對應值都要相同，這樣就可以移除addEventListener。
|執行結果
口propagationhtmlXxXWV
人>》G全|Gfie///D：/CloudstationzLISAvteaching/教材/boo人圈0
廬應用生式加綱頁俠記圖時說是林連結口從EE匯入口已國入>
《宿建德江》作者：孟浩然
移舟泊煙渚，日卓客愁新。
野曠天低樹，江清月近人。
|結果說明
傳播事件的第三個參數設為false，即依bubble方式傳播，當使用者點選標題：
《宿建德江》作者：孟浩然時會觸動h3_node.addEventListenerC"click"，functionO{alert（"
您點選的是<h3>"）；}，false）；視窗為出現「您點選的是<h3>」如下圖：
這個網頁顯示：8
您點四的是<ha>
口防!上此網頁產生其他對話方塊，當使用者點選標題：「野曠天低樹，江清月近人。」時，會觸動
div_node.addEventListener（"click"，function（）{alert（"您點選的是<div>"）；），false）；
p_node.addEventListener（"click"，function（）{alert（"您點選的是<p>"）；}，false）；

兩個監聽事件，而<p>是包含在<div>之內。所以，當使用者點選詩的內容時會
觸動z與x。結果會先顯示<p>，再顯示<div>如下圖，此即為由下而上的bubble事
件傳播流程：

這個網頁顯示：x
你點還的是<p>

口上上此網頁大生其他對話方趨，

這個網頁顯示：
您點選的是<div>

口防止此網頁產生其他對話方志

若使用者點選標題：「移舟泊煙渚，日暮客悉新.）時，只會觸動
div_node.addEventListener（"click"，function（）（alert（"您點選的是AVfalse）；

結果會只顯示<div>。8-1-4修改為cqpule事件傳播方法
只要將propagation.js內的6個false，改成tue，即完成設定傳播方式由bubble
改成capture，由上而下傳播方式。重新瀏覽時，再點選網頁上的「野時天低樹，江清
月近人時，即會先出現「您點選的是<div>」後出現「您點選的是<p>」如下圖：
這個網頁顯示：六
您點過的是<div>
口防上此網頁音生其他對話方坦
這個網頁顯示：有
你點和選的是<p>
品防止此網頁理生其他對話方塊
|參考文獻
whttps：//javascript.info/bubbling-and-capturing
說http：//www.hksilicon.com/articles/4337
>http：//wwwwibibi.com/info.php？tid=384
>https：//www.w3schools.com/jsref/met_document_addeventlistenerasp加早點
1.。試寫一個按鈕，點擊下去時觸發事件呼叫alert，並且當滑鼠游標移上此按鈕時可
以變換成其他顏色，滑鼠游標離開時恢復原本顏色。
2.。”設計一個網頁頁面載入完時，可以顯示今天的年月日，按下確定並可自動關閉此
頁面。
3.。試寫一個一個頁面，當滑鼠遊標移上一個div時，可以觸發事件隨機產生0~1的
變數顯示至頁面上，並寫一個按鈕可以移除div上隨機產生變數的事件。
4.。試寫一個輸入存款金額、利率、每月利息，即可計算存本取息的動態網頁。
試算說明：
將本金一次存入，按月單利提取利息，期滿取回本金
存戶得約定以固定或機動利率計息
存款金額一（200，000）
年利率（%）一（6）
每月利息一（1，000）
試算公式：
本金*利率*（1/12）
https：//www：bok.com.tw/-14
PTDOMEventListener的寫法。5.”試寫一個可選擇月/週來選定利率，輸入存入金額，即可試算出本利合。
計算說明：
客戶可選月或週一（月）
客戶輸入存入金額後，按「試算本項J一（3000）
得出試算結果一（6150.0）
客戶只要選月，利率以美元一年期牌告利率計算；選週，利率以美元6個月
期牌告利率計算
試算公式：
本利和=本金+利息
利息=本金*利率*存款期間/12
https：//www.bok.com.tw/fun-project-cal
檔案分.html，.css，js；使用JavaScriptDOMEventListener的寫法0g
股價走勢圖
2-1線圖
員
|9-2自動產生序列
|？-3讀入外部檔案
9-4plotiy畫出的圖形操作方式
9-5多條線圖/Plotly.js是開源（opensource）的免費程式，屬於專業性質的畫圖開源碼，雖然圖
表的外型不太吸引人，但其資料分享與串接方面的功能很實用。

前後端平台都一致適用的畫圖工具，前端網頁可以使用plotlyjs；後端伺服器若
是架設pythonDjango也可以使用plotly，前後台可以使用同一套畫圖工具，語法相
通。ploty.js的資料呈現是採用JSON格式，提供前端函數庫繪圖所需的標準資料格式。
9-1線圖
國圖使用plotlyjs畫最簡單的線圖
|程式碼檔名：E9_1.himl
1_<!DOCTYPEhtmb
2<html>
3AV
4。<metacharset="UTF-S">
5<scriptsrc二"https：//cdn.plot.ly/plotly-]atest.min.js"></scrip選
6<scripttype二textjavascript"src="E_9_1.js"></scrip>
7_</head>
8._<body>
9_<p>最簡單的線圖</p>
10<divid="epf"style="width：802；height：200px；"></div>
11</body>
12<htmb>z
|程式說明

第5列<scriptsrce="https：//cdn.plotly/plotly-latest.minjs'">是可以在網頁中使用
plotly功能。
|程式碼檔名：E91.1
站WindowaddEventListenertvloadrfunetion0
2showplot（；eese_人；
4functionshowplot（）（
5varEXpP=document.getElementById（"epf0；
6_Plotly，plot（ExpP，[（
7xx[123，45.6，7
誠y：[0.125，0.25，0.5，.1.2，4.8]，
9marker：4（
10color：DodgerBlue'
1））14|
12margin：（EE1
13》所
|程式說明
在一開始視窗載入時，會先連結到showplot（），在showplot（）中，Plotly.plot會建
立一個走勢圖，而使用者設定xy軸。，並將線的顏色與大小設定後，放入至ExpP中，
所以div才會顯示走勢圖。
。執行結果
回一%-
口pletolhtmlx和多
個op[@fie///CZUsers/user/Desktop/plotly/plo六|多：
生導用程式SAs@LogonManas半
最簡單的線圖和
ae7
畫
。和
和
|
246點畫指數函數，fx）=2Ax（2的x次方）
|程式碼檔名：E92.himl
1_<!IDOCTYPEhtml>
N八已V
o公司EV
4”<metacharset="UTF-8'>
5<scriptsrc="https：//cdn.plot.ly/plotly-latestLmin.js"></Scrip騙
6。<scripttype="text/javascript"src="E_92.js一</scrip選
7人AV
8<body>
9<p>Exponentialfunction指數函數，ftx）=2^x</p>
10一<divid="epfrstyle="width：809%；heipht：200px；"”></div>
11_</body>
12</html>
|程式碼檔名：E9.2.8
1window.addEventListener（"”load"”，function0《
LE
8的
4functionshowplot（）（
5varExpP三document.getElementById（"epf）；
6varxi三蟬：vary1三山
7for（三11<還=
8六二
9yi區=Math.pow（2.1）；
10）
1console.log（xi）；
12console.Iog（yi）；
13Plotly.plot（ExpP_[
14XX
15vs）16marker：（
17color：red'
18二
19margin：《（tE1）））；
202凍
|程式說明
一開始將x設立一個陣列，並將x陣列放入1到7，而y也是設立一個陣列，並
放入2的1到7次方，接著把陣列設定xy軸中，那就可以看到一個2的X次方的曲
線圖。
|執行結果
0一回一
區pletol_l.htmlxW
個opefile////C7ZUsers/user/!視他：
5：應用程式eSAS@LogonMana：
Exponentialfunction指數函數.fx）==2X加
二
100|
：|
g由
2和6還
1》人plotly.js提供的免費圖表型態：
區功能
[圖
|還「長圖
_二
_S圖
人
_（qq「生
|seneur作詩說
6加
sw二
ah：二和
|meseres「時間所圖
「sndlestek加
[she一
資料來源：https：//plot.ly/javascript/
INGSEE謂本本生de
11人
說3加國El語說加|：」xo"人加
上ga-x_+eE
二085和
TTEPTUTUIIII
時3_14H33=
和比5人還還-
TT三=
回回7
[La
全二人
「太
加條放蟬9加了9-2自動產生序列
JavaScript自動產生x軸的向量0到5.5，每次遞增0.05。y軸以x軸的值取平方
後再取cos函數。
若對圖畫cos函數曲線圖，公式如下：
Ra
||程式碼檔名：E9_3.himl
1_<!DOCTYPEhtml>
2<htmb>
3<head>
4<metacharset="UTF-8">
5<scriptsrc二https：//cdn.plot.ly/plotly-latest.min.js"></scrip選
LEEEL
7</head>
@AV
9<p>三角函數，fty）=cos（x^2）</p>
10一<divid="epf'style="width：90%；height：400px；"一</div>
）11</body>
12</html>|
|程式碼檔名：E93
1window，addEventListener（"load"，function（）《
'2showplot（）；
|了）
"4functionshowplot0《|
|諺varExpP==document.getElementById（"epf9）；
||6varXi三[var三中vark三0
說neAyVT
_•和9yiIk]=Math.cos（Math.sqrt（i）；

10kr|

人

console.log（i；

13。Plotly，plot（ExpP_[（

14X：Xi

15y：yi

16PEN

】、6

18color：'DarkOrange'

ww？

20）；

me
|程式說明

此程式要做一個cos函數曲線圖，而在第9列Math.sqrt為次方函數、Math.cos為

傳回餘絃函數，再將運算結果放入陣列中，並設定xy軸與第16列type：'bar，將圖表
內容改成長條圖顯示。mU
加EE同時
BB條加
"op加co
LE2芝
回四旬+回回祥條點，
ii|j|）衝
1
度一
人
點加圖
則半生一
lem大打
0圖Ww和
||二2
全re加EL
9-3讀入外部檔案
IM圖其入文字檔包合日期、開篆價、最高價、最低價、收禾價，畫K線圖。
|程式碼檔名：E9_4.html
<htmlb>
2<head>
3<metacharset="UTF-8'|
4<seriptsre="https：/cdn.plotly/plotly-latestminJs~/Scrp人7
5<scripttype一tex的avascript-LELE一
6</head>|
由
2說店8<inputtype=file'accept=text/plain'onehange~openFile（evenD><br>
w全
10</div>
二AV
E人人；
|程式碼檔名：E9.4j8
“1window.addEventListener（C'load"，function0
2if（window.File&&window.FileReader&友window.FileList&&window.Blob）（
//alert（"Greatsuccess!AlltheFileAPIsaresupported."）；
4openFile0）；
5）else（
6alert（TheFileAPIsarenotfullysupportedinthisbrowser.）；
7
mm
9functionopenFile（even6）（
10varinput=event.target；
11varreader=newFileReader（）；
12varnumary；
13readeronload=function（）（
14vartext三出
15varnode=document.getElementById（'output）；
16text=readerresulty
17numary=strtary（tex6）；
18drawplot（numary）；
19）
20readerreadAsText（input.files[0]）；
-）
22functionstrtary（rawdata）（
23varsizeary==rawdata.length；
24console.log（"size="十sizeary）；
和webylne=rmwdaasplttu；26。varrow==strbyline.length-1；
27varcol=90；
28num三neWArray（row）；
29for（i=0；1<Iowii+）（
30le（
31LE
記咯選三>人
33num[三strbyline[i].split（CAD）；
34
35jelset
36num[]=newArray（co1）；
37num[i=strbyline戰.spIitCADO）；
3
39》
40console.log（"mum="十num[l）；
41）
42retumnum；
歡）
44functiondrawplot（numary）
45vartracel=
為x：numary[0]，
4open：numary[1]，
為high：numary[2]，
49low：numary[3]，
50close：numary[4]，
51decreasing：{line：{color：7F7F7F）
52inereasing：（line：（color：#17BECFD），
53line：{color：rgba（31119，180，D），
54type：'candlestick，，
255xaxis：X0
56yaxis：
258vardata二三
人

60dragmode：'zoome

61margin：（

62上

63Le

64b：40，

65160

66和

67showlegend：false，

689

69autorange：true，

70domain：[0，1]，

畫1Tange：[2017-01-02，'2017-05-05']，
NTangeslider：{range：[2017-01-0292017-05-05），
73title：Dateo

74type：'date'

7

76yaxis：（

77autorange：true，

78domain：[0，世，

sTange：[150，200]，

80type：Tinear'

81

82height："auto"，

83Width："auto

84

85”Plotly.plot（'output，data，]ayou0）；

8）：|程式說明
此網頁範例將股票資訊轉為K線圖。在openFile中將文字檔傳入程式中，strtary
再將openFile傳來的文字轉為陣列，並做一個統整及編輯，而編輯後的陣列，才會丟
入到drawplot中做K線圖，在drawplot也會做K線圖的編排及設計。而此網頁是將
抓來的股票資訊以K線圖呈現，所以並未套入交易策略。
|執行結果
0王生加人生大公品名回二
poe-them三廬
人=C人|Gfie///D/Cloudstation/LSAteaching/孝材/book/fintechpython/prog/p如轉0：
遇天用程式前到加加人加己太全加>口已國入1收穫區724）-letylin二
MRr
點回吧旬直田回ai有
200z
=一
195的
甩||上
二=一
190三一|踢4了
和
上」和
二三|
160禮
Jan8Jan22Feb5Feb19Mar5Mar19Apr2Apr16Apr30還
2017中
|
Date-文字檔（stock2330.tx0）的格式參考如下：
作手胃還和
201771/220177/1732017717/42017/1/5~
161.51183182184184184.5“185182.518（
181.5183.5184183.5184.5185185.5“185185.5182|
181.5181181.5181.5183.5183183.5181.5182.518（|
181.5183183183.5184184184182184.5181
HRyy瑟四

第一列是日期，只含年月日；第2列至第5列分別是開、高、低、收的股價資料。
9-4plolly畫出的圖形操作方式

plotly的圖形畫出來後，可以在現在的圖形上做（1）圖形局部放大；（2）存檔；（3）
資料視覺化--.等。

9-4-1”圖型放大

將滑鼠移到最下方的白色透明小長條圖往右接，可以將資料長度縮短到最近日其

的資料，K線圖會看得比較明顯如下圖。|

、口下上x人回SOqBx\NWN林全光鞭名和
fop感人圖
圖二：
旗上
200
似笠

195站二
了

：
中-

185用

時

加

180如

Apr2Apr9Apr16Apr23Apr30|1

2017同
加加濕謂點，一
Date

9-4-2”存檔到本機
將滑鼠移到圖的右上角會出現一排圖示功能，點選照像功能Downloadplotaspng
存檔的圖示即可存儲成.png圖檔到本機。
gm月+回四會癌和9-4-3資料視覺化
plotlyjs提供一個資料視覺的使用者介面，將滑鼠移到圖的右上角會出現一排圖
示功能，點選Saveandeditplotincloud的圖示可以存檔在雲敵，即可進入資料視覺化

使用者介面如下：
下
人二人lg1htps7/plotuyAreate/一還
一說還生頁公所要宣生生四還謂3全下還和如戰國>了和加品四ooo9e昌去Boosmamsoa|
廬加點E站還全325“間關點國；
回過？3|
人
eg還
了人一
1點
1癌點
如回：|用1
生圖lMi
】上[3
~店
g
和|
L1rsg!C7二一
操作說明如下：
>上圖中間的x即為x軸資料。
>Open，High，Low，Close分別設定開、高、低、收資料。
>右上角的Grid是各欄位的資料明細。
>按左下角的save，可以選facebook身份登入後存檔。
yChartType可以更改型態樣式，選OHLCchart即可將圖型改成高低圖見下圖；
或在E94j檔案中第54列type改成'ohle'即可呈現高低圖。it二
fopb6人@i
讓戰擱」28瓦店
還mE匈路回回條生，

195||人
上
to=三：二|」三三【

二

一了三

和二

Jan8Jan22Feb5Feb19Mar5Mar19Apr2Apr16Apr30
2017

濕=es和店則四|

Date

2多條線圖
股價走勢圖常需要多條線顯示在同一張圖當中，例如：股價走勢圖中的常出現多

條移動平均線（短、中、長）於圖一張圖上。

一張圖中，需要畫收盤價線圖、5日移動平均線、10日移動平均線、
“20日移動平均線，並標示買進與賣出點，判斷規則如下：
買進：收盤價>5日移動平均且收盤價>10日移動平均且收盤價>20日移動平均；
賣出：收盤價<5日移動平均。出場：最後一天前有買進，但沒有賣出訊號，以最後一天收盤價出場。
.y（實出價-買進價）
累計報酬率：2買進價
圖上標示符號請參考以下網址：
包https：//plot.ly/javascript/line-charts/#abelling-lines-with-annotations
https：//plot.ly/javascript/text-and-annotations/
|程式碼檔名：E95.hfml
1_<html>
2<head>
3<metacharset="UTF-8"呈
4<scriptsrc二"https：//cdn.plot.ly/plotly-latestmin.js"></scrip>
略<scripttype="text/javascript"src="E95.js"></scrip選
6</head>
7<body>
8<inputtype二file'accept='text/plain'onchange='openFile（event）><br>
we信二
10</div>
11</body>
'12</html>
|程式碼檔名：E95.js
1window.addEventListener（"load"，fnnction0（
加if（window.File有人window.FileReader&&window.FileList&window.Blob）（
3//alert（"Greatsuccess!AlltheFileAPIsaresupported.9）；
4Su
）elset
6alert（"TheFileAPISarenotfullysupportedinthisbrowser9）；
時
8
710functionopenFile（even6）

11varinput三event.targety

12varreader=newFileReader（）；

13varNumAry，

14varn三5；varm三10；

15readeronload三function（f

16vartext三|

17varnode=document.getElementById（'output）；

18text=readerresult，

19”//原始資料由字串轉陣列

20NumAry=StrToAry（tex0；

21”/計算移動平均：參數1為原始資料、參數2為天數、參數數3為新增列數
22”/計算5日移動平均

23NumAry=MovingAverage（NumAry，n，NumAry.length）；
24”/計算10日移動平均

25NumAry=三MovingAverage（NumAry，m，NumAry.length）；
26。//刪除移動平均為0的資料

27NumAry=EraseMAOCNumAry，NumAry.length-lm》；
28”/畫走勢圖

29BuySelIMark=BuySellCNumAry）；

30。drawplot（NumAry，BuySellIMark）；

過）

32readerreadAsText（input.files[0]）；

33）

347//將原始資料由字串轉陣列

35functionStrToAry（rawdata）（

36varStrByLine=rawdata.split（An）；

37varrow=StrByLine.length-1；

38varcol=90；

39num=newArray（row）；

40fort=0ii<rowiir（

41le（42StrByLine[i]=StrByLine[ilreplace（A/g，"-）；
43num戰=newArray（col）；

44num[=StrByLine[i.splitt0）；
45）elset（

46num[]]三newArray（co1）；

47num[i]=StrByLine[i]Lsplit（AO；
說）

49Le一

50】

51“console.log（num）；

人Teturmum

53）

54//計算n日移動平均

55“functionMovingAverage（data，n，rm）（
56varMoveMean三有

57varSumV三0；

58data[m]三newArray（90）；

59forG=0ilcn-11（
PE

61

62。for（vari=n-1i<90；iH1（

63SumV三0

64consolelog（呈=!二1

65forCvarj=j>=inr1j1
67console.Iog（"data[4][P+j+上三"+data[4）；
68SumV+二parseFloat（data[4]忠）；
69
70MoveMean=SumV/呈
如console.log（"SumV="+十SumV）；
72console.log（"movemeav="十MoveMean）；
73dataIm][]=MoveMean；74console.logC'data[S]"+i+吉="+dataIm][）；

soMoveMean三中

說

77console.log（data[5D）；

78returdata；

7

80/刪除移動平均後值為0的資料

$1functionEraseMAO（data，row，m）（

82for（vari和01是<<

83data[i].splice（0，m）；

84

85returmdata；

86）

87//鄰斷買賣點並標示符號

88“functionBuySeIJ（NumAry）

89varcol=NumAry[0].length；varxbuy==[戰varybuy=品varxsell=戰varysel=[

90var三0；vark三0；varflag=false；varresult三newArray（3）；

91for（vari=0；i<colbi+=1（

92。。許（CNumAry[5][]>NumAry[4][）&&（NumAry[6][>NumAry[4][）&&fiag一
false）

93xbuy戰三NumAry[O]中；

94ybuy[戰=NumAry[4中；

95flag=true；

96上

）

ELfiag一
true）（

99xselIk]=NumAry[0]戰；

100。ysel[k]=NumAry[4戰；

EL

生三

E）3記說104
105result[O]=xbuy；
106result[1Tybuy；
107result[2]Fxsell
108result[3J-ysell
EL
110returmresult；
111）
112//畫走勢圖
113functiondrawplot（NumAry，buysellxy）（
114varcol=NumAry[0].length；
115vartracel1=
116。type：'scatter，
117。x：NumAry[0]，
118。y：NumAry[4]，
119mode：lines
120“name：'收盤價，
121lne：（
122color：red
123width：1
124
go
127vartrace2=（
128type：'scatter，
129。x：NumAry[0]，
130。y：NumAry[5]，
131mode：lines，
132name：5日均線（MA5），
133line：（
134。color：blue
135width：1136）

137

138

139vartrace3三

140。type：'scatter，
141。x：NumAry[0]，
142。y：NumAry[6]，
143mode：lines
144name：'10日均線（MA5）
145lne：（

146color："green
147Width：1

148

149靖

150vartrace4=

151x：buysellxy[0]，
152y：buyselxy[1]，
153mode：'markers+text，
154name：'買入點
155textposition：topo
156type：'scatter'

157

158

159vartrace5=
160。x：buysellxy[2]，
161y：buyselxy[3]，
162。mode：'markers+text，
163name：'賣出點
164textposition：topo
165type：'scatter
5

167LaIIILT|
169varlayout=|
170“dragmode：'zoomo
171width：800，

172height：800，

173“showlegend：true，

174。xaxis：（

175autorange：true，

176domain：[0，1，

177。range：[2017-01-2，'2017-05-5，

178Tangeslider：{trange：[2017-01-252017-05-51），

179fitle：，Dateo

180。type：'date'

181|

182yaxis：（

183autorange：true，!

184。domain：[0，1]，

185range：[150，200]，

186。type：linear

187）主

188

189。“Plotly.plot（'output，data，layout）；

190）》]
『程式說明

在openFile中與前題範例相同，將文字檔匯入到程式中，而在StrToAry與前題

LO中
計算所有的移動平均，而最後在drawplot來繪出所有的走勢圖，比如說開盤價、買入
賣出點、以及各個移動平均，使走勢圖更加完善。[執行結果
生革江人
口peto2htmlxx品pealhmlxpowhtmx/
全一0C全|fie///C/ZUsers/user/Desktop/plotly/plot4.html主|人
站窒用王式eSAS@LogonMana-
[本夫stosk2330.t和
上回匈+C：一
一
一一收螢價|
|計划要
10日二級（
2
195*走出點自
和
1
CO|
N由
4全
站和
190圖
還N|
和姑|
加
：|
“ON
180
Jan22Feb5Feb19Mar5Mar19Apr2Apr16[Apr30
20171
LESLECE
二（賣出-買入）
買入
多次報酬率請計算平均報酬率、累計報酬率、最大報酬率、最小報酬率。
2.。加入MA5，MA10，MA20三條均線糾結判斷並標示買賣訊號，當收盤價同時大於
MA5，MA10，MA20時買進；當收盤價低於同時MA5，MA10，MA20賣出，同上
題計算報酬率等資料。
3.”加入停損機制，當買入股價回跌一個自訂比率（例如：5%）時賣出，即賣出訊號
出現即賣出。計算報酬率等資料同上題。
|參考資料來源
產https：//plot.ly/javascript/getting-started/
產https：//plot.ly/python/line-and-scatter/
>https：//plot.ly/javascript/reference/#scatter-line-color
誠https：//www.html5rocks.com/en/tutorials/file/dndfiles/
yhttp：//stackoverflow.com/questions/3146483/htm15-file-api-read-as-text-and-
binary/3146509#3146509
yyhttp：//www.javascripture.com/FileReader
>http：//www.blueshop.com.tw/board/FUM20041006152546UBK/BRD200809280425
34ASM.html
EL
w瑟同
yhttps：//read01.com/oOJdGPhtml
鐘https：//plot.1y/javascript/bubble-charts/CHAPTER10
hNFLE

Djgqngo架設與APP實作

10-1MV框架

10-2Djgngo框架

10-3DjgngoWebserver架設

10-4建立Web專案

10-5setifings.py做Djgqngo環境設定

10-5DjqngoApp

10-7urls.py設定與網頁連結

10-8Templgfes

10-9Djqngo管理靜態檔案

10-10重新啟動伺服器Django功能類似MVC網站開發軟體框架（softwareframework）'它是由Python
所開發。所謂軟體框架是指制定一套規則或規範，讓程式設計師在此規則下開發並實
現軟體任務。本篇會介紹MVC框架、Django進行網站開發與網站的測試與佈署。
10-HIMTV框架

MVC（Model，View，Controller）由TrygveReenskaug在1978年提出，其目的為實
作一個動態程式設計框架，使後續的程式維護與擴充更有效率，提高程式重覆使用的
機會。而Django採用的則是MTV的模式，與MVC的對照見下圖，MTV把軟體系
統分為Model、Template、View以及Django本身，MVC則將軟體系統分為Model、
View、Controller三個部分。

Template&
MRView|
人
0

yModel：程式在應用面的功能，對資料庫進行資料存取以及資料庫管理設定。

yView：操作的圖形化介面設計與資料呈現。

yyController：處理Web相關請求（request）與回應（response）。

Django在Python的Web開發應用很廣泛，其優勢是使Web應用程式複雜的開
發、資料庫連結與資料呈現變得簡單、快速。Django的MTY觀念類似MVc，但做
法有些不同，比較如下表。|Django與MVC的對照表：
功能TE資料控制與整合
me了tameaesvewDs
MTV與MVC最主要的差別如下：
1.Djqngo將資料內容與呈現的方式分離
MTV的view是指定網址後執行某python函數，並決定指定的Template（樣
板），回傳資料給Web使用者。簡單的說，Django的View之功能是輸出要呈
現的資料，而Template則是決定Web使用者使用什麼版型看這些資料。所以，
Django的Template加上View的功能對應到MVC的View功能。
2.Djgngo的confroller是自己本身
Dijango的MTV的框架中並沒有controller，若真要對應到MVC的話，那就是
Django本身。因為Django在收到請求後，由Django自己決定對應的View，此
View是由urls.py檔案中設定對應處理，見ulrs.py設定節中說明。
10-2Djqngo框架
Django的Web架構建立在MTV框架下，瀏覽器（Browser）傳送請求給伺服器
（Server），並轉給URL，再藉由View內的python自訂函數處理特定功能；Template
協助網頁的版型做介面顯示；Model提供資料庫處理需求之後再回傳給瀏覽器，見下
圖。
1.URL網址配置功能是由urls.py來分配URL傳進來的請求（request）對應到views.
py內的自訂函數。
2.views.py函數處理完後可以將結果：（1）直接回傳（Response）給Browser/Client；
（2）回傳給Template，依定義好的版型回傳給Browser/Client。3.若需要資料庫存取則View會先藉由Model呼叫資料庫（Database），'資料庫可以
是mysql、sqlite等，雙向讀寫資料庫後，將結果回傳給View，再由View決定回
傳給Browser/Client。

Django的MTV架構做到程式與版型分離，以及資料庫跟controller（Django）分

開，這種框架有利對於程式設計師跟網頁美工人員之間的互相合作。

人303yAg88ydjango-admin.py
manage.pY
settings.py

語說了
ResponseRequest
8View讓views.py
條“
說3吾同
汪汪
1一
加

10-3DjgngoWebserver架設
DjangoWebserver架設步驟可以在Windows作業系統下安裝完成，本節將解說從

軟體下載、安裝、設定、測試的各項步驟說明。
>安裝dango、mysite、myapp
yy設定參數settings.py
y安裝runserver>設定參數urls.py，Views.py，*.html
>測試。
回下載與安裝
如果你還未安裝Python環境，需要先下載Python安裝包，我們建議使用最新版
本的Python3。
上
但請記得你安裝的路徑是什麼，在設定環境變數的時候會用到，例如我的預設
phon352Gzsgsagup一口X
AdvancedOptions
口instalforalusers
回AssodatefileswithPython（requiresthepylauncher）
回Createshortcutsforinstalledapplications
口AddPythontoenvironmentvariables
）口precompilestandardfbrary
口Downloaddebuggingsymbols
和口Downloaddebugbinaries（requiresVS2015orlater）
Customizeinstalllocation
[swws
pUthon
for
WindowsTR_[Losa][ens
Li
彈設定環境變數
寢裝完成後至開始功能表旁的「搜尋Windows搜尋關鍵字"環境變數"，並
點擊+編輯系統環境變數"，接著再點選最下方的"環境變數"按鈕，在「系統變數，
下的Path裡進行編輯並加入新的值（原本的值必須保留，用分號隔開），加入的路徑
是Python安裝時的路徑，你需要根據你的實際狀況來安裝。有
g3點說訓訓漠絢人
兄數什
Path%USERPROFILE%NppDataMLocaNMicros-
TEMp%USERPROFILE9NAppDataNLocaNTemp
|[me%USERPROFILE96wppDatavMocaNTemp
人Ma|細D-|生MO
系統覺數（5）
旦數什>
Comspecpi
NUMBER_OFPR_1
oswindows_NT
PathCMindowsvsystem32；CNWindows；CANWE-人
[aeaa]au
人
班定||取消
|二se
「紡融環境旦數一：
OO人多0新增（ND
96SystemRoot96
%SystemRoot9eNSystem32XWwbem[sa|
9%SYSTEMROOT96xsystem3ZMWindowspowershelNv1.0N
|CMUsersNuserAAppData\NLocaNProgramsNPythonNPython35-3蛋[十@-
完成後，可以打開命令列（cmd），輸入Python看看是否可執行，只要出現以下的
畫面就成功了。|圖含令提示字元-python
各劑日生廬卻時卅人
2016MicrosoftCorporation.著作權所有，並保留一切權利。|
LEuLL
下讓王吉加相放性三加
ST扣于生放半
|
加安裝Pyihon管理工具
Python中有很多工具可以對包進行下載和安裝，這裡用的是pip。可以在Python
官網上的PyPI裡下載get-pip.py。
下載完成後，使用cmd命令進入資料夾，在cmd介面裡輸入pythonget.pip.py，
pip就會被成功安裝，安裝成功後，並不能馬上在cmd介面上使用pip命令，必須先
配置pip的環境變數，按上面配置Python的方法配置pip的環境變數，只不過最後
添加的路徑改為上面安裝Python時的路徑再加上Scripts，因為安裝成功後，pip的
可執行文件在"Scripts"資料夾裡面。在emd中輸入pip在按Enter，介面會出現pip
的相關命令。
阿用pip安裝Djgngo
安裝好pip後，安裝Django就很簡單了。先從cmd介面進入到Django的資料
夾裡，輸入pipinstalldjango'pip會從網路上自動下載最新的Django包，下載完成
後會自動安裝，當cmd介面顯示：Successfullyinstalleddjango-1.10.2，說明Django
安裝成功。
打開Python的介面，輸入importdjango，'如果沒有顯示錯誤，代表Django可以
正常使用。10-4建立Web專案

安裝web伺服器的電腦必須有要固定的IP位置，例如：140.120.125.1。

我們想設計一個web網頁做存款試算程式，藉由前端HTML5設計使用者介面，
將資料送到後端.py的程式計算完，再送回前端。本節將教您體驗從頭到尾建一個
web版的試算程式，此程式需分兩個步驟：

y前端表單網頁：設計一個可以讓使用者瀏覽存款試算的網頁，可以依第2章

E22.html為例。

y後端管理平台：提供使用者送存款資料後，計算存款試算結果，並回送前端網

頁。

本節將介紹後端管理平台-Django的server架設。假設大家是初學者，第一次全
用Django，就必須了解Django的初始化操作。

10-4-1建mysife專案

在作業系統cmd視窗下輸入以下指令：

pythondjango-admin.pystartprojectmysite回確認djgngo-gqdmin.py所在路徑
假設讀者是依第一冊書的建議（Python程式設計-金融管理實務案例）安裝
Anaconda3.6，則django-admin.py是安裝在C：NUsersVuserkAnaconda3\NScripts>才下
因此，建議先在作業系統（假設是windows）搜尋django-admin.py所在的路徑才
能執行。當然，也可以複製到你要建mysite專案的路徑下再執行以下步驟。
回環境變數設定
在第一冊第2章整合開發環境有介紹如何設定Anaconda3的環境變數，之後才能
在cmd視窗下正常執行Python的程式，如要呼叫Python執行dango-admin.py程式。
以windows10為例，點選視窗左下角「程式集」圖，輸入「環境變數」即可進入到
系統內容視窗見下圖1，再點選「編輯」即見下圖2，新增Anaconda3路徑見下圖3。
關閉Anancoda相關程式，重新啟動。
系統內容X
電腦名稱三趨。途階【系統保護這生
您必須以系統管理員的身分登入，才能學更這裡的太部分設定
效誕
視覺效果、黑理器排程、記悟中使用量和度舞記皒
La
EL
關於您登入時的自面設定
PT
啟動及收復~
系統啟動、系統矢敗、及價錯資訊一
[0
gp|
|
[三下[到還Be誤次洁史詩x|
|
一
3中入澡重濟訴馬|
中上。全|
民國還|
TEMpssUSERPROfiLESswppData\MLocaNTemp|
TMpssUSERPROHLEsswppDatavNLocaNTemp
新潑（MD細加（0||旨除（D）|
了|
r-x|
一
加加計加還還全3|
_ng5353SEG和
|CNuseruserwnaconda3UbrarAbin盅品刁
LETE|
||瀏鑒（9
|0
|La|
回執行djgqgngo-gqdmin.py
筆者的程式是放在c：wvebfintech下，則在cmd視窗透過命令列cd\指令切換c槽
根目錄c：'再使用cd切換到儲存程式的資料夾（cdwebfintech），並在此路徑下執行，
見下圖。
區公信示字元!口x
條人人下加>
馬公剖入閃主
和各FACE在了呈拉克
<指令執行完畢就會在你指定的路徑（cNwebfintech）建立「mysite」資料夾。此資
料內有manage.py以及另一個mysite子資料夾，此子資料夾另有4個檔案分別是
inti__，py、settings.py、urls.py以及wsgi.py，結構如下。
cNwebfintech>pythondjango-admin.pystartprojectmysite
mySite/

manage.py

mysite/
_imit_.py
settings.py
urls.py
Wsgl.py

wmanage.py：透過manage.py管理Python內的命令列工具，即提供程式設計師
方便Python與Djange互動並管理專案。

y_init_.py：此檔案是空白的，讓Python知道這個目錄要被視為Python的套
件。__init__.py的功能是初始化。在作者第一冊的第8章物件導向程式設計中
有說明。

ysettings.py：本Django專案的設定檔。

>urls，py：本Django專案的URL設定檔；同時也是你的Django網站的「目錄，。

>wsgi.py：wsgi（WebServerGatewayInterface）是網頁開發標準，wsgi是Python
用以定義網頁程式與伺服器溝通的介面。它是以cgi為基礎開發給Python呼叫
使用的。wsgi定義一個標準的溝通方式'，讓你寫的Python程式可以和伺服器
Django溝通。10-4-2啟動Djqngo的伺服器
mysite專案建立完成後，第二步驟是啟動Django建立伺服器。即可在本機敵
（loealhost）瀏覽網頁了。請在cmd視窗切換目錄到mysite資料夾再執行如下指令即可
成功啟動伺服器'，見下圖。
pythonmanage.pyrunserver
[ae0
由HE和
5到。人；
tt全入全7人1DE中人134抽汪
人
伺服器啟動成功後，即可到瀏覽器輸入以下網址http：//127.0.0.1：8000檢視Django
啟動成功的網頁見下圖。
|D_welcometoDian9goxee人
|個CCGi270013000全主：
ltworked!
CongratulationsonyourfirstDjango-poweredpage.
Li生人
seeng太rsbecauseyouhavepE8u6。TrueinyourDjangosetin9sfileandyouhavent10-5seffings.py做Djqngo環境設定
開啟settings.py的程式碼，弦數名稱以大寫命名做Django環境設定，包含：作
業系統路徑、資料庫、瀏覽器與伺服器的溝通介面、應用程式安裝、除錯、網址配
置、語言與時區等。除預設值之外，可以依使用者需要做額外設定。
回作業系統路徑[BASE_DIR）
設定本機電腦架設此專案的基本路徑，先取得_fle_檔案下的絕對路徑
os.，path.abspath（_file_）；再取此絕對路徑的上面兩層的路徑，所以要用兩次os.path，
dimame（）。
BASE_DIR=os.path.dimame（os.path.dirname（os.path.abspath（_file_）））
檔案所在的路徑是在mysiteAmysitevsettings.py的結構如下：
mysite/
mysite/
settings.py
因為settings.py檔案是放在C：webfintechvYnmysitemysite資料夾之下，因此BASE_
DIR的內容值會（往上兩層）是：
C：Vwebfintechvnysite
即BASE_DIR指的是專案目錄的路徑•也就是上層mysite路徑。
回資料庫設定（DAIABASES）
為單純化本節的重要，資料庫先採用預設的sqlite3來當資料庫伺服器（server），
後續章節介紹資料庫時會再引用其他Django支援的資料庫。
DATABASES=（
defaulb：（
ENGINE員ango.db.backends.sqlite3，NAMEos.path.join（BASE_DIR，'db.sqlite30，
）
）
匠瀏覽器與伺服器的溝通介面（WSGL_APPLICATION）
wsgi.applicaiton是在Python專案（mysite）中的伺服器啟動（runserver）時內建在
wsgi.py之中。
wsgi.py建立的wsgi.application是可以被呼叫的物件，即將呼叫mysite.wsgi.
application應用物件並指派給WSGIL_APPLICATION。
WSGIL_APPLICATION='mysite.wsgi.application'
歡應用程式安裝
LA與應用程式（applieation）不同之處在於：可依不同功
能撰寫不同的應用程式，多個應用程式以及基礎設定可以組成一個網頁專案（web
project）。
可以依需要將相關的applieation隨時拔插或做更換設定。應用程式預設安裝的應
用程式（INSTALLED_APPS）如下：
INSTALLED_APPS=[
django.contrib.admin
EL
崗ango.contrib.contenttypes，
崗ango.contrib.sessions，
崗ango.contrib.messages，
喇ango.contrib.staticflles
」回除錯

專案與應用在測試階段，settings.py內的除錯（DEBUG）設定為開啟狀態，待測試
完畢'上線前即要在關閉除錯模式，以免有資安的漏洞。
DEBUG=True
回網址與網頁配置

在網址與網頁的配對是「根網址設定」（ROOT_URLCONF）參數的功能。

Django建立的專案可以設置多個網頁配置檔，分別對應網址與網頁且必須在
settings.py中設定根網址的設定參數。
ROOT_URLCONF='mysite.urls'
回語言與時區（LANGUAGE_CODE、TIME_ZONE）

Django預設的時區與語言是美國與英文。可以改成台灣時區與中文語系。
LANGUAGE_CODE='zh-Hans'
TIME_ZONE='Asia/Taipel
10-6DjqngoApp

一個Django裡面由一個Web專案和多個Djangoapps所組成，app可以想成是類
似模組的概念，每個app專注在網站上的某個功能，這樣的好處是同樣的功能就不用
重寫，也方便未來的維護和重複使用。回建立一個Djgngoqpp

在終端機下，讓我們利用startapp來建立第一個Djangoapp'在mysite/的資料雁
下，輸入pythonmanage.pystartappmyapp，我們可以看到我們建立了一個名為myapp
的app，這個目錄中的檔案如下：
myapp/

migrations/

imit_py

_init_.py

admin.py

models.py

tests.py

views.py

ymigrations：用來存放databasemigration，可以把database調整到符合現在code

的狀態，這些調整就會記錄在裡面。

”__init_.py：讓Python知道這個目錄要被視為Python的套件，裡面通常是

空的。

yadmin.py：與Django後台相關。

rymodels.py：代表資料，通常是用來與資料庫溝通。

ytests.py：寫測試代碼。

yviews.py：為web專案裡urls.py的對應。
加將新增的DjgngoQPPD加入seffings.py設定檔

我們剛剛新增加了一個app•但若要讓Django知道要管理哪些app，所以我們還
必須調整設定檔。

首先先打開mysite/settings.py，找到INSTALLED_APPS'在裡面多添加一行為自
己的app名稱再用單引號包住，並用逗號隔開，例如：INSTALLED_APPS=（
Wango.contrib.adminu
二由ango.contrib.auth，
EL
-員ango.contrib.sessions
|'django.contrib.messages
|ELPE
|myappo
）
|請注意app之問有時候需要特定先後順序。在此，我們將自訂的myapp加在最後
生電梯條打全用render的時候'Django會自動找到INSTALLED_APPS中列出的各
個app下的Templates的文件，後練將會加以說明。
110-7urs.py設定與網頁連結
Django以網頁的方式與使用者互動，urls.py的主要功能是是做樣版（patters）與行
|動（action）的對應。pattems（例如：命名為gogo）指出現在網址後面的檔名如下，而
|action是指對應此網址會執行views.py內的函數並回傳資料給瀏覽器，即action是一
|個放在views.py的函數。
http：//127.0.0.1：8000/gogo/
所以pattems與action的配對設定會指派給urlpatterns這個變數，urs.py的檔案
內容如下：
1fromdjango.confurlsimport點人；二
2fromdjango.contribimportadmin|
3_frommyappimportviews
4urlpattems=[1
5url（r^admin/，admin.sife，urls），
6url（r^gogo/$，views.pylinkweb）#新增這一列|
人URL與view是有對應關係的'，Django從網頁（URL）收到請求（Tequest）後，根據
不同的請求，再決定要執行哪個viewfunction，並回傳（response）給URL；

而urls.py所指派到的views.py的檔案內容如下：
1fromdjango.shortcutsimportrender和一
2fromdjango.httpimportHttpResponse|
3defpylinkweb（reques0）：|
4TetumHttpResponse（"Django讓python能方便連結網頁"9）|

這樣一來只要網址輸入http：//127.0.0.1：8000/gogo/，系統就會在urls.py對應到第
6列的（r^gogo/$），並執行views.py裡的第3列pylinkweb（）函數，然後再把值回傳在
網頁上，如下圖：

|上!口x

口5人0全

<clon27000a0009ogo/林圖了0i

Django課python能方便連結網頁
10-8Templqtfes

實務上，我們會將前端的程式碼獨立出來，因為HTML的部分可能是由前端
程師所人負責，如果我們把HTML的部分寫在views裡'會造成維護及修改上的困難，
因此我們會把html放進Templates資料夾裡面，不但能增加可讀性，也方便維護。

在自己創的app裡'建立一個Templates資料夾（只能在這個路徑、取這個名
字）•在預設的設定下'Django會自動找到app下面的Templates資料夾中的文件，
我們可以用Templates資料夾內的文件在網頁上來顯示內容。一絡台

10-9Djqngo管理靜態檔案
網頁伺服器端時常需要有效管理多個靜態檔案（包含：圖檔jpg、JavaSeript檔

J5、樣式檔.css等）。Django提供django.contrib.staticfiles模組協助管理這些靜態檔

案。以下說明Django伺服器端管理多個靜態檔的操作步驟。

1.確認在settings.py中的INSTALLED_APPS有包含django.contrib.staticfiles，如下：

INSTALLED_APPS=[
django.contrib.admin，
jango.contrlb.auth
django.contrib.contenttypes"，

員ango.contrib.sessions
LE
ango.contrib.staticfiles，

myapp，

]

2.確認在settings.py中的STATIC_URL有包含static資料夾，如下：

STATIC_URL='/static/

3.在Templates同路徑下增加/static/myapp/E_10_1.js，即在Templates同路徑下自
行新增static/myapp資料夾，並將要加入的靜態檔realdata.js放在此資料夾當中
如下。

FEELLE

mySite/

myapp/

Staic/
myapp/
E101js4.在網頁（E_10_1.html）的<head>..，</head>加入載入靜態檔的設定指令如下：
（9%1oadstatic9%】
<scriptsrc=196static"myapp/E_10_1js"%）></scrip>

了IZ圖veb版的零存整付動能網頁試算表APP實作
寫一支python程式接受網頁資料，並計算本利和=存款金額*（1+年利率》
Em；
我們先在mysite/mysite/urls.py輸入下列程式碼：
1fromdjango.confurlsimporturl|
2fromdjango.contribimportadmin||
3frommyappimportviews|1!
4urlpatterns=[|
5url（r^admin/，admin.site.urls），|
6urltr^go/$，views.pylinkweb），#新增這一列
7url（r^fv/$，views.deposits），#新增這一列|
@url（r^result/$，views.resul0，#新增這一列|
|程式說明
第7列新增一個127.0.0.1：8000/fv的URL，來對應到views.py裡的deposits這個

function，將E_10_1.html的內容顯示出來。第8列新增了一個127.0.0.1：8000/result的

URL，接著會透過E_10_1.html將資料以AJAX的POST方法傳送進來這個result的

URL裡，進行處理計算後再回傳至E_10_1.html顯示。

在mysite/myapp/views.py輸入下列程式碼：
1fromdjango.shortcutsimportrender

2fromdjango.httpimportHttpResponse
3defpylinkweb（request6）：

4retumHttpResponse（"Django讓python能方便連結網頁9）5defdeposits（request）：|
6retumrender（request，E_10_1.html，0））

7defresult（request）：

8EL

下已

10”n=int（request.GET[periodj）

1fv=str（（pv*（（1+0**n）））

12。retumHttpResponse（fv）
|程式說明

第6列用render方法將E_10_1.html回傳至頁面上。第8一10列用request.GET
來接收使用get方法傳送過來的值，第11列計算完後，第12列將計算完的結果回傳
回去。
在mysite/myapp/Templates/建立一：E_10_1.html，內容如下：

|程式碼檔名：E_10_1.himl

1<!DOCTYPEhtml>
2<html>

3<head>

4<scriptsrc="http：//code.jquery.com/jquery-3.1.1Js"></scrip選

5（%loadstatic%）

6<scriptsrc="（9%static"myapp/E_10_18NA

27</head>

28“<body>

29<p></p>

30_<fieldset><legend>計算本利和：</legend>

31存款金額：<br>

32<inputglid=="amountP"name="amount"><br>

出年利率：<br>
34。<inputtype="text"id="rate"name="rate'"一<br>

35期數：<br>

人36一<inputtype=”（extid="period"name="period”><br>]

37一<fieldset>

38br><buttontype=buttoneid=btn>送出!</button>

39。<p>本利和：<spanid="result"></span></p>

40</body>

41html>
|程式說明

第5列為載入靜態擋資料夾的指令。第6列為設定讀取的靜態擋資料夾路徑與
檔名。
囝使用Djgngo引用靜態檔案
在mysite/myapp/static/myapp/建立一：E_10_1.js，內容如下：

|程式碼檔名：E_10_1.js

1S（documen0.ready（function0f

2$（C#btn9）.click（function（04

3varamount三$（”#amount”）.va10）

和varrate三S（7#rate”）.val0；

5varperiodFEEL

e到

7tpe：'GET，。/傳送方式

8url："/result"，//傳送目的地

9data：（有要傳送的資料

10“amounr：amount，

1EL

12'period：period

1）

14suceess：function（Data）（/*假設後端執行"成功"後，做以下動作

15（Data是回傳內容）好

16$（”#result"）.html（Data）

~18error：function（e）（”/*假設後端執行"失敗"後，
19做以下動作（e是錯誤訊息內容）#/
20console.log（e）；
1）
177》
18
19））
|程式說明
在第2列透過按下id為btn的按鈕時觸發事件。在第3、4、5列透過id取得
inputtype="text"裡的3個值。第6列執行AJAX方法，以GET的傳送方式將這筆資
料傳送到路徑是127.0.0.1：8000/result（對應到views.py中的第7列）、以及要傳送的3
個參數，接著等待result處理完資料。
如果成功的話，會執行第14列的successfunction，最後將計算後的值回傳至頁
面上。可是當失敗的話說會執行18列的ecITOTfunction，將錯誤訊息console出來了方
便程式員debug找出問題。
以本機執行網址如下：
http：//127.0.0.1：8000/fv/
[執行結果
Munuhxe@egxses6
人opooe5g全
LE》
計算本利和：
地
到加
期加1
若區
林和：10-10重新啟動伺服器

EL
加網域設定

設計好的網頁要如何傳到伺服器提供使用者瀏覽，必須要先設定伺服器連線的
網址。
回網域申請

學術網路向各校計算機網路中心申請；校外人士向所屬的電信公司申請（如中
華電信），申請好的網域可能如下：letykuas.edu.tw，其對應的固定p為140.xxxxxs.
xxx'請讀者依自行申請好的網域名稱設為操作的步驟基礎。
回防火牆設定

防火牆是電腦用來防禦外部攻擊的一個程式，預設會阻斷外部連入的所有連線，
除非有額外開啟，因此若伺服器動後無法從外部正常連線，很有可能的原因就是未
將防火牆關閉，此時我們只要針對要允許外部的連線可正常通過防火牆連線到伺服器
便可，在Windows7上，防火牆的設定可在"控制台\系統及安全性Windows防火
妝\克許的程式"找到。
回設定網域

settings.py設定網域，在任何一列加入以下指令
ALLOWED_HOSTS=[lety.kuas.edutwo'140.133.70.9']
阿重新啟動伺服器

重新啟動伺服器必須要在unserver最後加入IP位置與port，如下：
pythonmanage.pyrunserver140.133.70.9：8000'耕系統管理員CNWindowsNsystem32\cmd.exe-pythonmanage'pyrunserver140.133.709：8000「：己：釦區3
9eeCCOy人~
jQuittheserueruithCTRL-BRE6K-
NotFound：/
LENE全和廬計
rmoo
18/May/291711：99：381"GET/fauicon-icoHTTP/1-1"4942258
INotFound：/
[18/May/291711：99：49】"GET/HTTP/1.1"4942229
ELELE
0二22時說1和說
REunseruer149.133.79-.9：89g99g
LE2ULL
LT下六9坊襄
5EL0碩Ti說
os0下
5
人人人殼
xx10加要汪11銜櫥直上
GIDU
F上
eg放人王下的同
EN人TE5所1E吧041~
池|竺
回重新瀏覽網頁
lety.kuas.edu.tw：8000/fv/
川口35xe@8xed6x
個LE記
5FEELTE店
計算本利和：
存款人金額：
年利率：
期數：
本利和：|資料來源
鍊http：//mropengate.blogspot.tw/2015/08/mvcdjangomtv.html
人https：//docs.djangoproject.com/en/1.11/howto/static-files/
ryhttps：//Stackoverflow.com/questions/6014663/django-static-file-not-foundML

1.在DjangoServer上，撰寫一頁面，使用者可輸入n，程式可求出多項式
（1H2）+（244）+G46）+.+（Cmr2*n）的和，以Ajax的get方法完成。

2在DjangoServer上，撰寫一頁面，讓使用者輸入兩個整數（ab），然後將兩數相
乘，若乘積超過（含）100以上，則只輸出百位以上的數字（忽略整數與十位的數
字），否則只輸出兩數的乘積，以Ajax的post方法完成。

3.在DjangoServer上，請撰寫一個計算計程車車費的頁面，可以輸入里程N公
尺，計算出車費。計程車起跳是70元，之後每300公尺加5元，不滿300公尺
以300公尺計算，以Ajax的get方法完成。

4.在DjangoServer上，請寫個頁面輸入一整數N2<N<100），並找出小於N的所有
質數。所謂質數，就是一個正整數，除了本身和1以外並沒有任何其他因子。例
如2、3、5、7是質數，而4、6、8、9則不是，以Ajax的post方法完成。

5.假設電力公司的電費計算方式分成三類：

（1家庭用電：100度（合）以下，每度2.5元；101~300度，每度3.3元；301度
（含）以上每度42元。

（2）工業用電：基本費為150元，實際用電費每度19元。

（3）營業用電：0~300度，每度6元；301度（含）以上每度6.8元。

在DjangoServer上，設計一頁面輸入用電類別M以及使用度數N，算出應繳電

費，以Ajax的get方法完成。

6.曆法將一年分為十二個月，每四年設置一六年，閱年的二月為29日。閑年定義
為：四年一辣，百年不癌，四百年一辣。試在DjangoServer上，撰寫一程式，
輸入年份Y和月份M（1=M=12）'並輸出該月份的天數D（1=#Ds310，以
Ajax的post方法完成。7.在DjangoServer上，試寫一個複利計算器頁面，假設目標抵達金額為500萬，
而選擇年投資報酬率10%的投資標的，每月固定投資2萬元'，請問何時才能抵
達目標？*以Ajax的post方法完成。

店語
輸出範例：

幾年後就可以抵達目標金額。太點

2聞>&/
資料庫簡】

11-1何謂資料庫？

11-2資料庫系統

11-3資料庫系統三層架構

11-4資料庫系統之網路架構

11-5資料庫管理系統的演進金融市場由於走向全球化、資訊化與商品豐富化需要處理的資料量相當龐大。
再加上金融市場的號爭性日益劇烈更增添資料管理上的重要性，唯有即時適切的管
理、處理與分析這些財金資料，才是致富選險關鍵。

在日常生活中我們常會接觸到資料，例如銀行存提款資料與股價交易資料等均需
要記錄。如果將銀行存款資料有系統的儲存起來，就可以隨時查詢存款餘額以及提款
ML
訊。因此，資料（data）是指最原始的數據；資料經過運算處理（process）得到具有決策
價值的資訊（information），資料與資訊的關係見下圖。

加一人8二加
資料與資訊之關係
1l-1何謂資料庫？

資料庫（database）指存放電子資料的倉庫。人類將以往以紙張記錄資料轉換成電
子媒體，以有系統的方式分門別類儲存在資料庫。例如：每日股價收盤資料匯集到股
PPLE
類到個別存款人帳戶的資料庫等。

回資料庫的特性

EL
幾點：

獨立性：實際儲存資料的資料庫與應用坎體之問是相互獨立的，記許多個應用

軟體存取同一個資料庫；或者系統需求更改時，多數不需要更改資料庫的結構。y一臻性：股票買賣下單交易系統需要用到投資人的基本資料，帳務處理程式
也需要用到投資人基本資料，這兩個應用系統若個別儲放投資人基本資料庫，
一但資料有修改時可能會發生資料不一致現象，因此相關屬性資料只存放一
個資料庫，授權讓不同應用系統存取保持資料一致的正確性，也可避免資料
重覆儲存。

>安全性：若要維持應用系統的正常運作，稚護資料庫的安全性格外重要。資料
庫必需定時的備份，遇到天災、系統故障或遭到破壞時，才能以備份資料復原
正常運作。另外，使用者、應用系統開發者之間需要有不同的權限，並且需與
資料庫管理師不同人以確保資料庫的安全性。

回資料庫的優點
建立資料庫並應用資料庫系統來管理龐大資料時，可以簡單歸納以下優點：
y省去實體的儲存空間，如：紙上資料存放的檔案櫃、資料夾。
y將紙本資料轉成電子媒體後，大大提昇資料處理的速度。
y隨時可以更新資料，不同使用者可以存取最新的資料。
y可以透過網路讓不同使用者在不同空間、相同時間存取資料。
y同一個資料庫，可以針對不同使用者授予不同資料讀取權限，因此使用者看到
是不同的介面（view）。
La經由線上分析處理（OnLineAnalyticalProcess，OLAP）系統或決策支援系統
（DeeisionSupportSystem，DSS）分析統計資料庫的資料成為具決策價值的資訊，
提供決策者參考。
11-2資料庫系統

資料庫意指電子資料的倉庫；資料庫管理系統（DatabaseManagementSystems，
DBMS）則指管理此一電子資料倉庫的應用軟體，兩者常被混消。資料庫系統則探討
兩者之間與週邊軟硬環境以及使用者的互動關係。完整的資料庫系統的組成應包合實體儲存資料的資料庫、使用者、資料、厂體，
軟體。換言之，資料庫是資料儲存的地方；資料庫內的資料管理與操作必須藉由資
PELiLE
ELEm

多轉補

還關
統加

全ji|人

多|1
資料庫系統人機介面

以下將針對資料庫系統之使用者、資料、硬體與軟體做一個簡介。
品使用者

使用者是資料庫要提供服務的對象，依其使用資料庫的方式與目的區分為以下
種角色：

ry終端使用者（endusers）：指一般資料庫使用者，透過應用系統再藉由DBMS提

RE資料庫的資料。w應用程式設計師（applicationprogrammer）：負責撰寫應用系統（application
yysem）的程式設計師藉由呼叫程式介面向資料庫管理系統下達存取資料庫的
指令
w資料庫管理師（dataadministrator）：資料庫管理師的主要任務是管理、監督資
料庫儲存的結構、異質資料庫之間的整合、提昇資料庫整合的效能、資料安全
性、資料備份以及排除使用者使用上的問題。
回資料

資料是資料庫內的主要成份，資料庫系統中的資料可區分為三大類：一是'!運
算資料」（operationaldata）；二是「資料字典」（datadictionary）；三是「異動記錄」
（transactionlog）？

運算資料是資料庫的主體資料，指日常的交易資料，提供使用者存取運算的資
料，資料字典由DBMS所產生的系統目錄（systemeatalog），當使用者新產生一個資料
示時DBMS會自動產生系統目錄記錄資料表名稱、欄位名稱、資料型態；或更改次
料結構時，系統目錄同時也會修改記錄做為日後維護資料庫之用•

系統目錄或資料字典主要功能是描述資料的資料（dataaboutdata）•又稱metadata
或綱要（schema）。

異動記錄是當使用者下達指令，DBMS為維持資料庫的正確性與一致性，會依據
資料庫的資料一有異動時立即產生記錄。
回硬體

資料庫系統的硬體有：硬碟、資料備份用的光碟機、磁虐陣列（diskaray）、電腦
主機以及網路相關設備。
回軟體

_資料庫系統主要相關的軟體包含：資料庫管理了統以及應用系統。使用者透過應用系統或直接連結資料庫時均要藉由DBMS的控管才能存取資料
庫的資料，而應用系統是依據企業或金融機構需求由程式設計師撰寫的應用程式，座
用程式透過程式介面存取資料庫，以金融業為例：網路銀行交易系統、放款業務系
統、匯率交易系統、股票下單交易系統、保單管理系統等。
11-$資料庫系統三層架構

為要了解資料庫管理系統內部運作，可以從資料庫系統架構三個層次：外部層
（externallevel）、概念層（conceptuallevel以及內部層（internalleveD，外部層的使用對
保可能是應用系統或是直接使用者，後者可以使用查詢介面程式直接進行資料查詢。

外部層、概念層以及內部層，通常由資料庫管理師負責設定層次之間的對映關
係，其運作流程見下圖說明如下：

y外部層：使用者看到的資料庫內容。直接使用資料庫的使用者稱為直接使用者

或應用系統所看到資料庫內容是外部層，一般以視野（view）稱之，不同直接使
用者或應用系統有不同的視野即有不同的外部層。YView並不是實際存儲的次
料，而是個虛擬資料表（virtualtable），虛擬資料表的資料內容是由概念層與外
部層的對映（mappings）關係所設定。因為資料表是虛構的，所以外部層的使用
者通常被授權做新增、修改以及刪除的動作，只有查詢的權限。

y概念層：描述內部與外部層之間的橋樑。概念層所看到的資料即實際的資
料表內容。此層的主要工作是設定資料表與資料表之間的整合限制（integrity
constrain0）與關聯，在概念層次不必考慮到實際資料的儲存方式。層概念層的
操作通常是由資料庫管理師負責。

y內部層：描述資料庫實際儲存資料的實體結構。在內部層資料庫管理師要規劃
那些資料需要做索引（index）或資料叢聚（clustering）以提昇存取速度；採用何
種資料實體儲存的技術如雜湊法（hashingmethod），目的也是增加存取效率。

>對映關係：層與層之問有資料字典記錄著相互的對映關係，這項工作是由資料
庫管理師負責維護。當內部層的實體結構改變時，只要更改內部層與概念層的對映關係即可，不需要改變概念綱要。同樣的，當概念層結構改變時，只要更

改概念層與外部層的對映關係，外部網要不需要更動。

直接使用者

G@G一!

層。外了居與概念居一吧國主
|一六2|
|二
應用系統L蕊-天|
資料庫系統三層架構
_11-4資料庫系統之網路架構

LELE
以下幾種架構：

回集中式處理架構

集中式資料庫處理架構見下圖，指所有資料庫存放在單一部大型主機上，負責所
有資料庫運作的工作，包含實體資料儲存、管理、分析與運算等均在同一台電腦。此
種架構適合資料量不大的小型企業，建置成本低廉。

集中式資料庫處理架構是屬於簡單型的網路架構，使用者藉由終端機（temina）
透過網路連線到大型主機，終端機含鍵盤滑鼠，主要功能是接收、顯示、傳送到主機
的資料，本身的沒什麼運算處理功能。

終端機指沒有硬碟的電腦，操作方式與個人電腦（PersonalComputerPC）相同。
缺點同單機式，所有的資源均集中在同一台電腦，當處理量增加時運算效能會降低。大型主機
啟~加加和
3
生二
二TR全說
全前加
N\HIHTIHIHTHHTIHHTHH
吃
集中式資料處理架構圖
回主從式網路架構
主從式（client-server）網路架構見下圖即是應用網路的功能，提昇集中式管理的效
能，以PC取代終端機做為客戶端（Client0。PC具有資料運算、排序或過濾、介面顯
示以及錯誤訊息等處理功能，分攤伺服器端（Server）的工作量。
伺服器依任務分工為資料庫伺服器（databaseserver）、運算伺服器（computing
server）、印表機伺服器（printerserverD、E-mail伺服器（emailserver）等；Client端一般
以遠端程序呼叫（RemoteProcessControlRPC）或（ApplicationProgramInterface，APD）
與伺服器做溝通。
主從式網路架構的優點是使用者增加效能不會有太大影響；即使是企業流程或需
求改變，分工合作可以使整體效能到最佳狀態；所有伺服器同時故障的機率極低，提
昇系統的可使用率（availability）與復原率（recoverability）。運算伺腿器資料庫伺服器印表機伺服器Email伺服器
同|
說加二可客戶敵客戶喘
主從式網路架構

回多層式網路架構

主從式網路架構見下圖是由主從式架構結合WorldWideWeb與瀏覽器為基礎擴
展而來，主要分成幾層：客戶避、Web伺服器端、運算應用伺服器、資料庫伺服器敵
以及其他伺服器。

客戶端需安裝瀏覽器方便與Web伺服器溝通；運算應用伺服器負責在連線忙碌
時合理分配工作負載，有效管理伺服器運算量，提高伺服器運算速度；運算應用伺服
器與資料庫伺服器溝通，擷取資料並運算等；Web伺服器主要功能是負責各網站伺服
器建立連線等；資料庫伺服器同主從式架構一樣是負責各應用系統連結到資料庫的資
料存取以及儲存等工作。使用者瀏覽器web伺服器|運算伺服器。資料庫伺服器

分人@全和|險信

，介，翁!餓

侈但优“歸本

sa和
互動式網路架構

區行動運算處理架構
隨著無線網路（wirelessnetwork）技術的發達，將行動運算（mobilecomputing）應

用在商業行為上即為廣義的行動商務。無線網路技術人來愈成熟，網路節點增加需求

快速，市場對伺服器或網路節點的功能需求也愈來愈強，加上網際網路發展與應用加

重網路頻寬的負擔。
解決之道轉而增強client端行動裝置的運算處理能力，降低對伺服器的依賴也可

減少網路傳輸需求。行動運算處理架構見下圖，簡單分為三個部份：

1.固定主機：固定在某一個通訊站的大型主機。

2.行動裝置：可以是具有無線功能的筆記型電腦、掌上型電腦、手機、個人數位助
理（PersonalDigitalAssistant，PDA）。

3.基地台（wirelessbasestation）：類似擷取點（aceesspoint）具有無線功能，又稱無
線擷取點，它是行動裝置與大型主機的連絡媒介。每一基地台的無線傳輸範圍有
限，超過傳輸範圍時則由另一台基地台接手。無線基地台同時具有以轉接有線舉
無線網路達到網路資源共享的目的。~金融業為提供客戶服務品質，著眼於行動電話的普及，與行動電話業者策略
聯盟，在手機上提供金融加值服務的行動金融如：「行動銀行」與「行動券商」，
其架構示意圖參考如下圖。手機用戶發出短訊，經電信系統轉送至MbIS（Mobile
lnformationServer），MbIS將短訊轉換成銀行或券商適用的訊息格式後轉送至銀行或
券商，客戶或投資人可以隨時隨地從事金融交易，例如：轉帳、餘額查詢、基金下
器、股票委託下單等；銀行或券商主動通知活動訊息、存款到期、餘額不足、逾期
維款等功能。金融服務行動商務化的好處是提昇對客戶的服務品質，也可省去銀行
或券商的人事成本。

回
7

和

|高速|
~1

-人

作加全划各昌昌和有電四

一玫p人

行動運算處理架構同行動資訊伺服器
電信業者MobileInformationSystem銀行
加說
/一謂~.世代
：轉圖人
（網際網中|還
電pM央片語|人
一~
人證券
生Ge回回帝轉•
Ah汪
行動金融示意圖
歡分散式處理架構
分散式資料庫處理架構見下圖與主從式的差別在於資料庫並非集中在單一台資料
庫伺服器，而是分散在不同地點，不同台資料伺服器，藉由網路溝通分享資料，其優
點是提升資料庫系統的運作效能；而缺點是交易大量時增加網路流量負擔。
分散式處理架構分為同質性與異質性：（1）同質性（Homogeneous）分散式處理架
構：將資料庫伺服器分散在同一企業不同部門，因為同一組織文化與營運模式其資料
同質性較高，稱為同質性資料庫；（2）異質性（Heterogeneous）分散式處理架構：適用
於企業內部各組織事體相互獨立、營業項目差異頗大的關係企業或是跨國集團，因為
組織之問資料差異很大，所要整合的資料庫內的資料是異質的，稱之為異質性資料庫。11-5資料庫管理系統的演進

簡介資料庫管理系統的過去、現在與未來的演進，分以下幾個階段說明。
回檔案系統

檔案系統（filesystems）約1950年到1960年被提出，它是人工處理之後第一個電
腦化的資料處理系統。檔案了系統不算是正式的資料庫管理系統，充其量只能算紙上資
料電腦化，資料儲存方式並沒有結構化，其資料是存放在檔案內並非資料庫，檔案實
體是放在磁帶或磁碟，資料存取方式是採循序性（sequentiaD，效率較差。

回階層式資料庫管理系統

階層式資料庫管理系統（HierarchicalDBMS）約在1960年由IBM公司所提出，屬
於樹狀結構型態。每一棵樹就是一個結構，由樹根（roo0）為父資料往下開啟長樹的節
點（node）即子樹（subtree）屬子資料，每一個子樹是記錄的部份欄位，一個子資料即能
有一個父資料，一個父資料可以有多個子資料，因此可以處理一對多的關係。整棵桔
組合起來就是一筆記錄（reeord），即為一筆有順序由樹根到樹葉（末端結點，terminal
nmode）具有階層的樹狀妃錄。

以股票基本資料為例，公司代號與名稱、地址與電話、上市日期與員工數。每一
個股票均有唯一識別的公司代號與公司名稱，如2357華碩、1301台塑-..；華碩的地
址、電話、上市日期是資料額。

彈網路式資料庫管理系統

網路式資料庫管理系統（NetworkDBMS）於1971年被提出，為階層式資料庫管
理采統的擴充，可以處理多對多關係，指一個父資料可以有多個子資料，一個子資料
也可以有多個父資料，而父與子資料之問均有鏈結（links）關係。以股票與投資人買賣關係為例，一種股票可以被多個投資人持有，一個投資人可
以持有多種股票見下圖。
投資人/代號股票代號/名稱投資人/代號

股票與投資人的網路式資料

了股票與投資人的網路式架構

張三買了華碩、台積電與台塑的股票，張三即為投資持有人；李四持有台積電與
台塑的股票；趙二也買進台積電與台塑；，王五則持有華碩、台塑兩檔股票。
彈關聯式資料庫管理系統

關聯式資料庫管理系統（RelationalDBMS）由Codd學者於1970年提出，將所有
記錄集合成一個關聯表（relations）做為一個處理單位，此一點有別於階層式與網路
式資料庫是以「記錄」為處理單位，並且階層式與網路式記錄與記錄之問是以指標
（pointer）做連結彼此間的關係而關聯式則是以能「唯一識別的資料值」（uniqueda
value）做為表與表之問的連結或關聯。知名的關聯式寶料庫管理系統如MySQL，本
書採用MySQL管理股價資料。
加物件式資料庫管理系統

物件式資料庫管理系統（ObjectOrientedDBMS）是由1993年Hurson，pakzad與
Kim三位學者首先提出，因為物件導向程式語言（OOProgrammingLanguage，OOpL）
的興起而受重視。物件導向式資料庫是以「物件」（object）取代記錄做為處理單位，物件與物件之
間的類別或屬性具有繼承（inheritance）關係。物件導向式資料庫相關的技術除物件導
向程式語言外，還有物件導向式系統分析（OOAnalysis，OOA）、物件導向式系統設計
（0OODesign，OOD）等。

物件導向技術結合關聯式資料庫的技術發展出物件關聯式資料庫管理系統（Object
RelationDBMS），以物件導向為發展基礎保留關聯資料庫的優點，除了一般資料以關
聯表方式儲存外，特別適合處理以二進位格式的物件例如：圖形影像檔、音效以及
video等，此類資料存取效能高於關聯式資料庫。

回XML資料庫管理系統

網際網路的盛行已成為人類生活很重要的溝通管道，以XML（CExtensibleMarkup
Language）格式傳遞資料方式已成為業界公認標準。

XML應用在資料庫朝兩個方向發展：（1）原有資料庫管理系統擴充XML文件的
處理功能，例如：MS-SQLserver、Oracle、IBM等均已提供存取XML資料型態功能；
（2）發展原生XML資料庫管理系統（NativeXMLDBMS），由KimbroStaken於2001
年提出：以文件（document）為處理單位，特別適合處理非結構化的資料型態如索引
檔、網頁文件等。若企業的經營型態是資料處理為主，即資料比較結構化，資料型態
同質性很高，適合採用關連式資料庫，只要透過中介軟體（middleware）或DBMS本身
提供的XML存取功能轉換成XML格式即可，建置成本較低；如果資料不具結構化、
較不規則，而且以文件為主的話，建議採用原生XML資料庫管理系統較恰當。

上述幾種資料庫管理系統有些隨著時代的演進而被淘汰（如網路式或階層式），
而檔案系統因為成本低廉、引用簡便仍有小部份市場，目前仍以關聯式資料庫管理系
統為主流，若附有XML格式資料庫功能將是未來的主流。A.R.HursonSimin了H.PakzadJia-bingCheng，"Object-OrientedDatabase
ManagementSystems：EvolutionandPerformanceIssues"”，Computer

Volume26，Issue2（February1993）Pages：48-58，60IEEEComputerSociety
Press

KimbroStaken，"IntroductiontoNativeXMLDatabase"，http：//www.Xxml.com/
pub/a/2001/10/31/nativexmldb.html，XML.com，Oct.，2001.

Co選.F.，"Arelationalmodelofdataforlargeshareddatabanks，
communicationsoftheACM，Vol13，No.6，1970，pp.377-387.CHAPTEFP
Fm人
MySQL安裝與設定
12-1Server端
12-2Server端組態設定
12-3資料庫管理MySQL是一個穩定安全且開放資料庫原始碼的關聯式資料庫管理系統。它是由
MySQLAB公司所開發，可跨平台在Windows、Linux等作業系統運作，支援連結的
程式語言有：Python、Django、C、CHH、Java、PHP等。MySQL提供便利的SQL資
料庫語言查詢介面，支援儲存XML文件格式與圖像檔。MySQL的特性是安裝體積
小、運算速度快、建置成本低廉，屬於客戶端/伺服器端（Client/Server）架構的資料
庫管理系統。

回軟體下載

MySQL是Client/Server架構，在Server端的軟體分為Enterprise與Community
版本，其中Community版本提供免費下載，本節就針對此版本說明其下載與安裝的
流程，接著再針對Client端的下載與安裝進行說明。

】MServer端
Server端下載操作說明如下：

1到此下載網址取得Server端的安裝軟體。https：//dev.mysqlLcom/downloads/
installer/，點選「MySQLCommunityServer5.7.18」以及「SelectPlatform」選
「MicrosoftWindows」。再選「Windows（x86，32-bit及64-bi0，MySQLInstaller
MSI」，點選「GotoDownloadPage>」如下圖。HiRESLE0is
11
to加補間洁汪汪天基補凍尖基神尖寬尖尖汪汪尖若國若芽荐天ee
過剖交交時各ii一
導言上本宮加
ig
MySQLCommunityServer5.7.18
1太
點相本
steam
ie
|
ii
||
MySQLInstaller生加全
頁丟避加
ae一四|
SEE上
到站
gl
393回日
cl和
F和Am日日
和當ta
sem3遇1
513371113歡本症全ii
mt，二
3店安量2
2.點選Windows（x86，32-bi0，MsSIInstall5.7.18，容量405.8SM旁邊的
Download主如下圖人
人
GenerallyAvailable（GA）Releases。DevelopmentReleases
MysQLInstaller5.7.18
selectoperating5ystem：LookingforpreviousGA
|（|））versions？
MicrosoftWindows
Windows（x86，32-bi0Ms11nstaller57.1818.5M|oownload|
LT1.msi）EL
Windows（x86，32-bit），MSInstaller5.7.18405.8M[sm晤]|
LE號MD5：3c4bfbc433c78fc982993d29c73beeb6|Signature為提示和
MySlnsloler是32位元，但會同時安裝32位元與4位元
3.點選「download」後進入下圖，請點選「Nothanks，juststartmydownloadj。
BeginYourDownload
mysdlinstaller-community-5.7.18.1.msi
|LoginNoworSignUpforafreeaccount.
|AnoracleWebAccountprovidesyouwiththefollowingadvantages：
|*FastaccesstoMy5SQLsoftwaredownload5
|。DownloadtechnicalWhitePapersandPresentaticns
。PostmessagesintheMy5QLDiscussionForums
。ReportandtrackbugsintheMysQLbugsystem
。CommentintheEPLi
[1-人
723還
|
|MysQL.comisusingOracle55Oforauthentication.IfyoualreadyhaveanOraclewebaccountclickthe
|Loginlnk.Otherwse，youcansignupforafreeaccountbyclickingthesignUplinkandfollowingthe
fInstructlons
Nothanks，jJuststartmydownload
Server端軟體Downlood
4.依據作業系統選擇要安裝的版本，以Windows為例選擇「Windowsdownloads」，
共細分三個版本分別為：Windowsessential、MSIInstaller與Withoutinstaller。
Essential為基本安裝版本，'，提供多數使用者需要的MSI安裝套件；MsSIInstaller
為完整安裝版本，提供更完整的元件功能以及一套評估測試工具；Without
instalL為手動安裝版本但不包含安裝精靈，使用者需自行手動安裝。本節以MSI
Installer為例進行下載，檔案大小為405.8M，執行mysql-installer-community-
5.7.18.1.msi畫面如下圖。w4L_
福以邊況計說盞處。
ELELEL
發行者：OracleAmerica.Inc，
類型：WindowsInstaller封裝
從：DNUserNUseADownloadxmysqinstaller-c
ELLE
件說回洽池潑記下誠小避評神說謀玫~軍視論電議站光信
電襄呈
K體。有全護欄的周了6
MysQLInstaller-community
條PleasewawhieWindowsconfiguresliyS0Lnstaler-Communiy
|Ds
-
MM，，和
5.執行mysqL-installer-community-5.7.18.1.msi，會出現安裝精靈的歡迎畫面如下，
請按「Next」。
品wsoQunstler：本還
/
PEENLicenseAgreement
eu
ToproceedyoumouaaceepttheowdesofewareUieenseTeme
GNUGENERALPUSUCUCENSE品
2Verien2.June1991回
_SSne
之
23
LTL
En
LEL
loshaeandchangeBycontrasttheGNUGeneralpublcUicense
[aendedtoguaranteeyourfreedomtoshareandchangefree
LoftemakesurethesofwaregsfreeforalisusereThie
enealpubretUeenseapplestomoatoftheFreeSoftware
oundatensseftwareandtoanyctherPregramwhoseauthoricemmitto
LangitComeotherFreesoftwareFoundationsofbvareirceveredby
【heGNuubyGenelPublcticenseinstead）Yeucanapplyto
jaurprs9mms，too
jenwespeakeoffeesofewarewearerefermngtofreedomnetpnce
LurGeneolPublcUcensesaredesidnedtomakesurethatyouhave
04
|加aceeptthencenseterms
|一一一一一一一一一一一一一一
圖DsLe
TTiiiiiiiiiE
•回）

6.選擇要安裝的方式有：開發者安裝（DeveloperDefaul0、伺服器商（Serveronly）、
客戶端（Clientonly）、完全安裝（Full）、自訂安裝（Custom）如下圖，使用者可選擇
人
完全安裝後點選「NextJ。

二辣
中MysQLInstaller一約
以
MySQL.InstallerChoosingaSetupType
Adding，Community
PleaseselecttheSetup，TypeELYourusecase
0DeveloperDefault5etupType8，
[nstallsacftheproductsavailableinthiscatalog
dedf
ChoosingaSetupType了人includingMy5QLServerMySQLshellMy5QL
和JRouter'MySQLWorkbench，My5QLConnectors，
documentation，samplesandexamplesand
0serveroniy|muchmore
InstallsonlytheMySQLServer了
produdt，
0Clientonly
InstallsoniytheMySQLClient
LE
@Full
InstallsallincludedMiysQL
produdtsandfeatures，
0Custom一
Manuallyselecttheproductsthat
shouldbeinstalledonthe
system，【7.這邊會顯示要下載的軟體中，所必要的程式及狀態，點選「Execute」下載缺少的
程式。
由oo6
人
MySQL2InstallerCheckRequirements
AddingCOmmunity
Thefollowingproductshavefaifingrequirements.Theinstallerwillattempttoresobvesome
。ofthisautomatically.Requirementsmarkedasmanualcannotberesovedautomatically
Clickonthoseitemstotyandresolvethemmanually，
：ForProdutRequirement還
OMysQLworkbench6.37MicrosoftVisualC++2013Runtme，
CheckRequrementsOMysQLforVisualstudio1.2.6。。Visualstudioversion2010.2012.20..。。Manual
全CMysQLutmties1.64MicrosoftVisualCv+2013Runtme--
|全扣本本MS
3本RequirementDetails
人Thisisamanualrequirement，Youcanattempttoresovetherequirementusingthe
informationprovided.Whendone，youcanpresstheCheckbuttontoseeiftherequirment
hasbeenmete
2Requirement：Python3.4isnotinstalled|
9一
DownloadURLhttp：//www.python.org/download/蕊ms
|TT
Li
組全
品MicrosoftVisualC++2013
|Redistributable（x64）-12.0.30501
MICROSOFTSOFIWAREIICEHMSETERMS加
|MICROSOFTVISUALC++REDISTRIBUTABLEFORVISUALSTUDIO
|2013
||rheselicensetermsareanagreementbetweenMicrosoftCorporation（or
Jhacarnnwhereunirlua_nnenfisaffilinfasYanrlwn_plaaseraarfhem
加Pagetothelicensetermsandconditand
|FEELTEBBL人人
用全
8.缺少的程式安裝完並確認後，若前方的圓圈被打勾，代表已經符合安裝條件若
2認完4著點選「3
仍有缺少的程式未安裝到，則必須要另外下載。確認完後，接著點選'Next」進
>7|屆。
11而用
國EL4人國國
2/
MySQLxInstallerCheckRequirements
Adding，Community，
Thefollowingproductshavefailingrequirements.Theinstallerwillattempttoresolvesome
ofthisautomatically，Requirementsmarkedasmanualcannotberesolvedautomatically-
Clickonthoseitemstotryandresolvethemmanually，
ForProductRequirement人Status
|字MySQLWorkbench6.3.7MicrosoftVisualC++2013Runtime，
|CheckRequirements0MysQLforVisualStudio1.2.6。。VisualStudioversion2010.2012，20..-Manual
|人MysQLUtilties1.6.4MicrosoftVisualC++2013Runtimez
0connector/python（3.4）2.1.3python3.4isnotinstalledManual
和讓
RequirementDetail
Theinstalleristryingtoautomaticalyresolvethisrequirement.Thereisnothingyouneed
todo
RequirementMicrosoftVisualC++2013Runtime64bitsisnotinstalled
Status：Errorduringdownloadencountered：
AnexceptionoccurredduringaWebclientrequest，
一>SystemIO.IOException：Theprocesscannotaccessthefile
'"CNUsersNuserAppData\LocaNTempwcredist_x64，.exe'becauseitisbeing
|3
|
|1汪aae兩aa本有yy人本下3o
9.接下來會開始安裝各個MySQL的系統，確認無誤後"點選「Execute」開始安裝
可wo1
和
ZEELEInstallation
iTIb
PressBecutetoupgradethefollowingproducts，
Produ和Progre5EL人
加2
rsalton國PEEL
畜gagEL
之ggLEoEL
1加避目|
人相2二旬
加wsesnio9FEEL
人國MySQLRouter213FEEL
加SAS88U》PCEL
還人國Connector/C++1158ReadytoInstall|
還和
~3Readytolnstall
全人loanzrgaa5~
還EL，
3thefollowingpackages
有“還共人加
中
ELProductConfiguration
EL
ELLE
|Youcancanced站anypointiyouwishtoleavethiswizardwithoutconfiguringathe
products，
Produdtu則
孖MsQUsener5718PO
和條ReadytoConfgure
SamplesandExamples5.7.18ReadytoConfigure
1轉端組態設定
12-2Server珊組旦設生
二和3里選「0
1.進入組態設定後見下圖，選擇「StandMySQLServer」'點選Next」
加說一心硬放畫
|、世4ySQLInstall了
1
|MySQLInstallerTypeandNetworking
bv人
|人ee
一ChoosethisoptionifyouwanttoruntheMy5QLServeretherstandalonewith
|theopportunitytolaterconfigureclassicMySQLReplicatione
人Usingthisoptionyoucanmanuallyconfigureyourreplicationsetupandprovide|
yourownhighavailabiltysolutionifrequired.|
GoInnoDBClusterSandboxTestSetup（fortestingonpy）|
TheInnoDBclustertechnologyprovidesanout-of-the-bcxHA（highavailability）
selutionforMySQLusingGroupReplicatioentechnelogy-
|ThisoptionallowsyoutotestanInnoDBclustersetuponyourlocalmachine
usingseveralMySQLServersandboxinstances，Readmoreaboutthishere，
Tosetupareal-worldproductionJnnoDBclusterpleasechoosethestandard
MysQLServerconfigurationinsteadonaldesiredhostsandusetheMySQLshell|
afterwardstocreateorexpandtheInnoDBclustersetup.一
肌
目覓四二/會ˊ：
；1
ga一ui一圖圖，|
51|
llI）_
Le[ss
上
eeTNTNNNHNH|li了
|
2.設定伺服器類型見下圖，本範例依據用途選擇「ServerMachine」伺服器主機，|
傘料茵勢宰次料
MySQLServer為Web資料庫，接著設定資料庫的網路選項包合TCP/Ip網路連接|
埠（port0，再點選「NextJ。
了EN上加
ELTypeandNetworking
MysQuserverp，/18severconfigurationType
ChoosethecorectservercenfigurationtypeforthisMy5QLServerinstallation，Thissettingwil
|finghewmuchsystemresourcesareassignedtotheMySQLSeerinstance
iiCopre了EE國加
Conneetviy
Usgthefollowingcentrolstoselecthowyouwouldliketoconnecttothisserver
回TcppPotNumber2306
加openFrewalpotforneworkaccess
日NamedpipePipeNameIMYsSQL
回sgMemoyName[MysQt
AdvancedConfiguration
革加加加dionalconfigurationpagewhereyoucansetadvanced
7eptiensforthisserzerinstance，
8交日showAdvancedoptions
贍密和勺帳號，e
3.設定使用者的root密碼及一般使用者的帳號，見下圖
7生
[JMySQLInstalle還人生
|
ELAccountsandRoles
CCRootAccountPassword
|Enterthepas5wordfortherootaccount，Pleaseremembertostorethispasswordinasecure
Place
MySQURootpasswordee
Fi1
二放生生PasswordStrengthiWeak
|My5QLUserAccounfs
章createKysQtuseraccountsforyourusersandapplications.Assignaroletotheuserthat
entsoasetofprvdeges
My5QLUsemameHostUserRole[au
[eatusr
Pa一
=
|11和生放人人
4.設定作業系統服務見下圖，「StarttheMySQLServeratSystemStartup」這個勾選
劑主的每？
會讓電腦每次開機時，自動開啟MySQL服務。
品3全全悶廬廬議加各二二Ha
2
ELWindowsService
|E國configureMySQLsewerasaWindowsService
WindowsServiceDetaik
PleasespecifyaWindowsLELE
nameisrequiredforeachinstance
WindowsseviceNameMy5QU57
回sattheMysQLserweratsystemStartup
RunWindowsServicess，
和TheMysQLsererneedstorununderagvenuseraccount.Basedcnthesecurity
ELEPpickonecftheoptionsbelow，
@sandardSystemAccount
Recemmendedformestscenariog：
@cusomuser
Austin9useraccountcanbeselectedforadvancedscenares，
起|3呢
5.設定附加元件及擴充套件，直接點選「Nextj。
〔生用
MySQLInstallerPluginsandExtensions
eeMysSQLasaDocumentstore
Usethefelowingcentrolstoselecthowyouwouldliketoconnecttothisserver，
口mmbkxpoteel/wsQtarapooumentstore|
PotNumber9
和口openFrewalpotfornetworkaccess
|SaringwithMysQLserer57，MysQLsupporsdocumentstoredevelopmentln
ordertoprovideacompletedccumentstore/NosQUexperiencg條en
communicationsprotocolcaledtheXxProtocol.Theexpandedcapabilig交he
同ProtocolenableustoprovidemodermdeveloperAPlswthfeatura2001
anchrenousGans.pipelining，andmore.Inadqiiontoimplementinddesumen
coledionethenewXDevAPlalsosupportsfeatlonalandcombined3GGN
sorerelationalGapabitties.Nowdevelopers，designersandDBAYan9
My5QLdatabasesthatimplementdocumentstore，relationalorhybiir
|RE
|ClickheretoviewMySQLasaDoctereonlinedocumentation中ni[全MSN對
6.設定完後，按下「Finish」完成MySQLServer的設定。
EE加1
te[選罰
gEEEEApplyConfiguration
LvTheconfigurationoperationhasstopped.
|cnfauratonstepsjlteg]
品stoppingServer[fnecessay]
LE|
9Updatingfirewall
@@AdustingWindowsserice[fnecessay]
O@Initialzin9Databaselfnecessary]
品samingsewver|
3
GO
和名creatinguseraccounts|
人@@updatingstatMenuLink
和G@updatingFrewalforMySQLDocumentDataFeatureSt
圖圖一||
回MysQLinstaler_人章蟬
說
LEProductConfiguration
則AddingCommunity|
Wellnowwalkthroughaconfigurationwizardforeachofthefollowingproductse|
YoucancancelatanyPointifyouwishtoleavethiswizardwithoutconfiguringathe
products，
Podud同ELStatus還
Mys5QLserver57.18Conmgurationcomplete.和
ProductConfgurationMsQLRouter2.13ReadytoConfgure
samplesandExamples57.18ReadytoConfgure
|
|
中生時：
則一到人3了生全他
人#e列）
7.在此設定路由器配置，預設port為3310，如下圖。按下「Finish」完成設定。
1人4出有
回MsQunstler本
以
LEEMySQLRouterConfiguration
MySQLRouter2.13曲confiaureMySQLRouterforInnoDBcluster|
ThiswizardcanbootstraptheMySQLRoutertoroutetrafficbetvweenMySQLapplicationsand|
kbSQLInnoDBquiter，appleationithatconnedttotherouterwilbeautomatieatyqirededt9。邊
5|
PS
EEGEMysQLRouter
formontonngusethecurentRead/rteinstanceofthecluster
Hostname：[台Gihott
Port|3310
wweewwuw區
Password：|國生
|pl
MySQLRouterrequiresspecficationofabaseport[betweenS0and65532）.Thisportisusedfor
|!dassicreadwriteconnedions，Theotherportsmustcomesequentialyafterthebaseport.Hany
portbelowiindieated5bringunavailable，pleasechangethebaseport，
一LTLE
ReadAWrite：5445
Reaaomy了|
MySQLXprotocoleonnedionstonnopBquster
Readwrte了8
Readony6439||
日：（本
ELProductConfiguration
和AddingCommunity
Wellnowwalk.throughaconfigurationwizardforeachofthefollowingproducts
Youcancancelatanypointifyouwishtoleavethiswizardwithoutconfiguringathe|
products，
|
euStatus
MySQLsener57.18
Wurationcomplete-
ProductConfiguration
和5同ELIntialConfiguration
5amplesandExamples57.18ReadytoConfigure
上ML
ll8.輸入帳密測試資料庫連線是否正常，按下「Cheek」鍵檢查，出現Connection
人生
sueeessful。再點選Next」完成設定。
回能“世上al本
一：/
|ELConnectToserver
PPL
上「
Herearethecompatibleserersinstalled，fmorethanonepleaseselectone，|
4EL和Atedurestatus
MysQLserer57.18如354Running還國
上
Nowgiveusthecredentialsweshoulduse（needstohaverootprivileges）.Clickcheckto
ELL|
UserrootCredentialsprovidedinServerconfiguration
同SPRee
和[97_S$0g353EGAE
而康生有
ELApplyConfiguration
FEELPress[Beecutejtoappythechanges
Configuratien一|
|Ochecgingifthereareanyfeaturesinstalledthatneedconfiguratione上
OO
AppbyConfigurationOGatingConnectieninformation（Provideredentialsiisneeded）-
ORunning5crpt.
Osoppingsewer
|
|和『一
回sqQumstaler電ts
1
ELApplyConfiguration
SamplesandExamplesTheconfigurationoperationhasstopped.
[Confguratenstepsjlte9|]
LiLE|
只surmingserwer
AppiyConfiguration@@GettingConnectioninformation（providecredentials放sneeded），
RLEEL
eeServer，；
日<B5S5可相
說
MySQLzInstallerProductConfiguration
AddingCommunity
Wellnowwalkthroughaconfigurationwizardforeachofthe.followingproducts，
Youcancancelatanypoint計youwishtoleavethiswizardwithoutconfiguringathe
Products，
加
MsQLsener5718Comfguratoncompikte.|
ProductConfigurationMySQLRouter213IntialConfiguration
5amplesandBamples57.18Confgurationcomplete，
|
|
1」9.安裝成功的畫面如下圖，按下「Finish」鍵即可瑪動MySQLServer。
回二人拉光#LcJi楷六
|還
ELInstallationComplete
了AddingCOmmunity
Theinstallationprocedurehasbeencompleted|
|
回sartMySQLWorkbenchafterSetup
bLE2RP|
IN
|=
1
12-3$資料庫管理
MySQLWorkbench為數據庫管理員、程序開發者和系統規劃師提供可視化設計、
模型建立、以及數據庫管理功能。它包含了用於創建複雜的數據建模ER模型，正向
和逆向數據庫工程，也可以用於執行通常需要花費大量時間和難以變更與管理的文檔
任務。
開啟剛剛下載的MySQLWorkbench'如下圖。國wsQLwobench人長和相、惱生二和PH
人析潑
21各銜衝讓生條各作說朮必介全東生
說
隊“WelcometoMySQLWorkbench
MySQLWorkbenchistheofficialgraphicaluserinterface（GUDtoolforMysSQLHallowsyoutodesign，
MMCreateandbrowseyourdatabaseschemas，workwithdatabaseobjectsandinsertdataaswellas
designandrunSQLqueriestoworkwithstoreddata.Youcanalsomigrateschemasanddatafromother
databasevendorstoyourMySQLdatabase.
BrowseDocumentation>ReadtheBlog>DiscussontheForums>
MysQLConnections@人o
LocalinstanceMySQL57
可
12-3-1”連線視窗
步驅答先點擊MySQLConnections旁的加號來新建連線。
“BrowseDocumenta
MysQLComnections（@）s
LocalinstanceMySQL57
2root
守localhost3306
新建連線
縣陣脫先輸入資料庫的帳號密碼，帳號默認為root，填好密碼後，可以按下Test
霓次料庫是否；，同3市壹二
ConnectionLE四32959335還
Ni
89835556ie一一一一一Typeanamefortheconpectbion站
Method：andard（TCPPIP）和還點
1
Mostname：4901PorE。3306.NameorPaddressoftheserverhost-and
TO還port三
Usemame：BT時計讓店Nameoftheusertoconpectwith上
5還ee
和
DefatSchema：本Thesdhematouseasdefaultsdhema，Leave
ri
連線設定
則
39本一建立完成後，會出現一個長方形的框框，雙擊它，出現如下圖頁面。
1：人
誰59x5x字去全和同5三上湊划上
ggpg如人riptng了
敘外但外名多所因墈口區
atP5QUAddtons
and“|已gl到食品|玉名吧ae1Wuoe和點
9二
2GEqethelpforthecurrentcaretpositon
enapmaeoerortotoggleautomatiehelp
人SEA
egpor
二blmpotaetore
INSTANCE辣
sue/shudown
Aero
了ooeonrne
還
「PERFORMANCE
esygeoPL
73237yort!+||
1站
85「
Aero一
人|
wggw詞
自拖_
AaWorkbench操作介面iv三4
12-3-2使用MySQLWorkbench建立資料庫以及新的表，為|
表添加數遞|
步暖和點擊圖中的紅圈裡的按鈕，新建一個Schema（資料庫），修改一下資料庫的
名稱，接著點擊Apply，再點Apply如下。|
人117
嗡5x了其全入
則世人【
歸抱多（多留留包包回和e忠困戰
EL3398？xSER
了大章洗：、5一0；
人和全3守宮toobar
0SEE1
6DataExport一一一一一一一一一一一一一瑞末一一一
屯Datalmport/Restore|
INSTANCEDP了
sartup/shutdown上
人severuo9f
NoptionsFile|
PERFORMANCE5hema||
13solu，
人PerrormanceschemasetupL5|
scEMAsweSa各
9Haterobyects和2Message人國圖國加六Dueon/feeh
Y二|
人5還
全world
出生
|
ObjedInfo上三|AapysQuscripttoDatabase三著二和
|RcvicwSQUsiptReviewtheSQLScripttobeAppliedontheDatabase
OneDotlililjLiilllllilk
「六他DefauktLodeType：Defautt回
「no
-
一|
人
本
站
人
|*
0=
MM-
人
：上
人TR_TSSLTRR」L
2吾鶴）成功建立了第一個資料庫，如下圖。
ApplySQLScripttoDatabaseW人和圖
人AppkvingSQLsoipttothedatabase
人下
Thefolowingtaskswanowbeexecuted，Pleasemonitortheexecubion
PressL
字aa
「No
|
|=六全接著新增資料表，在左下角的SCHEMAS下找到剛剛創建的資料庫，在
內層的Tables下點選右鍵Createtable創建資料表，也可點擊上方的圖示創
建，輸入完資料表名稱後，按下右上角的箭頭號誌，可以設定資料表的欄位。
[ee
人Ex歡險-、.的史和大濕w二.地
EnQoerEEgSServerToo大y
選司9@彈避軍品品國立GIEH
二人到PiTTLELEx8SEE
各交IDfi3（人|hl||直本
li_EInLE
加sturandsystemvanabies當ortotodgkeautoneatkchelp-|
gg還
8加
DsTANCE生和同~
egggS5ce[un[衝枯
人seruoo4汪人說和人中二li
riLL讓
生nFe5|
的pemomaneesmemasetup|口&einwemet口Geneaid
ss”||uu，gm
和生34mo加
一CaTebk2_
ii_TV條
一we
Ti、
SREo還加加|
步驟翻）在此輸入要設定的欄位名稱與欄位屬性，並且在後方選擇它的欄位設定，坦
入完後，按下Apply完成設定。wobeodh0
2和人5
PSSIENS光合說
me人ee人人50OPPnE

人PETaEL
時ggf熙SILE加說議論
1加To
和一
SEEtemvasg加品g叻中忠趾器品由
eggS3口口m口mm品口由
eg•點17_
0gg|||
eg記生生計量
35gpLgg|
Ng83已sm噴由
PERFORMANCE回pemwey加Not品Fi由
epyEa下mm口In同
2
3835四533器8|
站3用站光和全|
6pt|
同
131BL3
欄位設定的功能選項說明如下：
>PK：primarykey（columnispartofapk）主鍵
>NN：notnull（columnisnullable）是否為空
>UQ：unique（columnispartofauniqueKey）不能重複
>AI：autoincrement（thecolumnisautoincrementedwhenrowsareinserted）
自動增加
>BIN：binary（ifdtisabloborsimilarthisindicatesthatisbinarydata，rather
thantext）存放二進位數據的列
>UN：unsigned（forintegertypes，seedocs：「10.2.NumericTypes」）整數型數據
>ZF：zerofill（ratheradisplayrelatedflag，seedocs：「10.2.NumericTypes」）
填充0位（例如指定3位小數'，整數18就會變成18.000）]
yG：generatedcolumn這一列由其他列計算而得「人Ep
吉他
|oneDpt一一一一一
Pi4ggDefaukt
由1CREATETABLE“mydatabase，student
光合
1
|（人
=
|
||
2
人117
林的信全4
|公LEE
0UT
縣環窟）設定完成的畫面如下，代表已成功建立了一筆資料表。此時在Tables下也多
了一筆student的資料表。
AppysQLsoipttoDatabase
有1
人生
，1
PS
ptwasucressft#yappledtohedatabase
|
|
了
|
|
||mm3也勳接下來向建好的student表中添加數據，在student表按下右鍵，點選第一
個SelectRows一Limit1000後，會出現如下圖，此時可以自由地添加數據進
此資料表中，因為剛剛我們有把student_id的Al設定勾選，所以此數據可
以不用填寫，會自動從1開始增加，接著再按下Apply添加數據。
國wysQLworbench二主人人同
11net和銜放革廁人銜二，
加ggserverToogScriptngHeb
生品人刁佃點加加：回襯踢回口
Navigztor性PPRE
BLs【口四交手9下條回生（bg，
eg3EE人人和
生cientconnedionsAutomaticcontexthe和品disabled.Usethetoolbar
所UserrandPitegestomanuaiygethelpforthecurrentcaretposition
還ortotoggleautoematchelp-
噴DataEport1】lL】LL【】L】LL||
gg
人
mg“PE：
835See和一!品吧區名le細科畫
NgBR8
PERrORMANCE回ge人中
eg品
的PemormanceReports可BB目全3
八PerformanceschemaSetupBa【
人；
png<
是mdatabasestudentlx和weRE回四
（吧已表
和0VSectRows-Limit1000，_和太
ges&yRoLE和11和中人同|gl||千電52吉
革ee|CopypclpbosdAppydangestoaudertanoesappled
Y|LTISELECT“FROMmydatabases.0row6）retumed0015sec/0000sec
和+worldTabDaLmportWE和
和SetbSQLEBipr
|Table：student|CreagTeble
RESessionSEES：》
二人|ApplysQLsoipttoDatsbase和
字字ReviewtheSQLSoipttobeAppedontheDatabase
「生二地TITLEVALUI
TEsudent_names，student_ages）VALUT
8INSERTINTOmydatabase~studentstudent_name“student_age'）YALUI
|
|
||
|：
和
|和
間jj，。
一和
人
人
加店一點wa
步馭勳出現如下圖，代表已成功添進數據進此資料表內蝦
APPlySQLScripttoDatabase次四必謂轉
和ApphyvingSQLsipttothedatabase
1
|Fi
|gg
有
|
|
|
||
[aeFRLTOLTL沽一如果想要更改數據的話，可以直接更改表內的值再按下Apply如上述操作，
但如果想要刪除一筆資料的話，按下Edit旁的減號圖示可自動刪除一行。
入一一jj111，e和有條
err777347me卻說3
6|。gL
TiLE
人EE
olEE坊站店過ee
8
要還人
人III
一
二人
12-3.-3主功能視窗介紹
成功登入並連線到MySQL伺服器後的資料庫管理主功能視窗見下圖，左側的功
能還項說明如下：
和伺服器狀態（ServerStatus）：顯示MySQL伺服器連結後的資訊。
上稅所端連線（ClientConnections）：可以查看MySQL目前的連線。
用戶與權限（UsersandPrivileges）：管理伺服器現有的使用者及各自的權限。
狀態與伺服器變數（StatusandSystemVariables）：顯示所有的伺服器變數
和”輸出數據（DataExpor：可以輸出整個資料庫、一個或多個資料表，也可以把
搜尋的結果輸出成CSV、XML、HTML、JSON、Excel檔等等。
和”輸入數據/數據復原（Data_Impor/Restore）：可以輸入整個資料庫、一個或多個
對或是資料表內的數據。還和
和全戰8
和e人人所歸人回Ge
2一
章
三e獸軒肝時
和17人
和的國圖第cm
eg生
和1
1：還還加加
13S5ENFe97.096
0國|
>31151567535$3.e9PPe50.096
和則人
了1說說人
io遇：|加轉間回轉加
崗II1本本4
時ee}
全如TR
區主人Pa
1
人
ii2和
ce
7|
伺服器狀態[serverSfgfus）
音色點選ClientConnections顯示的連線狀態，它會列出所有的連線、它們所連
接的資料庫以及使用者的相關訊息、執行緒編號、正在使用的連線等等。
全8EL
nace
IIIyyS
也也吧外外全色白還6人em
1is
和，
1如PS
和|
iiii字
和人|
as
|1
TTL88ENRE人wwGEZP多人ww
和man49et2os人選
生0
v333婦絢沒導Psoa本
人
和
人
2
SEE
人
二
"加回
各本1有時
人
HE有CSIEEL
各和人1GE
IIILM
2眠倫點選UsersandPrivileges所顯示的各個不同的使用者資訊與各自的權限。
（1Login：管理員可以重新設定登入名稱與密碼，也可以創建新的帳號，設
定它們的密碼、驗證類型。
人efY同加圖且
（Ex
六7
eeCue%銜
ee
27
和國ST1
By35S一還還還辣還還還
人ee
站
一加加
四LEEL加各各
用戶與權限（UsersqndPrivilege3）
（2）AecountLimits：這邊可以設定限制：
y帳戶每小時允許發出的查詢次數
>帳戶每小時允許發出的修改次數
y帳戶每小時允許連接到伺服器的次數
>一個帳戶同時連接到伺服器的次數1CCI
111有
人
EC。uuBeetEFE
ee
se
全
ee一
有
和|
“說
TE
設定帳戶的限制
（3）AdministrativeRoles：這裡可以設定不同的權限給各個帳戶。假如在創建
新用戶時，'，可能只万許該用戶擁有少量權限。例如限制該用戶只能執行
SELECT（搜尋），INSERT（插入），UPDATE（更改）等功能，而另外一個用
戶除了搜尋、插入、更改外，還可以執行DELETE（刪除）的功能。而DBA
則為最高權限，可以執行所有的事情。
人Pig
和三人
oo和encr
ii
li潑HI
表號Riii二
生還和ii|
3三三
1全到
51
和生
人|
au，|||ga
js人
人ELRLRE加由
設定帳戶的權限LEE
庫，可以授權select、insert、delete等權限，最後按下「ApplyJ。
和說[一]名3
攻SIS誤全
喇呈9人EMeeEf@加選單
畫-生aeandPrivileges
eee07111
全msCO
eg538說ee
Peggyg33
25
opeonL
ee
eeaa
It人
才和es
空veJetee由
和由|
生
人jqQOll生
_ALLe「53_
設定資料庫存取綱要特權
由國人@點選StatusandSystemVariables顯示所有伺服器變數的列表，可分為狀態
變數與系統變數兩種。加RE06生
全xx
PP
包所9心包包包選四6em
三一一一一
名
Mg33733HIL
2111pill||i6何一一
ww8人ii
10人；1
加：
處11
2和-和
本em一ELe8就_
和Gi375=te
li7二as
_IN一
01六
人四有ees|
31人；1
RSs33egm了
31133566人11
和人1
讓13118上及
人人人全
2_人一人
Ta和1
11
7人83
，同入
"和和84
ee人Ti44
1128
|ae同已
有加
狀態變數
加oou澀7汕林其sil晤紀
說說導弦共和當補購說福
08
已包八白包所所還enE
上iiON
和955
mciF
0TT“1
1有三三
epDAHETE
和4「Ni-Ti二
ioll1
和xiY1
egsyk3SA38whater
85RE5eg條
1||1
和人osAS
4ERSEEge1
三AI人ee
0ii生ee
3283BaRE0人
人9335339na
REga1TA
ss>SERSEEePS
PP1地1
3iiii
1人12一
w人EN33aeled
5[mlwhetertocommtmss說
介5511人SEE
2人1人ee
生AsPo和11
7和ii
和
"31ii1
41TTee
號吧|[0L則上
回加和11；
ii【0和和
謹
系統變數歲盒點選DataExport顯示的介面，可以在此輸出特定的資料與路徑。選好
要輸出的資料庫後，再選擇路徑與是否要含有資料夾後，點選右下角的
rExport」開始匯出。

0人Na
了呈讓

所euN多但加em
加

和FUL

上|

1還

人

【|Li

|時地TEyiIP，_25

；15

【有生eemg33一

|站品

|1|

TT

|此

匯出介面

人3全此生說和轉41

|同人汪人對于

說LeoeentenL

|人KgNL

|ES一一

||

inPi還昌生

eeif|

80723333EN

）9733535ii

1

了二自
全we區
|1
r-|
Us
ee
成功匯出資料還首先我們可以找到在路徑下新生成的SQL檔，打開後如下圖，我們可以看到剛
剛選定的資料庫內的所有SQL語法，包括新增資料表、欄位名稱、欄位屬性、還有
資料表內的數據，全部存放在這個SQL檔裡。

晨cuserxuseApocumentssdumpsxDump20170510-2sql。-sublimeText（UNREGISTERED）本商讓
一LELCELE
s名和、
Li下
同
、TE和人和人時人
人人
了人和人LA上到80
LTRAR
EL人、
Castudentid）

ELEEELCa

RELU
三人仙人呈MT

紀ai
百une1s，Column31RE
成功匯出的SoL檔3示的畫58則
眠伍點選DataImportRestore顯示的介面。點選紅色圈圈來選擇要匯入的檔案。
「AU1人
ss人
本1
所吃儿公所名所白加6

ti還
MANAGEMENT5
ee晶
liDabaImport
eg305
4
eg是呈
生人memoeporaraer]品
11
MEegpi|）_6
331
PERFORMAWCE
ep|DefautschemaobelmeortedTo
1一131
1一
feeseectDatabaseObjectstomport（onhyavalableforProjectFoder9
li4|
一FE而一
和自sbudent一
旬|
目生和ee
eudet，lyLTEL
人SET四了
Pei一二二一一一一二一一一一一一一一
匯入介面
-LL1
tsIs
GGE有EP全』donpeis
同，：人
主革的最受多尼、回避讓同大小
ee而全上放放2
|加生點ii
八人中
PT還
全Apps
品gg
eg
還30
回"
中提用各給
PP
[生
人加所TE還還
ee
ll首先我們先選取中間所要匯入的資料庫，接著把資料庫內的student資料表先刪
除。在student資料表點擊右鍵，選擇「DropTable」刪除資料表，再匯入剛剛的SQL
檔來測試是否可以匯入，接著按下右下角的“StartImport」。
國8334說點
人1
生PETHe
也也吧他包包包包加各e昌區
Navigator上LTLLE
EL：
人CPL
cg15ll
和人Teotoptons1
計DatalmportRestore0mportfromDumpProjectFedersersYserWpoumentsyeumps和|asss
本82P62RCSE
mg0
segLino本59表|
No29和有
PtRTFogMANct
生DashboardDefautschematobeImportedTo
ariT
和的peromaneeschemasetupDefautTarget5cdhema：New3
35
9ec還加加重seectDatabaseObjectboImport（onyavalableforProjectFokders）
字暢mdatabasegg
二四F
和
goThlnpectr
PESERVM4
人和FI
全wordTabgDatsLmportNgzs村
SendoSQLEd》
InformationCagTaby
sbArCmagTabeLuke.》|
一rTatDumpStuctureandDat4本了有2一
加ArTaby『一BL
的的人77yVEl|
ELL：：生9
刪除資料表與選取要匯入的資料庫1
PREE1加hi31
所所抱外劉包包三人；e曲區
人|生sw
1加|IT
三字點NNNN2
yi誤用
表0
31
dl
1
303：
一
點；
人
開圖1
成功匯入資料
此時重啟連線，可以看到student資料表已成功匯入進資料庫中。
12-3-4副功能視窗介紹
左側的功能選項說明如下：
y伺服器重啟（Startup/Shutdowm）：可以停止或啟動MySQL伺服器。
y伺服器日誌（ServerLogs）：檢視伺服器錯誤訊息。
y進階選項（OptionsFile）：進階控制。
$陽字點選Startup/Shutdown顯示的介面，使用者可以中斷伺服器運作檢查伺服
器狀態，也可以選擇讓伺服器進入離線模式。utre箇ae人
說【'41
ri
和ee所所四ftGT
71
3四213
1
33iiiREL73L
1ag07145335LTKSENSMS3R3SLYRU
1
He
全1
0
和
0
扣
和
3
_TE店
伺服器重啟（Sfgrfup/Shuldown）
ya才半點對洲MA若
人多第和說
eeF
還品@.da戰gg選er
1還一一一
和四
1
ii
ii
SANee
SAee
weIII站
-
的的
eeN
li
2
葛全字
5
1
人
es37353
和；
下
_號se起PE_TE
1
中斷伺服器vr加相大廈大基訂林雁其須主
還讓ITiiLe下生
已筷9心白所白白罷和eoTE
mg|
二
ii
alli_Jjl
3ITLi唔可
和于電計生
egaa
網；
_一號sms下PHTEEL
操作伺服器進入離線狀態
縣理优）點選ServerLogs顯示的介面，使用者可以檢視伺服器錯誤訊息與慢查詢日
誌。慢查詢日誌能記錄執行時間超過了特定時長的查詢。
AT宮賓滲江人
他1條導各
條條全14Ge
中人|
由敬結語ad扣還
|二
ii_wi
in如
1ll
Pa人|
|：mi
如ll
1
店肝和
檢視伺服器錯誤訊息和ec
避da8下
化PESMHG上
站點全|
和oo
oa多計生
hg23G338RE
如FS一一一|
1Si3231
人ee下
RE
PE
eg
13
Ng|
SEE
egbEe
人2353|
的peferraneesemas5et|
araetre
站
G回ostecaon：CurosramoatauaysQuVysoQuservers6VataVYLP-Us-aomn2LT|!
233
和
25可一一一
慢查詢日誌紀錄
步馬究）點選OptionsFile顯示的介面，使用者可以在此做進一步的系統操作。
mg|讓
exaa
ssUTPIY
所和eEEBEEHSem
點站111
ol_RE387CCE
有
Pt1
EPELPRE
和aa點ee上
N3333合作人RE|
SEAyyED
ii8ii近|
人ee|
W|L人1ii|
||
aiSIsaae|
由名2
2ee
ro
各本
HE||
ee下LT
和
進階系統操作人回
12-3-5安裝問題
|以眉芥版的MySQLServer，若要更新，可按照以下步驟操作：
還Fi
到|全生3
要先到「控制台」下的「程式和功能點思MySQL相關已安裝程式，按右
鍵選「解除安裝」。
上繹份則除資料夾
到C槽，找到已安裝MySQL的資料夾，按右鍵選「刪除o
堪4
ML
-
；建議重新開機後再安裝新版本。
加全古語克還
|和ll
VS辣還還凍症划陸EE還宮
起全生理v沁有畫加人到表相怖v鞭用對例>。廁隊新坦拉天當4回人參
宇入的最要區沖入，
；國加加[關稅）功能要2015/11/5下竺0-柱器資攏姑
PPAAPEo2015/11/20上午，.。入圖次笠天
他全二Apple2016/12/22下午-入回宙天
gag還人全條
國回EE68回資料天
人而SOZzGQREG生人【
200：7ME
人人衝撞讓7計，凌際覓注戰
辣和Fi2009/7/14下午0.得回次和天
用二Gamin2017/4/2上竺02.-。柱點次笠馮
四0SEC軋銜箭天
生下CC檔飄次簡天
人jrHrc2017/2/3下午08得點盜料天|
和出el2015/11/5下午0-。生器資料天
他5ST
還回和可人SER
上2017/7/12上午0夫點資生天
中McAfeeSecurtyScan和和
站MR二2017/6/15上筆0過回資料天
和
全人.
MySQL4gg日下2016/12/10上午0746
中回Workbench安裝不成功
MySQLWorkbeneh安裝前需要事先兩個程式如下（視Workbench版本，可能為
更新版本的程式）
yyMicrosoft.NETFramework4.5.2
>VisualC++RedistributableforVisualStudio2015
如果整合MySQLServerCommunity安裝時，Workbench安裝不成功，建議可以
到以下網址單獨下載Workbench並安裝。
https：//dev.mysqlLcom/downloads/workbench/
划MysQLworbenmh63CE-SetupWizard時[說
welcometotheSetupwizardforMySqL|
Workhench6.3CE
The5etupWizardwilinstallversion6.3，9onyourcomputer，
Tocontinue，clickNext，
人人革protectedbycopyrightlawand
LT
|1
需事先安裝上述兩個程式完畢，才能安裝Workbeneh，否則會跳出如下提醒，
則代表我們缺少某些必要程式，只要補上安裝就能正常執行，以下例子為NET
Framework4.5.2。和玉NySQULWGrkpench63GETnsalerTnformaton區到
My5QLWorkbenchrequiresthe，NetFramework4，5，2
tobeinstalled，ClicktheDownload-Buttononthenext
pagetoopenawebpagecontainingfurther
instructions，
當多.NETFramework4.5.2下載後的程式為NDP452-KB2901907-x86-
x64-AIIOS-ENU.exe，安裝的畫面如下：
還EE二本二二
安裝進度ss
正在安裝.NETFramework，諮稍候。“其
檔案安全性驗證：
所有檔案者已成功驗證。
安裝進度：？同
正在安裝NETFramework的必要元件多RedistributableforVisualStudio2015，若為64位元Windows作
業系統，下載後的程式為vc_redist.x64.exe，安裝的畫面如下：
下昌
品MicrosoftVisualC++2015
Redistributable（x64）-14.0.23026
|MicR0sgFT軟體授權條款加
|
IMICRDSDFTvISUALSTUDID2015加值、vISUALSTUDIUSHELL和
ICE++REDISTRIBUTABILE
|
了配機說于是中用戶與MicrosoftLCorporation（或其關係企業。視中用~
加也同間接權信吉及歸件（多
號王@][號@
步驟田）》完成上述流程後，即可成功安裝Workbench。CHAPTER忌
回
Django連線
Ms上2
ySQL資料庫
13-1”匯入資料庫
13-2_”Pyihon連線MyS@L資料庫
13-3連結已有的資料庫與Djqngoqpp
13-4設計一個網頁操作資料庫數據
13-5設計一個網頁為新增資料
13-6設計一個網頁為顯示詳細資料
13-7設計一個網頁為修改資料
13-8設計一個網頁為刪除資料
13-9網頁顯示讀取MySeL內的資料MySQL資料庫安裝設定完畢，可以先從資料匯入資料庫開始操作，再測試
Python程式連線資料庫，連絲成功後即可撰寫Python程式碼讀取MySQL資料庫的次
料再回傳給網頁顯示。

13-1匯入資料庫

撰寫一個匯入文字檔的股價基本資料，即將eompany.txt匯入到mysg的操作一
如下。
13-1-1建立資料表

首先，在MySQLWorkbench建立一個名為eompany的資料表，痞屬mydatabase
資料庫之下，欄位名稱與欄位屬性設定如下圖。

|

還名EE

還

FBDrpbngHe|

歸心人名人陷多加e己口口|

半點人|

人|一|

了人
15；
thai5台Beggoga

時紀之人sodDIN加名品日加品日日|

mgbbrevabonVaRCMAR0）mmgm口mm口口|
pi8
NgBIINT（20）mm口口口口口品回
waRgwQemmnmmm加區
ai
1111111111」111，
的lILI）
說加
全me點storage：tu和ored
品355口5E口g
口g5口g&口Sog
已onoemen回85
|
1Ti33四還
kk全全放全記加有說0
時3還1Ep
有ReviewtheSQLScripttobeAppliedontheDatabase|
EE上

onlineDpL】
六4LokType：Defeuk4|
1CREATETABLE“mydatabase，"company”（4
2`stockID”INTUNSIGNEDNOTNULL和
31Abbreviation”YARCHAR（10）NULL，】
YURLVARCHAR（C125）NULLm
？51EmployeesINTUNSIGNEDNULL，
有6~Capital”BIGINT（C20）》NULL，中
171IndustryNameYARCHAR（C16）》NOTNULL
e及（
人9PRIMARYKEY（StockID7），由
人10UNIQUEINDEX、Abbreviation_UNIQUE（CAbbreviationAS一
二一11UNIQUEINDEX~URL_UNIQUE'（URL'AsC）；1
EE
1
加!
2人|
一生一
人l|）（|】|）1
MV
13-1-2檢視資料表
資料表建立成功後，可以點選左上角的按鈕（CreateanewSQLtabforexecuting
>如，執行e
queries），來新建一個SQL語法查詢語法如下，執行結果如下圖
SELECT*FROMmydatabase.company；
11
SOee耐克生ee開ee開章銜二浴苹1
人7全ee
上me0btswwTosw

本9上品

（人：刁品品避可回，寢|

若加有還

lu一1襄!寢Qi回

gERKSsNoESceFl9有

og3E5各全ii

mg

和

gl

eg

和ameouaeaow一一一一|

ELhl|生噴蟬要于生計量時

人人

es還

人下和務器

PERFoRMANCE而

【

【5

多semanesmemasaue

sses

和章。《

33有有31
人1ne
小5NA8：
人Lv2'1【

章suoowwe/ooosse邊

emeao自入

和2

有學說時，

5

8還生11ee執行結果會發現，資料表內是空值NULL'因為資料表雖已建立好，但尚未匯入
資料。
13-1-3匯入資料
匯入資料需要藉由SQL指令操作才能成功的匯入資料到資料庫，新建一個SQL
語法，輸入匯入檔案的SQL語法如下，選好路徑後將它儲存為company.sql。
回生站四日
人cvli和iT
白歸人名所歸還@DE
本
ll一條
eg和
人te站
ae
sp7sotaowm
ee
NS537
di
1
下1上
ge自5
生7下時
Ni
15ae
了unPKE
「LOADDATAINFILE」敘述能使一個文字檔文件快速讀取並匯入到一個MySQL
資料表中。下表是LOADDATAINFILE基本功能的說明。
LOADDATAINFILEM功能介紹：
1_LOADDATAIocalINEIEUserUserDesktop/company.xt汰
2_INTOTABLEcompanyLE
3CHARACTERSETutf8”//選擇編碼方式WFIELDSTERMINATEDBY/每一欄位以某字元分開（t為跳格）
jLINESTERMINATEDBYAn。//設定換行的字元（為換行字元）
6IGNOREILINES；//忽略最前面幾行

在使用「LOADDATA」敘述時加入「local」關鍵字，則代表為從客戶的主機上
詩取文件，如果local沒有被指定，則代表文件必須位於伺服器上。

接著點選工具列的File下的RunSQLScript可以執行剛剛所儲存好的company-
sdl檔。

如果成功會出現以下視窗，記得選取要匯入的資料表名稱，還有編碼設定。在此
有特別注意，companytxt也必須要把編碼改成UTF-8，不然有可能會出現編碼錯誤。
也可以到記事本，開啟company.txt後，確認編碼類型另存成UTF-8如下圖，再進行
匯入資料的操作。

Ra科隘蘭了林的率轉革全并入本和若點
GO說MM0Yi山
國過說光-讓几。@

宇我的服人user

和|Ti亢系統构笠天

TEMt，中
|和說AA編路=

回回用1人系統侵料姑|

紀曙mxcompanytbtDowmosd：|

P口交和；

日

本

41點2o0pany4314三
二|NL

tp人Te區經3

資料匯入成功會出現操作完成的視窗如下圖。國人人
Opgrationcompletedsuccessfuly
Output
es
由
||
生
|
國
||
和
13-1-4檢視資料表
我們重新點開company資料表檢視，在workbench左下角的Schema視窗中，點
選mydatabase左三角形，會展開所屬的資料表，請點選company後會出現資料表的
小圖示，點下表格小圖示如下圖。
scCHEMAs@喲
Fiterobjects
y*二movedby
點Y目mydatabase
家而Tables同
|Y點company@e@胃|
y[伯Columns|
w罷gg
-w人6
】唱本Trnggers本字二中以4人
若出現如下圖，代表我們已成功將文字檔的資料記錄匯入我們的資料庫裡頭。
EE二還而回加全
時三大。凌二對還
vEFYIEVYSTS0
e心儿包多但
In@DEU
“|DLL一JO還議說
2
es
20
ii一二一一一一一一
egJILEe3iggSSSIEeE4C9所明王間宮
3全sililllL2生|
說全人2品歷
7人的和2選
1說和四和
人和Hi二
1上人人還
和全條荐
和字生194239625274320則四和歷19890509品
30說全條生生呈
2人人人回
的還三和
生7人人Cu還
cmpamix點點
-1人j人
LEapkSgS43各2
還各1
2Mo已已各SEEegga52egESSI
EE品oSECgeE
3字ee
RE了
144二“4
13-2Pyihon連線MySQL資料庫
在連線MsSQL之前，先測試建立一個連結（connection）。
安裝python套件PyMySQL，再測試由Python連線MySQL。
13-2-]建立連線
薄陽徐點選MySQLWorkbench的首頁，點選MySQLCi曾
點二oz下yonnections來新增一個
連線。難wysqLworbench1富副
會UocandanceMyS50U57xx
站吧生吧品只品He
MySQLConnections回9Shortcuts
BiLT|NO一$生生
3當人
人人一全2|
|
|
@ge
Models6Qe|
L人|
加站三和
同|
和還：
圖和
w泗谷輸入連線名稱（test_db），帳號（root）、密碼（或連線時輸入），以及預設連線
的資料庫（mydatabase）可以按下"TestConnection'確認資料庫是否連接成功。
加
|ConnectionName：test_db國還還還點圖Typeanamefortheconnectbon上
|ConnectionMethod：。Sandard（TCP/IP）國加MethodtousetoconnecttotheRDBMS|
=ParametersAdvanced
Mostame：1270086
Usemame：ot和Nameoftheusertoconnectwth，|
|Password：BR一et|!
1
|
「
|
[ee下DeLesLa當全連線成功會出現以下視窗。
同天
|合SuccessfullymadetheMySQLconnection
Informationrelatedtothisconnection：
Host127.0.0.1
port3306
User：root
LEenabled
AsuccessfulMySQLconnectionwasmadewith
theparametersdefinedforthisconnection-
|
13-2-2”安裝PyMySQL
PyMySQL是python3.x版後在Django建構的伺服器端架設連線MySQL，
ByMySQL依循Python套件APIv2.0的標準提供Python連線MySQL的服務。
回安裝PyMySQL
安裝PyMySQL，輸入下列指令：
pipinstallPyMySQL
擊啟始設定
在Djangomyapp目錄下的__init__，py文件中增加以下兩列，讓PyMySQL替代
MySQLdb來使用：
ipottpymysql
PymysqLinstalLasMySQLdb0）13-2-3設定資料庫
測試Django連接MySQL資料庫。開啟mysite/settings.py，把DATABASES的設
定格式改成如下：
#Imysite/settings.py
DATABASES=（
'default：（
ENGINE'：'django.db.backends.mysql，#資料庫引擎
NAME：'mydatabase#資料庫名
'USERroot，#用戶名
'PASSWORD'：tfis20160929，#連線密碼
HOST："localhost"，#資料庫主機默認為localhost
PORT：3306，#資料庫端口，MySQL默認為3306
）
》
重新啟動Djangoserver如果沒顯示錯誤，就可以看到資料已同步進我們建立的
mydatabase資料庫下的Tables裡面，這就表示資料已成功同步進MySQL資料庫裡了。
13-3連結已有的資料庫與Djgqngoqpp
網頁由Django連結資料庫。需要藉由物件關係對映（object-relationalmapping，
ORM）簡便的做資料操作含查詢、新增、更新、刪除等。另外，資料庫移植可以有效
管理資料，由Python程式修改資料庫結構（sehema）。13-3-1物件關係對映
Python採用ORM（objectrrelationalmapping）技術，實現物件導向程式語言在不同
類型資料庫管理系統之間的資料轉換。Python語言可以藉由Django支援的ORM機
制操作與查詢資料庫的資料表資料。使用ORM的優點：
1.django內建模型（models.py）功能，可以簡便的更新、操作資料庫。
2.提供大量自動化資料庫操作處理程序。
3提供MVC架構的撰寫模式，讓程式碼更簡潔。
4.可以免去氛寫SQL語法。
LELU
資料庫操作流程。
6.將資料庫與應用程式的關係盡可能的獨立，可以方便更改程式碼而不需更動次
料庫。
7.具有OOP類別繼承的功能，可重覆使用程式碼。
Django內建的ORM技術實踐資料庫操作步驟以下。
13-3-2”引用InspecfHdb套件建立模型
前文已介紹在Workbeneh新建一個company的資料表、接下來就要把資料庫的
數據與Django做連結，為已經存在的資料表創建model。Django中有資料庫整合的
方法，可以藉由inspeetdb套件，資料庫連結程式碼輸出到myapp中的models.py文
件裡。
nspectdb套件針對每一個資料表生成一個Django的model模型。請在windows
命令提示字元下輸入下列指令：
pythonPEinspectdb9myapp/models.py指令執行完畢，會與Workbench的company資料表同步化自動生成如下檔案
myapp/models.py，開啟models.py的檔案如下：
|1fromfuture__importunicode_literals
2fromdjango.dbimportmodels
3
4classCompany（models.ModeD：
5stockid=models.IntegerField（db_column='StockID'，primary_key=True）#Fieldname
madelowerease-
6LEunique=True，max_length=10，
blank=True，null=True）#Fieldnamemadelowerease.
7url=models.CharField（db_column='URL'，unique=True，max_length=128，blank=True，
nulI=True）#Fieldnamemadelowercase-
$employees=models.IntegerField（db_column=Employees'，blank=True，null=True）#Field
namemadelowercase.
9capital=models.BigIntegerField（db_column='Capital，blank=True，null-True）#Field
namemadelowercase.
10industryname=models.CharField（db_column=IndustryNameumax_length=16）#Field
namemadelowercase.
11Tisteddate=models.CharField（db_column='ListedDateymax_length=45，blank=True，
null=True）#Fieldnamemadelowercase.
12
13。classMeta：
14managed三False
15db_table三'company'
16
17classDjangoMigrations（models.ModeD：
18app=models.CharField（max_length=255）
19name=models.CharField（max_length=255）
20”applied=models.DateTimeField（）
21
22classMeta：
還過managed=False
六db_table='django_migrations'本多

所有的models.py是繼承自django.db.models.Model父類別，每一個類別模型都會
對應到資料庫中的一個資料表，其物件實體就會是資料表的一筆一筆資料，關係式資
料庫是一筆記錄，為基本處理單位。

models.py將資料表定義成一個類別見第4列，表格內的欄位（例如：8StockID）等
資料型別名稱，重新定義成此類別的變數名稱（左邊stockid，abbreviation，employees，
capital，industryname，listeddate全小寫）見第5-11列，欄位名稱與變數名稱是相對應
的，這些變數都是models類別中的Field物件。

其中，CharField是文字類別的欄位物件，會對應到資料表中的文字資料型別，
欄位物件有幾個好用的屬性，例如：primary_key屬性為設定關聯式主鍵；max_length
屬性可以設定文字的長度；blank屬性允許資料填入空白等。

定義Meta類別並指定讀取資料表的名稱為company見第13到15列。

Django將資料表欄位與變數的對應在django.db.models.Model中'，即Django會
把這些model的設定處理轉換成各種資料庫的語言，將此sql語法的操作轉換包
（wrapper）python語言內的sql等語法操作資料庫，只是對於開發者來說，不需要寫
sql，會使用就好。

DjangoModel常用到的欄位物件說明如下：

>yCharField-文字欄位

yyDateField--日期的欄位

yTextField-存放大量文字的欄位

y”IntegerField~存放整數數值的欄位

”BooleanField~存放true/false的欄位13-3-3何謂migroHion

Migration（資料庫遷移）主要功能是方便python程式設計師藉由程式修改資料庫
結構（sehema），例如：新增、刪除、修改某個資料表的欄位。使用migration修改次
料庫的優點：（1）每次的修改都會自動留下記錄。migration會自動追蹤那些資料庫結
構被修改了、那些沒有。在Django佈署migration可以方便開發者輕鬆的同步更新資
料庫結構；（2）migration是以python程式撰寫成類別，佈署在django伺服器上。它是
與資料庫管理系統（DBMS）獨立的，即程式與資料獨立，不同的資料庫管理系統可能
有不同的語法，開發者可以依不同的DMBS需求使用不同的語法修改資料庫結構；
（3）當多人共同開發一個專案，且共用資料庫時，若手動修改資料庫欄位，可能造成
他人的程式錯誤或資料不一致的錯誤。有了migration之後，藉由程式自動更新當做
資料庫版本控制系統（databaseversioncontrolsystem）。
13-3-4“Migrqiion常用的指令

有幾個migration常用的指令可以藉由django伺服器佈署操作資料庫結構，如
下表。

指令功能說明

gme。名M病和對人
1epggsgri。

ELLE
在myappYmigrations資料夾，而遷移的主要功能是以相同的方式在同一份資料進行資
料庫遷移的操作。13-3.5建立migrciions資料表
資料庫遷移技術'可以解決資料庫架構變動的問題，所以當我們建立好資料庫模
自，我們部必須針對目前的資料庫模型建立一個migration檔，請在windows命令
比字元下輸入以下指令：
pythonmanage.DymakemigrationsImyapp
myapp是指定的app名稱，若不指定一個app的話，則Django會對所有安裝好
的App做migration的檢查。只要資料庫模型有異動（可能是新生成，增加欄位，減
潤位或被刪除），則會產生新的migration檔，並放置在myapp底下新增migrations
暫夾'見下圖。
myappVMnigrationsN001_initial.py：
3
人Geppmeioms人99
划失四導半S天日如旨屆ii
弓合管理~加入至恕趟區4共用對合沽你SEC國4回@
-冷戰條圖名稱太修改日期類型|
如如Eg8po2017/7/15下午0.。得中資料：
點2
天最近的位置口ooolmitialpy2017/7/16下午1..。pY祿案
-Ly
Migration會記錄發生在哪個APP上，其次會列出建立的migration檔和該檔之內
容，migratiom檔案的名字是0001_initialpy，這代表了資料庫模型的第一版（0001），
底線之後是該次異動的說明，initial代表的是初次生成。migration檔之格式整理如下：
一
版本編號異動說明若使用makemigrations無產生變化則顯示：
Nochangedetected
一個migration檔可視為一個python模組，繼承django.db.migrations.Migration類
別。Migration檔案內包含兩個品列list：dependencies與operations。
list功能說明
說明migration檔案的相依性，即本次migration是基於之前的那個
migration為基礎做異動。
|operatioms說明在上次的migration基礎上，本次要做那些異動。
|程式碼檔名：0001_inifigl.py
1from__future__importunicode_literals
2fromdjango.dbimportmigrations，models
3classMigration（migrations.Migration）：
全
@initial=True
6
7dependencies==[
仿，
9
10operations=[
11migrations.CreateModel（
12hame三Company
13fields=[
14（stockid，models.IntegerField（db_columnr'StoekID'primary_key~True，
serialize=False）），
13（'abbreviation，models.CharField（blank=True，db_column=：PE
length=10，null=True，umique=True）），
16PTELLEdb_eolumn~URL，max_lengthe128，
nul=True，unique=Tme）），和了（'employees'，models.IntegerField（blank=True，db_column=Employees，
mulH=True）），
18（tcapital，models.BigIntegerField（blank=Trmue，db_column=Capitalonul=Trmue）），
可（industryname'，models.CharField（db_column=IndustryNameomax_length=16）），
20（listeddate'，models.CharField（blank=True，db_column=TListedDate。max_
length=45，nulH=True）），
21
八全品
'db_table'：'company，
24'managed'：False，
放）
26》
性migrations.CreateModel（
性name一DjangoMigrations，
29人
（domodels.AutoField（auto_created=TTue，primary_key=True，serialize=False，
verbose_name=ID？）），
3（app，models.CharF：ield（max_length=255）），
3（nameomodels，CharField（max_length=259）），
3（applied，models.DateTimeField0），
341
3options==（
六三員ango_migrations9
37"managed：False，
38）
39）
40]
F
記全dbmodels櫥組見第2列：第3列定義一個Migratloe的二；第一次
攻Wisaton」前以沒有上次基礎，共dependendles中列是空集合見第7列至第8列：
才定的資料庫恩移的欄位集合見第13列至第21列；options可以定義在內部類別（Meta
data）中可能的屬性選項，例如：定義用於模型的資料表名稱，屬性名稱為：'db_
table'，屬性值為company、若要連接到已存在的資料表，'managed設為False，見第
24列，若要由Django藉由ORM自動創建一個新資料表可以設為True。Django會自
行創建一個模型做對應的設定見第27列至第37列。
|資料來源

https：//docs.djangoproject.com/en/1.11/topics/migrations/

ryhttps：//docs.djangoproject.com/en/1.11/howto/legacy-databases/

ryhttp：//kaochenlong.com/2011/10/19/django-db-migration-with-south/

ryhttps：//ihowertw/rails/migrations.html

yhttp：//dokelung-blog.logdown.com/posts/220606-django-notes-5-model-and-database

誠https：//stackoverflow.com/questions/1279613/what-is-an-orm-and-where-can-i-learn-

more-about-it

13-3-5migrqie同步資料表

migrate會根據指定的migration記錄檔（利用編號指定）去將模型同步到資料庫，
將現行的資料庫調整到與migration記錄檔一樣，代表我們隨時可以指定任一編號進
行同步。若不指定編號，則會自動同步到最新的migration紀錄檔。

另外，migrate指令是根據INSTALLED_APPS的設定，按照APP順序建立或更
新資料表，而且與makemigrations相同，migrate需要指定一個APP，否則會對所有
的APP進行更動，即若沒指定，則為自動同步最新版本。

輸入下列指令：

python生migratemyapp同

APP的名稱版本編號|執行結果
Operationstoperform：4
」Targetspecificmigration：0001_initial，frommyapp
Runningmigrations：
Applyingmyapp.0001_initial...OK
代表已成功將Django的模型與資料庫同步化了。
s中史所
13-4設計一個網頁操作資料庫數據
藉由Django做後端，要讓前端網頁可以連線到後端的資料庫，從Django資料庫
抓取資料顯示在網頁上，需要幾個步驟如下：
13-4-1”設定網址的對應
修改mysite目錄下的urls.py
1fromdjango.confurlsimporturl
2fromdjango.contribimportadmin
3frommyappimportviews
4
5urlpattems=[
6url（r^admin/，admin.site.urls），
17url（r^company/$，views.company），
號說]
13-4-2設定網頁需要的資料庫資料
修改myapp目錄下的views.py
11frommyapp.modelsimportCompany
區-fomdjango.shortcutsPEll3
4defcompany（reques6：
ucompany==Company.objects.all0）
6stockid=Company._meta.get_field（'stockid）.column
7abbreviation=Company._meta.get_field（abbreviation）.column人
8url=Company._meta.get_field（url）.column
windustryname=Company._meta.get_field（industryname'j）.column
10”returnrender_to_response（company.html，locals0），
|程式說明
第1列，'，frommyapp.modelsimportCompany，'從models.py中引用Company這個
資料表。
第7列，Company.objects.all0，取出Company這個資料表中的全部資料。
第8列至第11列；Company._meta.get_field（'stockid）.column，取出Company資
料表中名為'stockid'的欄位名稱。
第12列；render_to_response，需要兩個參數，分別是一個網頁和一個要填入網
頁的字典（dict，他將整合所有動作使得一步完成。
locals（）這個函數將會返回一個字典，而這個字典以區域變數的名稱為「鍵」，以
區域變數的值為「值J。
13-4-3設定要顯示的網頁
在myapp/templates目錄下新增company.html1
1_<!DOCTYPEhtmb>
2<htmb>
和<head>
4<metaPE
wuAS6attext-decoration：nonei
7alink{color：#4169e1）
8avisited{color：#4169e1；）
9tabletborder-collapse：collapse；background-color：#ffdead；）
10</style>
11</head>
12<body>
13<hl>從Django資料庫抓取資料顯示在網頁上</hl>
14<p>目前總共有【tcompany|length）筆資料</p>
15<ahref="insert/">新增資料</a>
16<tablecellpadding="8"border一1>
17AV編號</th>
18<th>（tstockid））</th>
19公民人人））~</th>
20<th>（turl））</th>
21<th>（tindustryname））</th>
22<th></th二
2（0%fornincompany%）
24AV
2<td>ftforloop.counter））</td>
26<td>ftnstockid））</td>
芒<td>（{nabbreviation））~/td>
28<td>（tmurl））</td>
29<td>（tnm.industryname））</td>
30AC
3<ahref-"detailttnstockid））/>詳細資訊<a>by
32<ahref-"update/ttnstockid）}/>修改資訊人SA
品<ahref-"delete/ttnstockid））/>刪除此筆<a><b只7
34</td>
35</tr>
中（%endfor%）
37</table>
ss39<html>
|程式說明
透過views.py回傳至頁面的local（），我們可以在網頁上使用後端的參數。Django
以（t後端參數）}的方式，可以將後端的資料顯示在頁面上。在第14列，將views，py
的company的元素總數顯示出來{tcompany|length）}'，第18列至第21列為將各個欄
位名稱給顯示出來，第23列至第36列，Django中的for迴圈用法，必須以（%for%
）“content."•{（%endfor%）的格式使用。
我們已成功將資料庫的數據顯示在網頁上，顯示結果如下：
過菩志和LEO菩并辣辣菩辣基盞天天天其生天天藹藹玉弄型寬弄
|從Django資料庫抓取資料顯示在網頁上|
目前總共有21筆資料
新增資料
EL1
國加3
httpzZrwwwtaiwancementeom|水泥工業|修改資訊
和天除此竹
相網
EL修改資訊
刪除此筆
rrTiITF國
httpz/wwweclateomtw修改資訊
刪除此筆
同加如還
修改資訊
刪除此華
加圖
刪除此筆
rii圖
修改資訊
刪除此筆
le一圖
刪除此筆
_rrI|7圖
刪除此筆
PP是誠琴讓誠二TEN三凡三十一一4
13-5設計一個網頁為新增資料
在mysite目錄下的urls.py中新增下列兩行：
url（r^company/insert/$，views.insert），
PSLE
修改myapp目錄下的views.py
1definsert（reques0）：
2returnrender（request，insert.html）
3
4defdo_insert（reques0）：
5stockid=request.POST[stockid]
6abbreviation==reduest.POST[abbreviation]
7url=requestPOST[url
8employees=reduest.POST['employees]
9capital=request，POST['capital]
10industryname=request.POST[industryname]]
11listeddate=request.POST[Listeddate9
12Company.objects.create（stockid=stockid，abbreviation=abbreviation，url=url，
employees=employees，capital=capitalindustryname=industryname，listeddate=listeddate）
13_Tetumrender（request，'go_company.html1）
|程式說明
第12列為新建一筆資料進Company這個資料表中。
第13列為將網址連接進go_company.html此為自動轉址的用途（Redirec0，使
網頁重新連接至company.html。13-5-1轉址用途
在myapp/templates目錄下新增go_company.html
1_<!IDOCTYPEhtml>
2<html>
3<head>
4<scripttype="text/javascript'>
location.href三"/company/"
6</script>
</head>
8_</html>
13-5-2新增資料頁面
在myapp/templates目錄下新增insert，html
1_<!DOCTYPEhtml>
2<html>
3<head>
4<metacharset="utf-8>
3</head>
6<body>
、<hl>新增資料</hl>
8<formaction=/do_insert/”method="POST>（%csrf_token9%）
人<table>
10AV
1<td>公司簡稱（4碼數字）</td>
12<td><inputtype="text"name="stockid"></td>
13AV
14AV
15<td>簡稱</td>
16<td><inputtype="text”name=='abbreviation'></td>17AV

18AV

19<td>網址</td>

20<td><inputtype="text"name="url></td>

21</tr>

22AV

性<td>員工人數</td>

24<td><inputtype="text"name="employees'"></td>
25AV

26AV

27<td>實收資本額（元）</td>

28<td><inputtype="teXxt"name="capital"</td>

29AS

30<t寢

3<td>TSE新產業_名稱<td>

32<td><inputtype二"text"name="industryname'"></td>
和作詞V

34AV

<td>設立日期</td>

36<td><inputtype地"text"name=listeddate></td>
37AV

AV

<td><inputtype二submifvalue="新增呈</td>
4AV

也AV

全<td><ahref"/company返回清單</a></td>
說</tr>

全</table>

和</form>

46</body>

47</html>、|程式說明
第8列，Django中的POST方法需要加上（%esrf_token%）來防止用戶的惡意
攻擊。
『執行結果
gatelma隘細
[hiocsihos8o00compowrxNM
frvop可gg人em
新增資料
公司向稱4碼數799
回聲人人一
網址83一
員工人數10
實收資本額（元66666一
TSE新產業名稱隊閃由一
設立日期站
蕊昌
一當加
三
te上司台
口localhost8000/comparx
<>》G人[@locahost8000/company/oaaegg圍全中國錫：
加人83
詳細資訊
http：//wwwinnolux.com修改資訊
刪除此筆|
詳細資訊|
http：//wwwpegatroncorp.eom電腦及週邊修改資訊
刪除此筆
詳細資訊
http：//wwwpouchen.com修改資訊|
刪除此筆|
詳細資訊|
修改資訊
刪除此筆
11近mm一一=is
13-6設計一個網頁為顯示詳細資料
在mysite目錄下的urls.py中新增下列行：
url（r^company/detail/（7P<stockid>\d+）/$，views.detail，
這裡設定的是動態網址的對應，使用說明如下：
ME
1.代表一個阿拉伯數字。
2.+代表「一個以上」。
3.所以xd+代表一個以上的阿拉伯數字，例如「0J、「99J、「12345」。可是像「8a」
就不符合，因為「a」不是數字。
4（？P<pk>）代表「把這一串東西抓出來命名為pkJ。
5所以（？P<pk>xd+）代表：抓出一個以上阿拉伯數字，並把抓出來的東西取名為
pk。
綜合以上的規則，r^post/（？P<pk>\d+）/$'會達成以下的效果：

URL條所EE
httpz/127.0.0.1/posts/不符合，因為前面不是post/開頭。
人全，

全
神.
ENLE
修改myapp目錄下的views.py
了蟬defdetail（request，stockid）：|
上2detail=Company.objects.get（stockid=stockid）
計retumrendertrequest'detailhtmlo（detail：detall）13-6-1顯示詳細資料頁面
在myapp/templates目錄下新增detail.html
1_<!DocTYPEhtml>
2<html>
3<head>
4<metacharset="utf-8">
5</head>
6[<body>
<hl>公司簡稱：（tdetailLstockid）}</hl>
8<h2>詳細資料<h2>
9<table>
10AN
11<td>簡稱</td>
12<td>ftdetailLabbreviation））</td>
13AS
14AV
<td>網址</td>
16<td>（（detaiLurl））</td>
17AV
18AN
<td>員工人數</td>
20<td>（（detailLemployees））</td>
世AV
22AS
<td>實收資本額（元）</td>
24<td>（（detaiLcapital））</td>
25AS
26AS
27<td>TSE新產業_名稱</td>
28<td>（（detaiLindustryname））</td>
29AV人30AS

也<td>設立日期</td>

32<td>（（detaiLlisteddate）}</td>

33</tr>

34AV

35<td><ahre儲"/company'">返回清單</a></td>

36</tr>

37</table>

AV

讓入世是

|執行結果

回戰記可3下回
2口loealhost8000/comparx
人人G人合|「@localhost802全人全：
公司簡稱：9999

|詳細資料
一到快樂公司
網址http：//www.test.com|
|員工人數10
|實收資本額（元）666666
]TSE新產業_名稱半導體
|設立日期20171231
|返回清單19-7設計一個網頁為修改資料
在mysite目錄下的urls.py中新增下列兩行：
urlCr^company/update/（？P<stockid>YNd+）/$uviews.update），
urlC^do_update/$uviews.do_update），
修改myapp目錄下的views.py
1defupdate（request，stockid）：

Nupdate=Company.objects.get（stockid=stockid）

3Teturnrender（request，"update.html，（update'：update））
4
5“defdo_update（reques6）：

6stockid==request.POST[stockidr]
abbreviation==request.POST['abbreviation']
$url=redqust.POSTL[url]

9employees=request.POST[employees']

10capital三request.POST[capital]

1Industryname三request.POST[industrynamer]

12listeddate=request.POST[Tisteddate']

13do_update=Company.objects.filter（stockid=stockid）
14do_update.update（abbreviation=abbreviation）

15do_update.update（url=url）

16do_update.update（employees=employees）

17do_update.update（capital=capital）

18do_update.update（industryname=industryname）

19do_update.update（listeddate=]isteddate）

20returnrender（request，'go_company.htm1）

21

22“defdelete（request，stockid）：

23delete=Company.objects.get（stockid=stockid）

kkTeturnrender（request，'delete.html，{'delete'：delete））程式說明
第14列，我們可以從資料庫中取得的物件使用update更新一筆或多筆資料。
而get和filter都是可以顯示部分資料，而使用上有些微差噓，如下：
yget：回傳符合條件的唯一一筆資料。（注意：如果找不到符合條件的資料、或
是有多筆資料符合條件，都會產生exception）
y和iter：回傳符合條件的陣列。如果找不到任何資料則會回傳空陣列。
一修改資料的頁面
在myapp/templates目錄下新增update.html
1_<!DOCTYPEhtml>
2<html>
3<head>
4<metacharset="utf-8'一
人</head>
6<body>
人<hl>公司簡稱：（tupdate.stockid））</h1>
8<h2>修改資料</h2>
9<formaction="/do_update/"method="POST"”>（%csrf_token%》
10<table>
1AV
5<td>簡稱</td>
13<td><inputtype二"textname="abbreviation'value="（（update.abbreviation
gVAKV
14AV
15<tr>
16<td>網址</td>
17LEname="url'value="（（update.url））"></td>
18AV
晤20<td>員工人數</td>
21<td><inputtype="text"name="employees"”value="{{update.employees六>
td>
2</tr>
2<tr>
24<td>實收資本額（元）</td>
25<td><inputtype="text"name="capital"value="{{update.capital）"></td>
26</tr>
usAV
28<td>TSE新產業_名稱</td>
29<td><inputtype="text"name="industryname"”value="（{update.industryname
）"></td>
30AV
31AV
<td>設立日期</td>
33<td><inputtype="text"name="listeddate"”value="（（update.listeddate））">
</td>
34AV
AV
36<td><inputtype="submit"”value="Save'></td>
37<td><inputtype=hidden”name="stockid”value="（{tupdate.stockid））"></td>
38</tr>
39AV
40<td><ahref="/company">返回清單</a></td>
41AV
42</table>
已</form>
玉</body>
45</html>RU
加癌廬人有GE人同
日shostsoo/ceomparxNN
reop=e@日自：
|1
公司簡稱：9999
修改資料
商生ES司。
綱
員工人數
實收資本額（朮0『777|
TSE新產業-名稱世ge司_
設立日期。。加100t0t
Lsae]
返回自踢
要同
口localhost8000/compa'xS還8人
woo可988日
加作息ES雪尖可
詳細資訊
http：//www.pegatroncorp.com電腦及週邊修改資訊
|刪除此筆|
詳細資訊
LE修改資訊
刪除此筆
詳細資訊
http：//wwwtest.com修改資訊|
刪除此筆貞
cm1=生十一眉
13-8設計一個網頁為刪除資料
在mysite目錄下的urls.py中新增下列兩行：
url（r^company/delete/（？P<stockid>\Nd+）/$'，views.delete），

url（r^do_delete/$，views.do_delete），
修改myapp目錄下的views.py
1_defdelete（request，stockid）：
2delete=Company.objects.get（stockid=stockid）
3returnrender（request，'delete.html'，（'delete'：delete））
4
5defdo_delete（request）：
6stockid=request.POST[stockid']
》do_delete=Company.objects.filter（stockid=stockid）
8do_delete.delete（）
9Teturnrender（request，"go_company.htm1）
|程式說明
第8列，我們可以使用delete來刪除資料。
13-8-1刪除資料的頁面
在myapp/templates目錄下新增delete.html
1_<!DOCTYPEhtmlb>
u公司V
3<head>
4<metacharset="utf-8'
u</head>
6<body>
7<hl>公司簡稱：（（delete.stockid）}</hl>
$<h2>詳細資料</h2>】AScsrftoken%）
10<table>

#AV

1<td>簡稱</td>

二AV

14AS

15AS

16<td>網址</td>

17<td>（tdelete.url））</td>

18</tr>

19AV

<td>員工人數</td>

21<td>（tdelete.employees））</td>

2</tr>

23<tr>

儿<td>實收資本額（元）</td>

3<td>（（delete.capital））</td>

26</tr>

27說

3<td>TSE新產業_名稱<td>

3<td>（（delete.industryname））</td>

3</tr>

3AV

3<td>設立日期</td>

生<td>f（tdelete.listeddate））</td>

說</tr>

六AV

<td><inputtype二submitValue二刪除></td>
生<td><inputLEAV
和</tr>

銜AV

大<td><ahref="/company>返回清單</a></td>41AS
42</table>
43</form>
44。</body>
45~</html~
|執行結果
aa王國：
口leeaihost8000/comparx人
ropee
公司簡稱：9999
詳細資料
濕志不快樂公司
網址http：/wwwtesteom
員工人數1
買收資本額（元）7777777
TSE新產業_名稱水泥公司
設立日期20100101
磚過
返回清單
用組AA人站全全全到加
7ohosts0oocomparxNO二2
eeo[aroraaer783e單則回人加日國電：
詳細資訊8
http：//wwwlargan.com.tw修改資訊
刪除此筆
詳細資訊
修改資訊
刪除此筆
詳細資訊
http：/'wwwpegatroneorp.eom|電腦及週邊|修改資訊
刪除此筆
中
http：/wwwpouchen.eom5|
。刪除此筆上[參考資料

|http：//dokelung-blog.logdown.com/posts/220315-django-notes-3-templates

說http：//dokelung-blog.logdown.com/posts/220606-django-notes-5-model-and-database

錠https：//docs.djangoproject.com/en/1.11/ref/csrf/

雇http：//WWww.cnpythonercom/post/77.html

誠https：//djangogirlstaipei.gitbooks.io/django-girls-taipei-tutorial/django/dynamic_url.
html

包https：//djangogirlstaipei.gitbooks.io/django-girls-taipei-tutorial/django/orm.html

http：//dokelung-blog.logdown.com/posts/220833-django-notes-7-forms

包https：//docs.djangoproject.com/en/1.11/ref/models/meta/

詹https：//StacKoverflow.com/questions/5154358/django-Wwhat-is-the-difference-between~
Tender-render-to-response-and-direc

包http：//clifflin123456.pixnet.net/blog/post/44902693

欠http：//comwarehouse.blogspot.tw/2011/07/javascript-locationhrefhtml

接下來執行makemigrations和migrate的動作。和條
1.”在DjangoServer上，試寫一個商品展示頁面，有以下要求：
（1）資料庫欄位要有商品編號、商品名稱、商品數量、刊登日期、商品描述、商
品圖片連結與商品價錢。
（2）將以上欄位的資料顯示至頁面上，而且必須要有新增、修改、刪除等功能，
以Ajax的post方法完成。CHAPTEF加
Googdlefinance
網路爬晶股價資料
14-1Googlefinqnce網路爬蟲股價資料
14-2網路爬蟲股價資料匯入資料庫進行交易策略回測時，若想要設計一個能夠自動化的進行任意標的證券、任意其
間的測試，資料來源的取得是一個問題，無論是付費的資料源（如台灣經濟新報、情
報贏家等），或是免費的資料源（如證交所、Yahoo、Google等），'都很難與回測的程
式結合在一起。試想是否能自行設計一個程式套件，讓想要進行回測的使用者在程
式中自行呼叫，進而完成一系列的測試作業。

本書寫好的一個到Googlefinanee網路平台爬蟲股價資料，由蔡進金先生原創
（E_14_1.py與class_GetGoogleFinance.py），本書作者補充。後續再將爬蟲下來的資料
匯入Mysql，做為後續程式交易策略回測的資料庫基礎。

14-1Googlefingnce網路爬蟲股價資料

本節將先說明Python的程式，其主程式（E_14_1.py），再說明網路爬蟲程式
（elass_GetqoogleFinanee.py）。讀者也可以單獨執行這兩支程式，同樣可以網路爬蟲
股價資料，可以參考Python程式設計入門：金融商管實務案例[第二版]，為本書的
基礎（該書為上冊）。

網路爬蟲股價資料程式，抓Googlefinance平台。
|程式碼檔名：E_14_1.py

1#-*-coding：utf-8-*-

1

3_CreatedonThuJun2209：11：042017

41.自Googlefnanee抓取台股日資料（任意期間）

52.存入EXCEL檔案

6[（@author：蔡進金，林萍珍

5

8importpandasaspd

9importdatetime

10importtime

1
可[入自建類別ProgramTradeclass_GetGoogleFinancejimpottProgramTrade.class_GetGoogleFinanceasGf
#
j#主程式
16defmain（stknostarbend）：
加產生GetGoogleFinance類別的物件實體（gf）
18中GfGetGoogleFinance（stkno，start，end，False）
1#取出物點物件實體的資料指派給Data
20RowData=gf.getstock（True）
21#將股價資料轉成dataframe
2df=pd.DataFrame（RowData）
3”#呼叫存入excel檔的方法
4儿savetoeXxcel（df，stkno）#Savedatatoexcel
為
2#呼叫主程式並代入股票代號與起訖日期
品|main中
2starttime=time.clock（）
性PE
30。start=datetime.datetime（2007，10，1）
31end=datetime.datetime（2017，9，30）
2df=main（stkno，start，end）#呼叫主程式
3endtime=fime.clock0）
，print（程式執行時間=%d%9s'%（round（endtime-starttime）秒）1
|各說明
第1列至第7列是註解程式碼資訊。
第8列至第10列是引用本程式會使用到的套件合pandas，datetime與time。
G第3列引用同目錄下piogmmTade資料夾下的網路展昌程到5
“GoogleFinance，並取一個別名為Gf，留待下支程式說明。
一一wmain_中"其寫？許在
W執行的進入點在第27列，if_name一和：和
"互動的標準輸入介面下，可以直接輸入程式碼來執行這支人
上第28列記錄程式開始執行時作業系統的時間秒數。

第29列是輸入要爬蟲的股票代號。

第30列至第31列是輸入股價資料的開始與結束年月日。

第32列呼叫執行主程式main，代入股票代號與起迄日期。

第33列是記錄程式執行完畢時作業系統的時間秒數。

第34列顯示程式執行總秒數。

主程式在第16列至第17列呼叫另名為Gf的類別，並產生一個物件實體（gp。
第20列取出f物件實體的資料指派給Data，第22列將股價資料轉成dataframe，第
24列呼叫存入excel檔的方法。Gf類別程式碼（class_GetGoogleFinance.py）說明見下
支程式。
|執行結果

使用spyder程式編輯器（安裝方法見本書上冊），輸入1102，2007，10，1至2017，
9，30日，執行時間為100秒，見下圖右下角。若股票代號曾經成功爬蟲後會存和人
excel檔，則下次將不重新網路爬蟲股票資料，而是讀取現行目錄下的excel檔（例如：
1102_20071001_20170930.xlsx，以代號與起迄時間為檔案命名），執行時大約是2秒。店
人

人人
2111j

加和5

REii一

人ee

全全

0ee|人
Li0
人
人|7人
人|2

|op
太有
8ooglefnancedataVprogramTradeNc1ass-6etGooglerinance.py：
汪|2：Futurewarning：

人Li

主。stkno=1182一RE一
1；
人三歷

1

eeae一一一一一
|租式碼檔名：clgss_GefeoogleFingnce.py

人
2DU1
3.“CreatedonThuJun2209：11：042017

41.自Googlefinanee抓取台股日資料（任意期間）

52.存入EXCEL檔案

gg

人

5importpandasaspd

wimportdatetime

10.importos.path

1

1classGetGoogleFinance（）：

1def_init_（selfstkno，startdate，enddaterefresh~True）：

三Self.sdate=startdate
上了selfedate=enddate

+
S_date=datetime.datetime.strftime（startdate，2Y6呈說）
e

說Edate~datetime，datetime.strftime（enddate，%Y%m2%d）18.Self.fn=str（stkno）二十S_date+'十E_dateT.XlsX

19.RE

20.selfrefresh=refresh

全

22.defsavetoexcel（self.data，sheetname）：

23.這

24.若資料不存在，則不寫入檔案

25.晶

26.註en（data）!二0：

2writer=pd.ExcelWriter（self.fn）

28.data.to_excel（writer，sheetname，index==False）

2writersave（）

30.

oadefgetstock（selfasc=False）：

32.ifnotselfrefreshandos.path.exists（selffn）：”#不重置&檔案已存在
33.Data=pd.read_excel（selffn）

34.Data[[open，high，lowo'closeu'volume']衝

235.Data[[open，high，lowo'closeo'volume'].astype（float）
36.Data[['dates']]=Data[[dates中.astype（object）

37.else：

38.s_yy=self.sdate.year

9s_mm=（：%b）format（selfsdate）

40.s_dd=selfsdate.day

41.e_yy=selfedate.year

42.e_mm=（：%b）format（self.edate）

43.e_dd=selfedate.day
和Data=pd.DataFrame（）
45.forstartrowinrange（1，10200，200）：
46.try：
47.#url=https：//www.google.com/finance/historical？q=TPE：（&startdate=0+0%2

C+t）&enddate=（）+（）%2C+（）&num=200&ei-91FUWbDaMIuk0AS8mKzQDg&start=（）A48.ui二https：//finance.google.com/finance/historical？q=TPE：2
SA）&num=200&rei=l1zPaWejPMc3EOQTivbGwBw&starf王（0

和..format（selfstkno，s_mm，s_dd，syye_mm，e_dd，e_yy，startrow）

50.#print（url）

51data=pd.read_html（url[2]

52.data=data.drop（data.columns[[0]]，axis=0）

53.Data=Data.append（data，ignore_index=True）

54.eXxceptExceptionaserr：

畫Print（err）

56.break

自放len（Data）世0：#有取得資料才進行轉換

58.ELTE

已

人已選曲但生生（

61.Data[[open，high，lowu'closeu'volume'].astype（fHoat）

$foriinrange（len（Data））：

2.Data['dates'].loc[i]=datetime.datetime.strptimex\

人4（Data[dates'].loc[，"%b%d，%Y）.date（）

65.到asc一True：

66.Data=Data.sort_index（by=['dates']，ascending=[True]）

67.

人TetumData

69.

20放name一一"main站

九和#

NGetdatafromgooglefinance

為和

人

7start=datetime.datetime（2015，9，1）

76end=datetime.datetime（2017，10，1）

7.。#增加參數，True則重新抓取資料，

28#False則檢查檔案存在與否，若不存在再上網抓取資料。79.”Gdata=GetGoogleFinance（stkno，start，end，False）|
$0.
81.Data=Gdata.getstock（Trmue）
人
83.Savedatatoexcel
84.
35.iflen（Data）!三0：
836.Gdata.savetoexcel（Data，stkno）
37.ag
88.print（'（）抓取的資料不存在!.format（stkno））
[程式說明
本套件利用Python的套件（pandas），自GoogleFinance網站上取得資料，需要能
夠抓取任意標的證券、任意日期區間，並且可以將抓回的資料寫成EXCEL檔案。取
回的資料可任意排序（升冪、降冪）。此外，為強化程式的執行效能，若該標的證券
在該日期區間已抓取過資料，則可直接自檔案中取回資料。
回套件的使用方式
1.建立物件：如程式碼第7列
1胞Gdata=GetGoogleFinance（stkno，start，end，False）
物件名稱：Gdata
帶入參數：stkno（證券代號）、start（起始日期）、end（結束日期）、TrueorFalse
（強制抓取資料註記，若為True則一律重新抓取資料）
物件建立時的初始作業（_init_）：如程式碼第12列至第20列。
5GlassGetGoogleFinance（）：
13.def__jnit__（selfstkno，startdate，enddate，refresh=True）：
上selfsdate=startdate時人；
和下S_date=datetime.datetime.strftime（startdate，'%Y9%m9d"）1
17.E_date=datetime.datetime.strftime（enddate，%Y9%m96d）|
18Selffn=Str（stkno）二十S_date+'十E_date+uxlsx'
19.Self.stkno=stkno
20.selfrefresh=refresh
（1）將傳入的日期資料、證券代號、強制碼等放入self中。
（2）重新定義起迄日期的日期格式（8位數西元年），以供定義檔名使用。
（3）設定輸出檔名。
2.抓取網路資料：如程式碼第81列
81，Data=Gdata.getstock（True）
帶入參數：TrueorFalse（排序註記，若為Tue則資料以升冪排列）
3.存入EXCEL檔案：如程式碼第86列
86.Gdata.savetoexcel（Data，stkno）
帶入參數：欲儲存的資料（DataFrame）、證券代號
加程式說明
1匯入套件：pandas，datetime，os.path
2.存入EXCEL檔案（savetoexce1D：如程式碼第22列至第29列
22.defsavetoexcel（selfdata，sheetname）：!
23.z
24.|若資料不存在，則不寫入檔案
25.z
人EP
writer=pd.ExceIWriter（self.f）
，28.data.to_exeeltwritersheetnameindexFals9）
129writersave（）
和判斷傳入的資料是否存在，若存在則進行存檔動作。其中：
第33列：開啟EXCEL檔案（計上WE乓2~
第34列：將資料寫入EXCEL工作表。
第35列：執行存檔動作。
3.抓取網路資料（getstock）：如程式碼第31列至第68列
31.defgetstock（selfasc=False）：
32.放notselfrefreshandos.path.exists（selffn）：“#不重置&檔案已存在
33.Data=pd.read_excel（selffn）
上已上人二
35.Data[[open，high，low'，'closeu'volume'].astype（float）
36.Data[['dates]]=Data[Pdates]].astype（objec）
首先判斷是否不須強制重新抓取資料，以及設定的檔案名稱是否已經存在，當二
者同時成立時，則直接利用pandas套件，自檔案中將資料取回。
資料取回後，需利用pandas提供的方法（astype），將取回的開高低收資料，轉為
浮點數值型態，以供後續數值計算之用。
上述條件判斷不成立時，則進行重新抓取股價資料的動作。
37.else：
38.s_yy=self.sdate.year
39.s_mm=（：%b）format（selfsdate）
40.s_dd=selfsdate.day
41.e_yy=self.edate.year
42.e_mm=（：%bjformat（selfedate）
43.e_dd=selfedate.day
上Data=pd.DataFrame（）首先進行起迄日期資料的格式轉換，其中年度為4位數西元年，月份為3碼
的英文月份縮寫，日期為2位數字（第38列至第43列），此一動作做為抓取
Lu第4列）。

在介紹上網抓取股價資料的程式碼之前，先說明一下使用pandas套件抓取
GoogleFinanee股價資料的實際作法。

首先在GoogleFinanee網站上查詢任意一檔個股的股價資料，並將網址複製起
來。如下圖所示。
上一
個0REELPPELILLLiIILYLIIKE8&tH
說四Ed而Fbosk[Godub_GGoose1JJ
GoogleTPE3008區吾

FinanceLarganPrecisionCo.，Ltd.（TPE3008）Adtoporfote

Comeamy

SummarygeUpeate

了和DateOpenHighLowCloseVolume

Jan15.20184.255004.270003.96000ee1.552.000

Jan12.20183920004.10000。3.890604.400601.567.000

則Jan11.2018和3800003.87500egSEL832.090

PomolosJan10.20183.780003815003.72500377500959.000

SockscreenerJan9.20183.905003.975003.730.00eg1.368.000

Jan8.20183.820003.955003.80500eg1176.000

et八4.170004170.003985004.10000826.000
同0507.000

如果直接以這個網址，套入pandas套件將資料讀取出來，得到的結果將如下
所示。

In[19]：importpandasaspd
urlehttps：//finance.google.com/finance/historical？q-TPEX3A36988startdate-）anx291X2CX292917&enddate-）anx29
data-pd.read_html（ur1》
bU
各扣提蟬可員可朋光可池記可指有本用時曙蟬生怕回

9人【91多-
9MaNoo
1NaNHaN5243
2NaNNa4487，9e12
9an3，2917NaNJan15，2918，ew3【5
9DateOpenHighLowClosevolume

1Jan12，2918392e.994199.993899.99nodewo
2Jan11，2918”3899.9e9。33875.699egsbmo
3jan19，。29183789.993815.99e”3725.9eieoo
Ajan9，29183995.993975.99e93745.991368999
5）an8，2918”3829.99”3955.993895.96Soxo
jan5，2918“4179.99bgBe826699
7jan4，2918“416e.9e9”4185.9e4989-99ooeg
mj）an3，29184345.994345.994145.994145.99838999
9Jan2，29184955.994265.994619.9e4255，99739999
egEggkg_______這些資料有一部分屬於無法被利用的雜質，需修改參數將其排除，修正方式
所下：
還

CELLELELLISTL
LE
data
全革玉計量
Out[111：圖
e2e4
eDateOpenHightowCloseVolume
1Jan12.2018。3920.004100003890004100.001567000
2Jan11，20183800.003875.003730.003730.00832000
3Jan10.20183780.003315.003725.003775.00959000
4[Jan9，20183905.003975.003730.003745.001368000
5Jan8.20183820.003955003805.003930.Ph

但是其中第一列（row）的資料係為文字資料，亦可視為不可利用的雜質，仍然需
要排除，我們可以使用drop的方法將其捨棄。
1

url1='https：//finance.google.com/finance/historical？q-TPEX3A3998Sstartdate=Jan%291%2CX292917&enddate-JanX？
dataepd.read_html（ur1）[2]
data-data.drop（data.columns[[9]]，axise9）
data
半點說全劑
Out[12]：
ew•5
1Jan12，2018。3920.00410000。3890.004100001567000
一wJan11.2018。380000387500373000373000832000
3Jan10，2018。3780.003815.003725.003775.00959000
4Jan9，20183905003975003730003745001358000
5Jan8，20183820.003955.003805.00。3930.001176000
6Jan5.20184170.004170.00_3985004100.00826000
我們可以改變上面所列的網站內容，達到抓取任意時間、任意標的證券的股價資
料。分析下列的網站內容，表示將抓取大立光（3008）自20170101了20180116為止的
股價資料："https：//finance.google.com/finance/historical？q=TPE：3008&startdate=Jan%20
19%2C9%202017&enddate=Jan%2016%2C%202018&num=200&ei=yA5SeWrHINoqe0QTmh
KCIAw&start=200"，如果將紅色字體的部分改變，就可以讓我們達成抓取任意時間、
任意標的證券的股價資料的目標。此外，由於GoogleFinance每次查詢，最多只能查
詢200筆資料，所以利用程式技巧（forloop）來完成全部的查詢工作。以下是該段程
式的說明：說forstartrowinrange（1，10200，200）：主
!46.try：|
4MauIL=https：//www.google.com/finance/historical？q=TPE：0）&startdate=0）+03%2；
SER
48.urHhttps：//finance.google.com/finance/historical2d=TPE：（）&startdate=（）+0%2
C+0&enddate=（）+0%2C+（）&num=200&ei=1zPaWejPMc3E0QTivbGwBwe&estart=（A|
49..format（selfstkno，s_mm，s_dd，syy，e_mm，e_dd，e_yy，startrow）
50.#print（url）
51.data=pd.read_html（url[2]
52.data=data.drop（data.columns[[0]，axis=0）
3Data=Data.append（data，ignore_index=True）
54.exceptExceptionaserr：
5print（err）
56.break
程式第45列至第56列是一個for迴圈，其中計數器變數（startrow）代表欲查詢的
開始筆數，由第1筆開始然後每次以200筆累加。
第48列至第49列表示將股票代號、起迄日期的年月日資料、及開始查詢的資料
筆數，代入查詢的網址之中。
第51列：利用pandas套件的read_html方法，將資料取回，並只保留編號2的
DataFrame資料內容。
第52列：將取回的第一列資料（為表頭文字）捨去。
第53列：將這批取回的資料'以append的方式保留下來。
第94列至第56列為上述指令的錯誤控制，將上述查詢作業發生錯誤時，程式自
動跳到此處，然後結束查詢迥圈。
Te#有取得資料才進行轉換
58.Data.columns=[dates，openohigho，lowucloseu'volumel]
59.Data=Data.replace（-，0）60.Data[[openuhighulowu'closeu'volume]衝!
61.Data[['openuhighu1lowucloseu'volumer].astype（float）
62.foriinrange（len（Data））：
63.Data['dates'].loc[i]=datetime.datetime.strptime\
64.（Data['dates]loc戰，"%b9%d，%Y"）.date（）
65，on
esData=Data.sort_index（by=['dates']，ascending=[True]）
67.
68.TetumData
第57列：判斷是否自網路上取回資料，若取回資料（DataFrame長度不為0，則
進行資料格式處理，否則程式結束。
至於為何須將取回的資料再處理，理由是自GoogleFinance取回的資料內容為文
字型態，無法被拿來做數學運算。
第58列：將DataFrame（Data）加上名稱（columnname）。
第59列：將取回的資料中，空白的欄位清為零。
第60列至第61列：將"開、高、低、收、成交量"等五欄資料轉換為浮點數型
態o
第62列至第64列：將日期欄的資料格式轉換為YYYYMMDD。
第65列至第66列：判斷如果傳入的排序參數為True（按日期升冪排列），則進
行排序作業。
最後，第68列：將取得的資料傳回。14-2網路爬蟲股價資料匯入資料庫
網路爬蟲股價資料先匯入資料庫，做為後續程式交易策略回測的基礎。
|生碼檔名：E_14_2.himl
1_<!DOCTYPEhtmb>
2<htmb>
3_<head>
4<metacharset="UTF-8'>
5{（%loadstatic%）
6<scriptsrc="http：//code.jquery.com/jquery-3.1.1.js"></scrip選
7<scriptsre=（%static"E_14_2/E_142.js"%）"></scrip選
$._</head>
9_<body>
10。<h3>網路爬蟲股價資料匯入資料庫<h3>
11。<tableborderF="0'"呈
eAS
AEVAoaoV
14<legend>讀取即時股價資料：</legend>
15<span>股票代號：</span><input。type=textidstockidvalue="3008"><p>
16<span>起始日：</span><inputtype二dateid="start_date"value="2007-10-01'>
17<span>終止日：</span><input_type~'date"id='end_date"value="2017-09-30><br<br>
18<inputtype="button"id二"btn_searchevalue二查詢只
19</fieldset></td>
20AS
</table>
22。。<spanid="result"></span><br><br>
23</body>
24</html>|程式碼檔名：E_14_2.j

1_$（document）.ready（function（（

2$（"#btn_searche）.click（function（（

3document.getElementById（C'result"）.innerHTML=抓取中若期限過長，請稍後1

分鐘呈

4varstock_id二$（"#stock_id9）.val0；

wVarstart_date三$（"#start_date"”）.val（）；

6varend_date二$（"#end_date"）.val（）；

$.ajax（t

8type：'GET//傳送方式

9url："/E_142_Py"，//傳送目的地

10data：f/要傳送的資料

三加

"Start_date'：start_date，

13'end_date'：end_date

14》

15success：function（Data）（

16$（C#result"）.html（Data）

17）

error：function（e）《

19console.log（e）；

20）

210

227D》

23
[程式說明

透過Ajax的方式，將輸入的資料傳遞進/E_142Py這個路徑，因此我們也必須

在urls.py中添加EE142_Py的路徑，如下：

urlCr^E_142Py/$uviews.E_142Py）

AN而在views.py中也必須添加要執行的動作，如下：
1_fomE_142importE_142main
2
3defE_142_Py（reques0：
4stock_id=requestLGETPstock_id]
5start_date三request.GET[start_dater]
6end_date=redquestLGET[end_dater]
四response三EE142main（stock_id，start_date，end_date）
8TeturnHttpResponse（response）
|程式說明
E._14_2.py是將前一章節的E_14_1.py進行調整過的。把E_14_2.py檔的路徑放
置在CAAnaconda3VMLibwsite-packages（請根據自己的安裝路徑），裡頭放置了所有安
裝包。
在第1列去引入E_14_2.py的main函數。
第4列至第6列去接收GET的值。
第7列執行BE_142.py的main函數，進行網路爬蟲股價資料的指令。
第8列再將E_142main（）回傳的訊息顯示至頁面上（suceess）。
|答式碼檔名：E14_2.py（moin的部份）
1defmain（stkno，start，end）：
2#產生GetGoogleFinance類別的物件實體（gf）
】gfE=GfGetGoogleFinance（stkno，starbend，False）
4#取出物gf物件實體的資料指派給Data
5RowData=gfgetstock（True）
6《#將股價資料轉成dataframe
4df=pd.DataFrame（RowData）
#呼叫存入excel檔的方法|人全savetoexeelCdfstkno）#SavedatatoeXcel
10status_text=gfexcelto_db（dfstkno）
1Teturmstatus_text
|程式說明
在存入excel檔的動作後，新增了第10列至第11列。
第10列執行gfexcel_to_db的Function，將Exeel的數據存入進資料庫中，並將
狀態訊息指給一變數status_text，在class_GetGoogleFinance的程式碼中會詳細說明。
第11列則是將狀態訊息status_text回傳回去。
原本的class_GetGoogleFinance.py要進行調整。
程式碼檔名：clgqss_GefGoogleFingqnce.py（建構子的部份）
1classGetGoogleFinance（）：
2def__init_（self，stkno，startdate，enddate，refresh=True）：
畫
4if（isinstance（startdate，str）全Trueorisinstance（enddate，str）三True）：
startdate=datetime.datetime.strptime（startdate，'%Y-%m-%d）
6enddate=datetime.datetime.strptime（enddate，'%Y-%m-%d）
selfsdate=startdate
8selfedate=enddate
as
|程式說明
在建構子添加了第4列至第6列的程式碼來解決資料型態不同的問題，因為原本
直接在Python裡輸入的start_date與end_date都會是datetime的型態，但換成Html
將start_date與end_date送到後端Python時，'卻會是str的型態，因此添加第4列至
第6列的程式碼來解決資料型態的問題。在class_GetGoogleFinance.py中再添加一個excel_to_db（），負責將產生的excel數
據存進資料庫中，並回傳狀態訊息回去。
|程式碼檔名：clgss_GefeoogleFingnce.py（添加一個新的funcfion）
1importpymysqLcursors
xxlrd
3
4defexcel_to_db（selfdata，sheetname）：
5
6#若資料不存在，則不匯進資料庫
7Me
8#連線MySQL改成自己的資料庫設定（見setting.py）
9connection三pymysql.connect（host三'localhosto
10user三Toot，
1password三tfis20160929
12db=='mydatabaseo
13charset三'utf8mb4）
加try：
1Withconnection.cursor（）ascursor：
16
=oo品
18#取股票名
19table_name三'stock_+self.fn[：4
20#判斷資料表是否已存在於資料庫
21table_exist_sql="SELECTTABLE_NAMEFROMinformation_schema.tables
WHERETABLE_SCHEMA='mydatabase'ANDTABLE_NAME=%s'"%（table_name）
品#使用execute（）方法查資料庫中表是否存在
人exXist_table=cursor.execute（table_exist_sq1）
人#如果已存在資料表
同iexist_table二1
歡delete_sql="DROPTABLE`%s”"%（table_name）
加PEACR三3delete_msg="將資料庫中已有的%s表進行刪除!<br>"%table_name

29

30create_table_sql="CREATETABLEmydatabase.""+table_name+”（idINT
NOTNULLAUTO_INCREMENT，`dates'DATENOTNULL，`open'VARCHAR（10）
eeVARCHAR（10）NULL，`close'VARCHAR（10）
NULL，'volume'VARCHAR（20）NULL，PRIMARYKEYid）"

31cursor.execute（create_table_sq1）

52#讀取excel檔

33stock_fn==xlrd.open_workbook（selffn）

34sheet=stock_fn，sheet_by_name（sheetname）

35

36forrinrange（1，sheetnrows）：

37date_value三xlrd.xldate_as_tuple（sheet.cell（r0）.value，0）

38dates=datetime.date（*date_value[：3]）.strftime（'%Y/%m/%d"）

過PELESLL

40high=sheet，celltr2）.value

41Jow=sheet.celltr3）.value

42close=sheet.celltr，4）.value

43volume三sheet.cell（p5）.value

44Print（date，open，high，low，close，volume）

45sqL_insert="INSERTINTOmydatabase."+table_name+e（datess，opens，
high"low"close，“volume）VALUES（%s，%s，%s，%s，%s，%s）"

46cursor.execute（sql_insert，（dates，open，high，low，close，volume））

47#沒有設置默認自動提交，需要主動提交，以保存所執行的語句

48connection.commit（）

49retur（delete_msg+"股價資料已儲存到exeel中，並成功寫入進資料庫9

50exceptEXceptionase：

51Print（"Execeptionoccured：（）"format（e））

52finally：

53connection.close（）

54else：

55return（"輸入錯誤的股票代號或是錯誤的日期9）|程式說明
第1列載入pymysqLeursors用於Python與MySQL的連線。第2列載入xjrd模
組，用於處理excel讀取的動作。第7列判斷是否有數據。第9列用pymysgql來進
行資料庫的連接。第25列判斷資料庫中是否已有重複的資料表，有的話則會將原先
的資料表刪除。第30列為新建一筆新的資料表。第32列為使用xlrd模組讀取excel
檔。第36列以迴圈的方式一列一列的抓取excel檔的數據並存進資料庫中。第37列
可以取得日期tuple。第38列可以將tuple中的數據轉成DATE型態第49列最後將獎
態訊息回傳至main（）中。
[執行結果
/口loealhost人有
fop全ee回四已回二
網路爬蟲股價資料匯入資料庫
讀取即時股價資料：
股票代號8一
人
過
股價資料已儲存到exeel中，並成功寫入進資料庫!LETELLE國回玉
RER99：gg：gg5879.g5945-9g5845.95845.9275g9g-g

2917？-99-g5gg：gg：gg5855.g5945.-95855-9g5935-9229g9g.9g

2917-99-g6gg：9g：99g5989.95995.95859.95895-933299g-@

2g17-g9-g7gg：9gg：gg5955-969gg.95895.95945-9358ggg.9g

2917？-99-g8gg：gg：gg5999-95995-95955.95979.9g262999.-9

2g17-99-11gg：gg：gg598g-9g5985.95815.95825.9g31899g9-9
1約組系gg：gg：995889-95925-9579g.95869-93869gg.日

2917-99-13gg：gg：gg586g-g586g-9g5635-g5635.9769ggg.@
2g17-99-14gg：gg：gg5649-95675-9EL條吧
2917-99-15gg：gg：gg5599.9575g-9553g-9g5729-95？4ggg-g

REgg：gg：gg58g95.g5845-95？45-g5829-9263ggg-g
1gg：gg：gg5859.9g5915-95895-g5835.93959gg-@
12917-89-29gg：gg：gg5879-9g5879-9565g-gou，ugg

2g1i7-99-21gg：gg：g95695-9573g-9g5599-957gg-g5959gg-9@由
直上PH條了
2g17？-g9-25gg：gg：gg53gg.g5475-g5269.d5339-99879g9g-g1
REALEL5115.919879g9g-g：

2g17-99-27gg：gg：gg53gg.-g545g.g53gg：g：54gg-g.8749g9g-2

luluwuggsoaou，5345-95379.9554ggg-d4
已儲存到exeel中，並成功寫入進資料庫+1

全膏RcuYESAU人人相1
RE及唱衣411說：1人由
KEEP
rsiliryi717177

2LaLTAL有全全
11ee
ri|33一
1和|
ee1|
52各Excelii

gauther：蘭衝年，和生玉1111

全|

TE全||
SI|
SPFi
和TH上還
crAvalueistryingtobesetonacopyofaslicefrom計

gg站DataFrame

人

二和全ENSeethecaveatsinthedocumentation：http：//

gaGepandas.pydata.org/pandas-docs/stable/

人indexing.htmlsindexing-view-versus-copy

Datarrame（RosData）

W》etD：McloudstationVLISAVteaching\教材

了ee條有
和72：futurewarning：

33

和byargumenttosort_index1sdeprecated，pl

1了-
1程式時間。199秒!
SEE

ELLE全））In[4：

區同一一一一人
1j4：113175.3？各還站點還還

廁

1.”在DjangoServer上，試撰寫一個頁面可以爬蟲高雄公車即時動態的程式，將
站牌編號、站牌名稱、往返、倒數、到站時間等資訊匯入進資料庫中，並將
DataFrame顯示回頁面上。
http：//ibus.tbkc.gov.tw/xmlbus/StaticData/GetRoute.xml

2.”在DjangoServer上，試撰寫一個頁面可以爬蟲高雄市_楠梓站的每小時空
氣品質，將測站代碼（SiteIld）、測站名稱（SiteName）、縣市（County）、測項代
碼（ItemId）、測項名稱（ItemName）、測項英文名稱（ItemEngName）、測項單位
（ItemUnit0、監測日期（MonitorDate）、數值（Concentration）等資訊匯入進資料庫
中。並將DataFrame顯示回頁面上同
http：//opendata.epa.gov.tw/ws/Data/ATM00600/？$format=xml

3.在DjangoServer上，試撰寫一個頁面可以爬蟲紫外線即時監測資料，將測站名
euEL
經度（WGS84Lon）、緯度（WGS84Lat）、發布時間（PublishTime）等資訊匯入進資
料庫中。並將DataFrame顯示回頁面上5
http：//opendata2.epa.gov.tw/UV/UV.xml
這裡很推薦讀者們可以至政府資料開放平台https：//data.gov.tw/，找到自己想要得

知的政府公開資料，然後可以用爬蟲程式將內容扑下來，做後續的程式操作。CHAPTEHPIt
Fm的
lm+加
量化技術指標
15-1TA-Lib簡介
15-2下載與安裝IA-Lib套件
15-3量化技術分析-指術指標
15-4均線糾結
15-5布林通道TA-Lib套件是專門針對技術分析指標撰寫的套件，程式設計師即可直接使用此
套件技術指標的函數（方法），省去撰寫技術指標的程式，專注在程式交易策略的績
效回測。本章將介紹TA-Lib套件的下載與安裝、介紹均線糾結與布林通道買賣策略
以及回測績效指標的分析。

15-HTA-Lib簡介

TA-Lib是跨平台股市技術分析工具，目前包含超過200個技術指標包含SMA、
ADX、MACD、RSI、Bband等。其開源API提供C/C++、Java、Perl、Python引用，
底層是C/C++撰寫，提供Python套件呼叫引用的就是TA-Lib。

>官網

http：//www.ta-lib.org/

y子數清單

http：//www.ta-lib.org/function.html1
15-2下載與安裝IA-Lib套件

TA-Lib是由C++撰寫，執行時需要能執行C++程式的環境。另外，TA-Lib不是
Python的官方認可的套件，需要自行先下載wheel程式再安裝。

15-2-1C++程式

先下載C++程式，本書的windows作業系統是windows7，64位元，請到以下網
址下載程式。

http：//www.microsoft.com/en-us/download/details.aspx？id=15336「MicrosoftVisualC++2008RedistributablePackage（x64）
|
Le
||
」TheMicrosoftVisualC++2008RedistributablePackage（x64）installsruntime
componentsofVisualC++Librariesrequiredtorun64-bitapplicationsdevelopedwith
VisualC++onacomputerthatdoesnothaveVisualC++2008installed.
請點選Download下載veredist_x64.exe程式後安裝如下圖，依照預設選項完成後
續安裝程序。
開啟春宗-安全性巡告還am
是否要執行這個矽案？
圖名稱：CNUsersNuseNDownloadsvcredistx64.exe
發行者：Microsoftcorporation
類型：產用班式
從：CNUsersNuseNDownloadsxcredist_x64.exe【
=
多加]
回開啟這個檔案前一定要先詢問（WN）
讓的檔案可能是有用的，但是這個檔宰類型
史廬全TREEMIEEEERR
、朮。饞。有有什麼樣的風險？
15-2-2”wheel程式
wheel程式的下載安裝步驟整理如下：
縣環答到以下網站下wheel程式
http：/www.lfd.uci.edu/~gohlke/pythonlibs/#ta-lib
由全看到找到下圖的超連結後點選下載TA_Lib0.4.10cp36cp36mwin_amd64.whl
若安裝不成功，可以再換同作業系統位元（64）的其他程式試看看。TA-Lib，avwrapperfortheTA-LIBTechnicalAnalysisLibrary.
上ib-0.4.16-cp27-cp27m-vWwin32.wl
TA_Lib-0.4.16-cp27-cp27m-win_amd64.whl
TA_Lib-0.4.16-cp34-cp34m-win32.whl
TA_Lib-0.4.16-cp34-cp34m-win_amd64.whl
TA_Lib-0.4.16-cp35-cp35m-win32.whl
AALib-0.4.GoD35-cp335-Wwin_amd64.whl
TA_Lib-0.4.16-cp36-cp36m-win32.whl
TA_Lib-0.4.16-cp36-cp36m-win_amd64.whl
TA_Lib-0.4.16-cp37-cp37m-vwin32.wh
TA_Lib-0.4.16-cp37-cp37m-vwin_amd64.wh

步虹窟）將“，whl檔案複製到cu..Wnaconda3VScripts\資料夾下
步馭他點選windows作業系統左下角的「開始」，在文字方塊（下圖左下角處），輸
入cmd後按enter。
若MicrosoftVord2010》-（罕佃說卻說
鄧GoogleChrome+人
回繼
NME
TT
風MicrosoftPowerPoint2010w
TT
區MicrosoftVisio2010》
和二有
區MicrosoftExcel2010
本PT
2家y
蕊二生由2
Notepad++
預設程式
和
2ELEI有說明及支援
dB：
贍$5
》[所有程式|
上人3
MM引|a生自密+只it
當人@@進入cmd視窗，在CAUsersvuser>目錄下切換到...Wwnaconda3MScripts資
料夾下，即可cmd視窗輸入
ecd/dC：/ProgramFiles/Anaconda3/Scripts
翊會成功切換到...Wnaconda3XScripts資料夾後，再輸入安裝TAJLib套件的指令
如下：
pipinstalTA_Lib-0.4.10-cp36-cp36m-win_amd64.wh1
4勳安裝成功會出現
SuccessfullyinstalledTA-Lib-0.4.10
或已裝過會出現：Requirementalreadysatisfied：一
見下圖：
世系統管理只：CAWVindowsNsystem3ZNcmd.exe上加3
四
2『【
RE（
有EL
4.uhl
5和0用號放廬三江上
EL計全三說
EP3
和LEL351二多
上
步時令）1，
人全輸入condalist確認是否有安裝成功'，見下圖TA-Lib0.4.10<pip>
各
國和管理員：CAwindowsvystem32XmdLexe回回
相生9.5.3和
01.5.7？p936-@
思Epy36_9
同人by36_9
到了了3EL
E隔作eeEL
51LE
所記gg
_和gEE
條用HE
有當漲佃回到python編輯器如（spyder），執行以下程式無有錯誤即成功安裝，並可以
使用talib套件。請注意套件名稱為TA-Lib，但在python環境下引用時要用
talib，才能成功。請執行E_15_0.py，程式碼如下。

加還E櫥圖首次引用talib的python程式範例，產生100個0到1之間的亂數，

使用talib的SMA方法，計算5日的簡單移動平均。
此程式必須要在Python的編輯器（上冊書有寫明）才能執行。
簡單移動平均（simplemovingaverage，SMA）又稱算術移動平均，指依過去n日
（含當天）的收盤價計算簡單移動平均，以n天移動平均為例，公式如下：
CC十Cr-2二Cr十，，，十Cr
人人
|程式碼檔名：E_15_0.py
1_importtalib
2importnumpy
3close=numpy.random.random（100）
4output三talib.SMA（close，5）
5print（outpu0）
|程式說明
第3列使用numpy.random.random（）函數，產生100筆範圍在[0.0~1.0]的隨機浮

點數，接著在第4列使用talib套件的SMA方法，計算出5日的簡單移動平均。

『執行結果

[nannannan...，0.543327760.62014525

0.46055062]
第一到五筆是空值，第6筆到100筆即為亂數的5日簡單移動平均。
《人人說條
15-3量化技術分析-指術指標
量化技術分析的四個步驟，分別為型態、K線組合、技術指標（MACD、RSI、
MA、BBand等）、成交量（即所謂的籌碼）。
若依重要程度分別，最重要的是成交量，成交量是指外資、投信、自營商、主力
（籌碼集中度），這些因素造成。次者為型態、K線組合、技術指標（此為輔助用）。
股價糾結後價澀成交量暴增，預期多頭行情來臨。
20000|
li
15000硅
品2y=
EE一
10000二im此=
一和im盯二時
Ma三|||
，人嚼
二大時硬守由|||
1世人88169316947166人47270583816949272
oo/5027
條
7
國2人15-3-1”型態學
在說明和干擾項以外的歷史行為走勢，透過近期的歷史k線圖，研究其結構型態，-
分析其多空向，預測未來的漲跌趨勢。
常用的型態有W底、M頭、頭肩底、倒頭肩形、三重底、三尊頭、上升旗形與
下降旗形等型態如下圖。
彈頭肩形
人
230.0全=叫到_
4
210.0l他
190.0!三=
170.0|
15-3-2K線組合
又稱K棒，為今天盤中所有價格走向的簡易化，而K棒又分為紅K棒與黑K棒。品測章四
|~!1人條條
|1dL
_4-
|
|~
上78.20+）3，
11
Le：
操二tn全，，4itttriititattttiiiiittiiiiitirittt
1
|「7720
Oi<C'紅k棒（k棒之收盤大於開盤）
80.50全
80.00
79.50
8人太
-78.50HIIHNHHHHHIHEHILHHIIXUUHIHHE有
Oi>Ci黑k棒（k棒之收盤小於開盤）15-3-3技術指標MA、MACD、RSI、BBond布林通道線）

統計學的標準差概念，由美國JohnBollinger所發表，運用統計學中標準差的理
論來判斷股價和標準差偏離程度，常態分配狀況下若股價離標準的範圍外太多，股價
可能回到正常的範圍內機率將提高。

它利用平均股價的波動算出正負2個標準差的範圍而畫出上下範圍的曲線，股價
95%機率會在這個區間，當股價上漲或下跌超過這個區間就隨時可能股價回往相反的
方向修正。Bband指標如下圖：

「1

x生

/

2400和

名和

也和之

了（7

|星

ge1/

人/

人/

|詣和|和/

2100上人7

2
15-3-4籌碼
1.每個券商分點資料。

2.神秘金字塔。
3.外資、自營商、投信、主力、融資券買賣超。籌碼分析主要研究市場持股者動向，尤其重要是公司內部人與三大法人的買賣超
天股動向，董監持股與股價的走勢具有高度正相關，如下圖：
1和號4讓
yi
9全三+
eg7一#!!!t，iT
200加人由由人時攻計量表歡計和汪設一三際
雪吉旭拓拉時守宮gg
人
人
三大法人中外資的持股與散戶的持股呈現負相關，而外資的持股趨勢與股價具高
度的正相關，如下圖：
250.00
081jj|
1
ma三240.00
ee
230.00
Wi生
生
0.80二晤=220.00
了二人
外資持股比例%人
07二
；品呈點
4和套套各大卅守宮3s0oo和和三25.00
=
=41下太
性品一
450000十||15.00
400000|||10.00
散戶累積竺股張數
3500001三eg
；|
均線：5SMA為今日收盤累加前四天再除以五，以此類推
3
5一cf4）+c（/一3全2）+c（/二今天收盤累加前4天，）
（人
TA02（0）-（今天收盤果加前9天）
多頭排列'當均線糾結時，未來有機會呈現多頭排列或空頭排列。
300
和
25.0二
縣/
20.01昌必
u加上和
和二說本雪
均線糾結多頭排列人
1扣均線糾結後多頭排列
到
2.旋410（）>旋410（/一1）上彎
ccSLR）
4.410（/）>旋420（）（多頭）
EN旋410（/）>旋420（）（準備多頭）
回均線糾結後空頭排列
1200
|ls0=
一說
一
說7
下人
再加和人
則=
同|/
|和下/
提示
-」了na
加彈型態學
點語計和古語還計生人還了和
上升趣替出
250~
『【7
200肯
呈
的生ha和
和。
多頭必要條件：底底高一上升趨勢線
2700#_4
Wai
各
2500說舉人
人下中起替
地/
Me~才7
Ni
MA
os
1900|和轉
二
Lu
17020
空頭必要條件：頭頭高一下降趨勢線g劑

三侈

_本骨科

時

和|划

計

|

：
人=

了MT三NM站

太二
合作六）
一全還

人上

115-1|才|

|人和才

16.5|吧人（轉點

-記再As、了7
和
|Di
大人一
本
E
900
二人
2
el本章以實作技術指標交易策略為主，應用TA_Lib套件之指標撰寫交易策略，普
進行回測。以下將針對簡單移動平均、加權移動平均與布林通道做程式交易策略回測
的範例。

15-4均線糾結

均線指的是移動平均線，是投資人最常使用的一種交易策略，藉由股票的收盤價
移動平均判斷股價劇烈波動下未來可能的走勢。

移動平均線糾結的情況大部分會產生未來幾天的股價出現向上或向下比較劇列
波動的現象，本節使用的均線糾結規則如下加權移動平均（weightedmovingaverage，
WMA）大於簡單移動平均為買進；反之賣出。以n天移動平均為例，WMA公式如
下：

TE

WMA是將過去日內的股票收盤價取平均值，其權重以平均系的長度來設定，
但近期的收盤價對股市價格波動影響介重要，給予比較高的權重。計算原則是將每
日的收盤價會乘以一個權重，最近的價格的權重最大，其之前每一日收盤價的比重將
E
均線糾結策略回測，使用Python套件TA-Lib中的SMA（簡單移

動平均）與WMA（加權移動平均）指標做買賣策略的參考，並計算
此策略的回測績效指標與顯示均線走勢圖及標出買賣點。另外一首
判斷準則，超越鑾數量的門檻值2%（Change），亦即WMA>SMA
且大於2%為買進；反之賣出，5日均線為例。

本範例需要的套件含Pandas（內建），numpy（內建），plotly，TA-Lib，htmlslib，請事
先確認已安裝完成。

本範例單次回測一檔股票，不考慮交易成本。交易規則如下：還稚點
WMA（5）>SMA（5）且Change>1.02，即當5日的WMA大於5日的SMA，且
WMA超過SMA2%，以當日的收盤價為買進價。
Chonge=WMA（5）/SMA（5）
賣出點
WMA（5）<SMA（5）且Change<0.98，即當5日的WMA小於5日的SMA，且
WMA低於SMA2%，以當日的收盤價為賣出價。
最後出場
有買進動作，沒有賣出訊號，則在最後一個交易日賣出清倉。
績效指標
1.交易次數：回測期間，買進後賣出算一次交易次數。
2.累計報酬率：第一次的交易報酬率開始町計到最後一次。報酬率的計算公式
如下：
_賣出價-買進價
報酬率=買進價
3.勝率：大於零的報酬率除以全部的總報酬率，即正報酬率/總報酬。
4.獲利因子：所有大於零的交易的獲利金額除以所有小於零的交易的損失金額，大
於1為佳。
資料期間
2007，10，1至2017，9，30，共10年.資料來源

以2017年12月某一天的股價，以上市櫃公司股票篩選舌股準則為：（1）20日均
線上升；（2）今日收盤>20日前收盤的1.055；（3）股價的斜率>0.15%。

共選出21檔股票見下表，選股這部份沒有寫成程式碼。

td沿效謊說代號海交走光

-交加2481|坊|」
還國各還還點加生葡天生生加還家點還生加加可二到國加
[2375一華映TT

執行範例程式E_15_1程式之前，請先確保資料庫中已有股票資料、欄位正確，
並且資料表以[stock_股票名稱]為命名原則，例：stock_3008、stock_2317
[程式碼檔名：E_15_1.himl
1_<html>
2。<head>
3<metacharset="UTF-8">
4<scriptsrc="http：//code.jquery.com/jquery-3.1.1.js"></script>
5（loadstatic%）
6<seriptsre="（%static"E_15_1/E_15_1js"%）"></scripb>
7</head>
8[<body>
9<h3>題目：均線糾結<h3>10<tableborder二0>

1AN

12<td><fieldset>

1<legend>新增資料庫資料<legend>

14<span>股票代號：</span><inputtype="text"id=r"insert_stock"><br><br>

1<span>起始日：</span><inputtype="date"id="start_date"value="2007-10-01>
16<span>終止日：</span><inputtype="date"id="end_date"”value="2017-09-

VSAV

17<inputtype="button'id="btn_insert"value="新增

18</fieldset></td>

19AV

20<legend>讀取資料庫資料<legend>

21<span>股票代號：</span>

22<selectid="stock_id一

23（%forstock_nameinstock_names9%）

六<optionvalue="{{stock_name））>（（stock_name））</option>

2（%endfor%】

26</select><br><br

多<inputtype="buttonid="btn_search”value二回測只

38</fieldset></td>

29AV

30</table>

31<spanid="result></span><br><b只

32。</body>

33<html>
|程式碼檔名mm一

ELL

2$（9#btn_search"）.click（function（t和
3天和~，抓取中，，.若期限過長，請稍後1

分鐘呈
4varga和5s$.ajax（（
6type：'GETo//傳送方式
7url："/E_151_Py"，//傳送目的地
8data：//要傳送的資料
9stock_id：stock_id，
10D
1success：function（Data）（
12$（r#result"）.html（Data）
13生
14orfunction（e）《
15console.log（e）；
16
17
187D
19
20。。$（"#btn_insert".click（function04
21document，getElementById（“result"）.innerHTML='抓取中....若期限過長，請稍後1
分鋅
22EL
23varstart_date二$（"#start_date"）.val（）；
24varend_date三$（"#end_date"”）.val（）；
25$.ajax（（
26gd四//傳送方式
27url："/E_142Py"，//傳送目的地
28data：f/要傳送的資料
29Stock_id：stock_id，
30'start_date'：start_date，
31"end_date'：end_date
32）
33success：function（Data）（
34三
》太六務error：function（e）（加濕
名console.log（e）；
聞）】
39小
台
4路
urls.py記得做變動，而在views.py中也必須添加要執行的動作，如下：
1_fomE_15_1importmainasE_151main
2fromdjango.dbimportconnection
3
4defE151（request）：
5tables=connection.introspection.table_names（）
6REAL二
7fortableintables：
8itlen（table）一10andtable[：6]一'stock_'andtable[-4：]isdigit（0）：
9stock_names.append（table[-4：]）
10retumrender（request，E_15_1.html，locals0）
1
12defE_151Py（request）：
13stock_id=request.GET[stock_id]
16response=E_151main（stock_id）
17retumHttpResponse（response）
|程式說明
第1列引入自定義模組E_15_1中的main方法。
第2列引入Django內建的connection方法。
第4列為載入一開始HTML頁面時所要執行的指令。
第5列依靠conneetion方法找到所有Models的名稱。第8列加入判斷式，從資料庫中找出所有符合[stock_股票代號]這個命名原則
ELEL
中的值。

第12列為取得使用者選擇的股票代號。

第16列傳進E151main（）進行計算。

第17列顯示結果。
|程式碼檔名：E15_1.py
1importpymysqlcursors
2importpandasaspd
3importnumpyasnp
4importdatetime
5importtime
6
7#引用talib相關套件
8importtalib
9#引用plotly相關套件
10importplotly
11fromplotly.graph_objsimportFigure
5importplotly.ofHlineaspyo
13
14#設定plotly帳號與apikey
ALCa
16pyo.ofhline.init_notebook_mode）

17

18#繪製K線圖

讓

20

21。”#設定X，Y軸以及格式化線圖
22tracel=type：'scatter，23全全

24人So

25mame'：'收盤價，
26mode：lines7）

27trace2三（type：'scatter，
28人

29y：dfPSMAr，

30LE

31mode：lines'

32trace3=（type：'scattero
出xo

34y：dfWMA，

35Ep

36"modelines”

37trace4=（type'：'sScatter，
38xdfLXBuy，

39y'：dfPYBuyr，

40'mame'：'買進點
41mode'："markers，

42'marker：dict（

43Size三10，

上color=red）》

45

46trace5=（type：'scatter，
47六全

48LE

說mamer：'賣出點

50Bemarkers

51'marker：dict（

52symboL='diamond，
53size=10，

54colorblack0》55

56layout=（title'"簡單移動平均（SMA）與加權移動平均（WMA）交叉
57xxaxissttitlet日期9，

58yaxis：ttitle：'價格），

59）

60

61data=[tracel，trace2，trace3，trace4，trace5]

62fig三Figure（data=data，1ayout=layout）

63Ppyo.plot（fig）

64

65“defSMAWMA（df，count，acmroi，winrate，winfacD）：
66close三np.array（dfLclose']，dtype=float）

67。。SMA=talib.SMA（close，5）#close代進SMA方法做計算
人和福生#close代進WMA方法做計算
69diDSMA]=SMA

70dfWMA1=WMA

71print（df）

72#設定初始值

73df[XBuy']=np.nan

74dfYBuy']三np.nan

75df[XSell]=np.nan

76dfPYSell]=nmp.nan

77

78gg號

79fag三False

80change=0

81buyprice=晶

82二

83win=0

84loss=0

85roi=0

86foriimTange（roWw）：訂。0hange二diPWMA.iloc[i]/dfLSMA'.iloc輻

3說Cag一False）友（dLWMATiloe站>diPSMATiloc[）&（ehange二1.02）：

59prnt（0

00Drint（'漲跌幅=三，change*100）

9print（.Buy）

eeprint（dfelose[i）

9dfPXBuyTiloc[=dfidatesiloc品

于。。dfPYBuyTiloc[i=delose]iloc戰

9buyprice三dfclose'r].iloc叫

96fiag三True

27if（ag一True）&（dLWMAiloe戰王diTSMATiloc[）友（change一093）

9print（i）

99cechange*100）

名選號

101print（dfeloser].iloc[i）

102dfXSelI]=dfdates.iloc喇

103dfYSelI]=dielose].iloc品

104sellprice三dfLclose'].iloc圍

105Count十三1

106fiag=False

107[roi，winrate]三roical（buyprice，ELWinrate）

108acmroi+=roi

109[loss，win]三winfactor（buyprice，sellprice，loss，Win）
生人8

111dfXSel]=di[dates.iloc品

條是二

113sellprice=dfLeclose].iloc各

14count二三1

115[roi，winrate]=roical（buypriee，sellpriee，Winrate）

116acmroi+三Tol

117。iloss一0：

118loss=三win3讓讓119winvar三win/loss

120returm（dfcount，acmroi，winrate，Winvar）

121#計算報酬率與勝率

122defroical（buyprice，sellprice，winrate）：

123roi=（（float（sellprice）-float（buyprice））/float（buyprice））
124iroi>0：

125winrate+=1

126return（roi，winrate）

127#計算獲利因子要用的累計獲利金額與損失金額
128defwinfactor（buyprice，sellpriceloss，win）：

129payoff=float（sellprice）-float（buyprice）

ce=品ve

131Win+三payo任

132else：

133oss+=abs（payofp）

一上。return（loss，win）

135defselect_db（stkno）：#查詢資料庫的股票資料
136connection三pymysqlLconnect（host三'localhost，
137user三Toot，

138Password三tfis20160929

139db=='mydatabaseo

140charset三mtf8mb49）

141try：

142Withconnection.cursor（）ascursor：

143

144#取股票名

145table_name三"Stock_十str（stkno）

146table_select_sql="SELECT*FROM`%s”%（table_name）
147df=pd.read_sql_query（table_select_sqlconnection）
148Tetum匡

149

150exceptExceptionase：japrint（"Execeptionoccured：（）format（e））
12finally：
153connection.close（）
1#主程式
155defmain（stkno）：
156。下=select_db（stkno）#查詢資料庫的股票資料
157#初始值設定
品中
159count=0
160。acmroi=0
161。winrate二0
162。winfact=0
163”#呼叫SMAWMA策略
164[dfcount，acmroi，winrate，winfact]三SMAWMA（df，count，acmroi，Winrate，winfact）
165strl=!交易次數三噴str（coun6+'次；+!昧計報酬率='十str（round（acmroi*100，2））+
i+!勝率='+str（winrate）+5獲利因子=='二str（winfact）
166。print（str1）
167”#將呼叫畫圖函數showMAplot
168showMAplot（df）
169”#將顯示結果回傳回去
170。retum（strl，dfto_html（classes=））
171#showcandle（Data）
|程式說明
此程式範例使用到許多套件，比如說：pandas、numpy、datetime、time、talib、
人六入机后天，抓取在資料庫內的股票數據，接著以plotly套件繪
圖表。
第2列引入numpy套件，為支援矩陣的運算。
第15列使用繪製圖表的plotly套件，plotly使用前要事先申請為plotly的用戶。
第19列至第63列的showMAplot（），專門用來繪製K線圖第65列至第119列的SMAWMA0，專門以TAlib套件進行技術分析。

第121列至第125列的roical0，用於計算報酬率與勝率。

第127列至第133列的winfactor（），用於計算獲利因子要用的累計獲利金額與損
失金額。

第135列至第153列的db_select0，用於連線資料庫並以[stock_股票名]的資料
表命名方式，抓取資料庫中的資料。

第147列是將抓取的資料庫資料全數轉換成pandas的DataFrame的格式，以便後
面進行操作。

在第155列的主程式main（）必須移除start_date與end_date的參數，因為這支
E15_1範例程式，抓取股票資料的方式是從資料庫抓取，而非網路爬蟲，因此不需
要start_date與end_date的參數。
|執行結果

3bU

條較還基基拉若基補對基宣NCI還才二生還有全

：均線糾結和

新增資料庫資料

各|）語取資料庫資料

|

起始日：2997/19/9@1終止日12917/99/36國

加到
沙光汗可1閃避由電由當二加
（data|Jopeaaigh|lowJdose|volume|SYMA|WMAXui|
扯全條條人嚷嚷一只一寢
下時各中四昌閃說人|了|可耳|還

TISESSAS人ASarer

TEEaeobyarar

玫86和954000|REBi

上0971009000bs523|1510990984Bb96000000NaINas

op22247pec和56000[294622035INNa

四人

|太區一一路
同轉玫各直下0Be92509074Bb77o9eoNaaa
|o0710.1982[213P80[88[1902009780Bal609090NaNa
SP|390.5188和49100083.185.100000INaN2al|
[下回放及上店盚H和點胃人時還Ni轉蟬
了eeooeee蟬四
Ge+rcmnxsNi
CCYEELELSK
一ee
「：
=
|三3009
「>
加到Way
15-5布林通道
布林通道（BollingerBands，BBand）也稱為布林通道是約翰.包寧傑（John
Bollinger）在1980年提出的技術分析指標。BBand結合移動平均和標準差的觀念，
將布林通道分成三條軌道線（中軌、上軌與下軌）。中軌為股價的n日的移動平均，
上軌和下軌則可以是股價的上方壓力線和下方支撐線。
布林通道計算方式如下：
y中軌~n日的簡單移動平均
>上軌~中軌+k倍標準差xn日的簡單移動平均
下軌~中軌~k倍標準差xn日的簡單移動平均建議的參數預設為n=20和k=2，這兩個參數值是在布林通道當中最常被使用
到的。在日線圖裡，n=20是MA20，亦即月均線，20日收盤價移動平均。k=2是
2倍標準差，依照常態分布理論，約有95%的機率，股價會落在距離平均值，正負2
個標準差以內的範圍。
使用Python套件TA-Lib中的BBand指標做買賣策略的回測績效
分析，延用上例的21檔等其他回測環境。一次回測多檔股票，同
時回測均線糾結與布林通道兩個策略，交易規則如下：
今日最高價大於上布林線時，即為最高價大於2倍標準差時，指行情正處於強
勢中，雖短線會拉回，但強勢趨勢不變，可以趁勢追價。高於上布林線常為漲勢，
故作多。
y買進
今日最高價>上布林線且成交量是20日均線的2倍
y賣出
今日最低價<下布林線且成交量是20日均線的2倍
（更新了E_15_2的範例程式，36至50頁）
|程式碼檔名：E_15_2.himl
1_<html>
2公S$
3<metacharset="UTF-8">>
4<scriptsrce="http：//code.jquery.com/jquery-3.1.1.js"></Script>
5（loadstatic%）
6<scriptsre="（%static"E_15_2/E_15_2.js"%）"></script>
7</head>
8人83V
9<h3>題目：布林通道<h3>
10<tableborder="0">
1AS12<td><fieldset>

13<legend>新增資料庫資料<legend>

14<span>股票代號：</span><inputtype="text"id="insert_stock"><br><br>

15<span>起始日：</span><inputtype="date"id="start_date"value="2007-10-01~

16<span>終止日：</span><inputtype="date"id="end_date”value="2017-09-
VS人

她<inputtype="button"id="btn_insert"value="新增呈

18</fieldset></td>

19<td><fieldse>

20<legend>讀取資料庫資料</legend>

21<inputtype="radio"name="choose_type”value二allid二alchecked>所有
股票<bry

N<inputtype="radio"name="choose_type”value一oneid="one">單一股票

悶<span>股票代號：</span>

24<selectid="stock_id>

0（%forstock_nameinstock_names3

26<optionvalue="{（{stock_name））”>（（{stock_name）}</option>

vsBR

28</select><br><b說

29<inputtype地buttonid="btn_search”value="回測寢

30</fieldset></td>

31AS

</table>

33<spanid=Tesult></span><br><br>

34</body>

35</htmz

|程式碼檔名mp

約SEE

2$（C#btn_search.）.click（function（）（

3document.getElementByIdC'result”）.innerHTML==，"抓取中....若期限過長，請稍後1
說

varmethod=$（"input[name三choose_type']：checked"）.val0；天2Eflegz

6Varstock_id三$（"#stock_id）.val0；

中$.ajax（t

8type："GET"，//傳送方式
9url："/E_152Py"，//傳送目的地
10data：（//要傳送的資料
1mstock_idr：stockid，

5衝

success：function（Data）（

14$（r#result"）.html（Data）

15）

16error：function（e）（

17console.log（e）；

18）

19坊

ae）

2elseif（method二"al

22$.ajax（t

23type："GET9，//傳送方式
24url："/E_152Py"，。//傳送目的地
wLdata：f/要傳送的資料
26stock_idal

27），

28success：function（Data）（

29$（"#result"）.html（Data）

30》
人error：function（e）（
32console.log（e）；
3）
34族
357）
36gg37

38$（#btn_insert"）.click（funetion0（

39document.getElementById（"result"）.innerHTML==!抓取中....若期限過長，請稍後1
分鐘量

40Varstock_id三$（"#insert_stock9）.val0）；

41VarStart_date三$（#start_date"）.val0）；

42varend_date=$（"#end_daten.val0）；

4$.ajax（（

太type：'GET//傳送方式

4url："/E_142_Ppy"，//傳送目的地

46data：f/要傳送的資料

47stock_id：stock_id，

說'Start_date'：start_date，

49'end_date'：end_date

50）

51success：function（Data）（

52$（"#result"）.html（Data）

53和

54error：function（e）（

55console.log（e）；

56）

57六

58】

sg划拓
urls.py記得做變動，而在views.py中也必須添加要執行的動作，如下：

1fromE_152importmainasE_152main

2fromdjango.dbimportconnection

3importpandasaspd

4

5defE_15_2（request）：

6tables二connection.introspection.table_names（）》Stock_names=靈

8fortableintables：

9itlen（table）一10andtable[：6]一'stock_'andtable[-4：].isdigit0）：

10stock_names.append（table[-4：]）

11Teturnrender（request，E_15_2.htmlulocals0）

12

13defE_152Py（reques0）：

14stock_id==requestLGET[stock_id]

15istock_id一"al

16tables=connection.introspection.table_names（）

17dfSMA=pd.DataFrame（）

18dfBBand三pd.DataFrame（）

19#SetDataFrame

20forindex，tableinenumerate（tables）：

21iftlen（table）一10andtable[：6]一'stock_'andtable[-4：].isdigit（））：

22stkno二table[-4：]

23YIFIEPSEE
24dfSMA==dfSMA.append（df2，ignore_index=True）

25dfBBand=dfBBand.append（df2，ignore_index=True）

26”#將每一股股票進行回測

27forindexinrange（len（dfBBand.index））：

28print（dfBBand.get_value（index，id0）

29Tesult=E_152main（dfBBand.get_value（index，id），dfSMA，dfBBand，index）
30。response==result

31else：

32dfSMA三Pd.DataFrame（eolumns=[Lid，count，roi，winrateo'winfactor]index=[01）
33dfBBand三Ppd.DataFrame（columnsr=[id，countoroi，'winratewwinfactor]，index=[01）
34dfSMA[id]=stock_id
35dfBBandDPid]=stock_id
36response=E_152_main（stock_id，dfSMA，dfBBand，0）
os
38TeturnHttpResponse（response）|生說明

第1列引入自定義模組E_152中的main方法。

第2列引入Django內建的connection方法。

第5列為載和人一開始HTML頁面時所要執行的指令。

第6列依靠connection方法找到所有Models的名稱。

第9列加入判斷式，從資料庫中找出所有符合[stock_股票代號]這個命
名原則的資料表，加入進陣列中後並回傳至頁面上，顯示在使用者可以選擇的
<select><option>中的值。

第13列為使用者按下回測所要執行的指令。

第15列至第30列為判斷計算所有股票。

第20列至第25列為設置好DataFrame的格式。

第27列的迴圈將所有股票的資料傳進E_152main（）進行計算。

第31列至第36列為判斷計算一檔股票。

第36列將一檔股票資料傳進E_152main（）進行計算。
|程式碼檔名：E15_2.py
1_importpymysqleursors
2importpandasaspd
3_importnumpyasnp4
4importdatetime
5importtime）
6#引用talib相關套件|
7importtalib
8fromtalibimportMA_Type9
10defSMAWMA（dfcount，acmroi，Winnum，winfacp：
“”"”同上E_15_1範例程式
65defBBandMA（df'count，acmroi，winnum，Winfact）：
66”#設定初始值
67dfLBBXBuy']=np.nan
68dfPBBYBuy]=np.nan
69dfBBXSell]=np.nan
70。dfLBBYSell]=np.nan
71”#計算BBand下，中，下線
22PICEEE
73upper，middle，lower=talib.BBANDS（close，timeperiod=20，nbdevup=0.0001，
nbdevdn=0.0001，matype=MA_Type.T3）
74df[BBupper]=upper
75dfPBBlower]=lower
76vol三dfLvolume'].as_matrix（）.astype（"float64"）
77dfPvoIMA']=talib.SMA（vol，timeperiod=20，）
78fag三False
79buyprice操
80sellprice=
81win=0
82ne
83roi=0
84foriinrange（len（d）：
85ELLEFi
（float（dfvolume.iloc[i）>（float（dflvolMA'iloc[i）*2））：
86buypriee=df[close.iloc品
87dfPBBXBuy.iloe[]=dfdates].iloc占
88dfPBBYBuy].iloc[]=buyprice
89EL
主（flag一True）友（float（dfLlow'd.iloc[i]）<float（df[.BBlower].iloc[ij））&
（float（dfPvolume.iloc[i]）>（float（dfLvoIMATiloc[）*2））：下sellprice==dfLcloser].iloc品

w八加

LE

count+=1

（7flag==False

96[roiwinnum]==roical（buyprice，sellprice，winnum）

多EL

98[loss，win]=winfactor（buyprice，sellprice，1oss，Win）

99放（flag一Trme肥ien（dp-1）：

100。。BBXSel]=dfLdates].iloc品

101sellprice=df[close].ilocl

102dfBBYSel]=sellprice

103count+三1

104[rowinnum]==roical（buyprice，sellprice，Winnum）

105acmrol十三TOl

太人Be

人

Ewin/loss

EL

110count=0.01

11strl=，BBand策略：二!交易次數=上str（count）+'次；'+'困計報酬率='+strtround
（aemroi*100，2））+9；"二!勝率='+strtround（Cwinnum/eoun0*100，2））+%%+獲利因子
=!十strtround（winvar2））

112print（str1）

113Teturm（count，acmroi，winnum，Winvar）

114#計算報酬率與勝率

115defToical（buyprice，sellprice，Winnum）：

~““同EE151範例程式

120#計算獲利因子要用的果計獲利金額與損失金額

121defWinfactor（buyprice，sellprice，10ss，Winm）：

：~同上EE151範例程式

88#查詢資料庫的股票資料1生人廬店129defselect_db（stkno）：

.。同上E_15_1範例程式

149#主程式

132defmain（stkno，dfSMA，dfBBand，j：

133df=select_dbtstkno）

134。#呼叫SMAWMA策略

135[count，acmroi，winnum，winfact]=SMAWMA（df'_count=0，acmroi三0，Winnum=0，

winfact二0）

136。if（count一0）：

137count=0.01

138dfSMA['eount].iloc[]=count

139dfSMA[roir].iloc[i]=round（acmroi*100，2）

140。dfSMA['winrate]iloc[i]=round（（winnum/count）*100，2）

141dfSMA['winfactor].iloc[i]=winfact

142。print（'dfSMA='，dfSMA）

143。#呼叫BBand策略

144[count，acmroi，winnum，winfact]=BBandMA（df，count三0，acmroi=0，winnum三0，

winfact二0）

145。if（count一0）：

146count=0.01

147“dfBBand[count].iloc[]=count

148dfBBand[roi].iloc[i]=round（acmroi*100，2）

149dfBBand['winrater].iloc[i]=round（（winnum/count）*100，2）

150“dfBBand[winfactor].iloc[i]=winfact

151print（dfBBand=='，dfBBand）

152returm（dfBBand.to_html（classes=））|
|程式說明

此程式範例為BBand策略，而以上有些許部分與上題類似所以省略帶過，而在

86列為BBand的買點，相反的在第91列為BBand賣點，在條件中fiag值為是否買
這支股票，因為一開始設定為沒有，所以flag=False，但只要符合條件買下此股後fiag
就會等於Tme，而條件中的dflhigh].iloc[i]>df[LBBupper].iloc[i）為此股的高點要大於BBand的上線，在第74列中也計算BBand的上中下線，最後（dfPvolume'Jiloc品>
（dfi[volMA'T.iloc品*2）為此股的volume要大於兩倍的voIMA值，而volIMA為SMA
的技術分析。
[執行結果
和：：全閃而還
題目：布林通道和
新增資料庫資料和
加人
人
[|
加還加-
6|
EpES人6
[0232467上
SEES員
[MEee152和
[s|2344413.9轎5.83上.83515
SEE人瘋50161上
SEE-
人人
CSS222407
EL93|
EL
全；
全再日四日提半生國說加

還

1.。帶量突破均線，交易規則如下：

y買進
今天收盤價>10日均線且昨天的收盤價<10日均線且成交量>10日均量的
兩倍。

y賣出
今天收盤價<10日均線且昨天的收盤價>10日均線且成交量>10日均量的
兩倍。

2.]三重指數平均線指標（T3），T3是一種採用信號數據處理方法來計算均線的方
法，它的目的是既可以準確反映股價的走勢，又不會有嚴重的滯後性。這種方
法最早是由TimTillson提出的。交易規則如下：

y買進

本範例當收盤價<T3G30）作為進場點。
y賣出

收盤價小於均線（10）作為出場點。

3.”相對強弱指數（RelativeStrengthIndex，RSD，藉比較價格升降運動以表達價格
強度的技術分析工具。RSI在1978年6月由美國機械工程師威列斯.威爾德
CwellesWilderR.）提出的技術分析方法其中一種較容易向大眾傳譯的計量工
具。交易規則如下：

y買進

本範例以RSI小於25時作為進場點。
y賣出

RSI大於65時作為出場點。4AIR指標（AverageTrueRange），原文是AverageTrueRange，原文的意思是「平
均真實區域」指標，所謂的真實區域，其實指的是真實的股價「波動」區域.這
個指標也是威爾德（Wilder）所發明的。

在計算ATR指標時，要先算出TR（TmueRange）這個數列，TR有一個明確的定
義，它指的是在以下三個數字中最大的那個數字：
a今日最高價減最低價
b.今日最高價減昨日收盤價的絕對什
c.今日最低價減昨日收盤價的絕對值。
交易規則如下：
y買進
本範例以當ATR波動小於0.5且收盤價大於SMA（10）時作為進場點。
y賣出
收盤價小於SMA（10）作為出場點。

5._KD指標，KD指標是使用RSV的加權移動平均來計算的，RSV數據表達的是
r與最近9天相比，今天的股價是強還是弱？J。而KD數值越高代表個股的收盤
價接近最近幾天的最高價，反之KD數值越低代表個股的收盤價接近最近幾天的
最低價。交易規則如下：

y劉進

本研究利用KD數值大於50作為買進。
y賣出

KD小於15作為賣出。6.。指數平滑異同平均線（MACD）是股票交易中一種常見的技術分析工具，由Gerald
Apple於1979年提出，用於判斷股票價格變化的強度、方向和趨勢，掌握進出
場的時機點。採用此趨勢指標一則除去了移動平均線頻繁發出的假信號，二則保
留了移動平均的趨勢性、安定性等特點。交易規則如下：

y買進
本範例以當單獨採用指數平滑異同平均線（MACD）的柱狀圖（DIF）>訊號線
（MACD）。

>賣出
離差值（DIF）<訊號線（DEM）。K線組合
和品
16-1”如何畫K線圖

16-2_K線組合分析買賣時點K線最早由日本人Munehisa在17世紀開發的應用於世界第一大米期貨市場。
1991年Nison引入歐美證券市場。K線圖的特性（1）同時表示開、高、低、收四種價
格；（2）反應市場上的供需平衡；（3）也可反應投資人的情緒與心理層面；（4）可以分類
市場的形勢；（5）可以辦識市場的趨勢。

16-1如何畫K線圖
在畫K線之前，先對K線做一些定義與說明。
1.K線的四種價格：開盤價（開）、最高價（高）、最低價（低）、收盤價（收）；
2.收盤價高於開盤價畫紅K線（陽線或空心K線），其餘畫成上下影線；
3.收盤價低於開盤價畫屆K線（陰線），其餘畫成上下影線；
4.依時間的價格頻率，K線可以分為：
y分K線：固定n分鐘（5分、10分、30分等）內的交易記錄，依開、高、低、
收畫K線。

『日K線：依每日的交易記錄的開、高、低、收畫K線。

y週K線：依每週的交易記錄的開、高、低、收畫K線。

y月K線：依每月的交易記錄的開、高、低、收畫K線。

本書統一用空心K線代表紅K線。

K線的畫法分陽線與陰線，規則是收盤價與開盤價之間為實體，最高價與最低價
分別以直線標示在實體之上與之下，如下圖。陽線陰線
最高價~----4------最高價
看---上影線---》
收盤價---4----開盤價
4-
開盤價---水4----收和價
看---下影線---多
最低價------4------最低價
16-2K線組合分析買賣時點
本章K線組合的交易策略採用呂宗勳等教授共同發表的論文，採用K線組合
的交易策略分析其投資貫效。採用三種「趨勢判斷」和四種「交易策略」'組合出
8個交易策略，4個多頭策略TWS、TIU、TOU、MS與4個空頭策略TBC、TID、
TOD、ES如下圖。ThreeWhite（TWws）ThreelnsideUp（TIU）ThreeOutsideUp（TOU）MorningStar（MS）

ThreeBlackCrows（TBC）ThreeInsideDown（TID）ThreeOutsideDown（TOD）EveningStar（ES）

先從「趨勢判斷」判斷K線的趨勢為上漲或是下跌，若為上漲趨勢從「交易策
略」中判斷符合TWS、TIU、TOU、MS任何一種就將買進股票。反之若有下跌趨勢
從「交易策略」中判斷符合TBC、TIB、TOD、ES任何一種就將賣出股票。
16-2-1趨勢判斷

在使用K線做交易準則時，事前研判未來股市的趨勢至關重要。先決定未來走勢
再選擇買進股票或賣出股票。以下介紹3種判斷趨勢的方法。
加人

第一種趨勢判斷是由Caginalp與Laurout在1998年提出S774，，計算每日5774）
用以判斷，連續六天上漲即為上漲趨勢（Uptrend），連續六天下跌即為下跌趨勢
（Downtrend）。判斷規則如下：y連續六天上漲
SA756~577Z45.5<CN<5275<人2<475274
y連續六天大跌
yy多
回2.2574
第二種趨勢判斷是由Marshall等學者在2008年提出EMA10。計算每日27指
數加權移動平均，當日收盤價大於Z74判斷為上漲趨勢。反之，當日收盤價小於
EL
N三要（CISNL
其中，@=2/（10+1）
y上漲
當日收盤價大於ZZ4
RU
>下跌
SEE
OANE
回3.Levy趨勢
第二種趨勢判斷是由Levy在1971年提出。依線性公式的針率計算價格移動的
變化量做為判斷上漲或下趴趨勢。當天與第前6天的收盤價弦化量大於或小於6們的
9。判斷規則如下：
y上漲
第t天與第t6天的收盤價變化量大於6倍的6
各人av人
加
16-5>下跌
第t天與第6天的收盤價變化量小於6倍的9。
SA
中
其中，9為過去131天每日的價格變動的平均數。
16-2-2交易策略
先採用3種趨勢判斷目前股市是上漲或下跌後，再搭配8種K線組合的交易策略
做為買賣的準則。共分成8個策略，本章每一個策略均交易規則，分原始論文表示式
與虛擬碼表示式，建議Python程式碼撰寫參考慮擬碼表示式為主，說明如下：
品空轉多
判斷為下跌趨勢後反轉為多頭，可以搭配的4個種交易策略為TWS，TIU，TOU，
MS進行回測如下示意圖。
IT
1.TWS（紅三兵）
TWs起始起始判斷趨勢為下跌，後勢接著出現三根紅K線，以最高價格為結
束，這種模式暗示下跌趨勢會扭轉為上升趨勢，因此建議投資人買入股票。判斷規
則如下：論文表示式

P7-P？

P7>PKi>P/2；P2>P？i>P？2；Pfi>P7>Pi
虛擬碼表示式

下跌趨勢後紅三兵策略（TWS）

須符合以下所有買進條件：

（1連三紅：C>OoiCu>O；Ca>O2，；

0）頭漸高：C>Cnui；Cr>C2o：

（3）底漸高：Ca>O.；Onu>O2a：

（4無跳空缺口：Ca>0；：o>Ou：

ThreeWhite（TwS）

其中，C=收盤價；0=開盤價；互=最高價；了=最低價。2.TIU（內困三日翻紅）

TIU是判斷為起始為下跌趨勢，後勢接著1根長黑K線與2根紅K線，意謂著
反轉趨勢。因此建議投資人買入股票。判斷規則如下：
論文表示式

P72六P722出PZ2有V
SUNEW的人倫
虛擬碼表示式

下跌趨勢後內困三日翻紅策略（TIU）

須符合以下所有買進條件：

（1）長黑後止跌小漲：oa>C-，；O-2>Oil；O_i>C，；

（2）小漲未過前一日開盤：0a2>CauiCnau>C2：

（3）紅K強力反轉：C>O：

（4）創近三日收盤新高：C>Oz

ThreeinsideUp（TIU）3.TOU（外側三日翻紅）
TOU是判斷為起始為下跌趨勢，後勢接著1根短黑K線與2根長紅K線，意謂
。著反轉趨勢。因此建議投資人買入股票。判斷規則如下：
論文表示式
P#2>Pg2；Pi>P？2>Pg2>P？i；
P>P？和PP>Pi：
虛擬碼表示式
下跌趨勢後外側三日翻紅策略（TOU）
須符合以下所有買進條件：
（D小黑K後止跌反彈：oa>Ca：cu>g，，；
（2）開低走高強力反轉：o，>caica>o，，：
HE
iT
ThreeOutsideUp（TOU）4.MS（晨星）

MS是判斷下跌趨勢後接著1根長黑K線，第2天可以黑K也可以是紅K，第3
天是1根長紅K線，空轉多趨勢。因此建議投資人買入股票。判斷規則如下：
論文表示式

PK2>Pf2；IPZ1-PZil>0；Pf2>P7i和Pf2>P？1；
Pct>Pot和Pc>Pe，+（Po，，-Pc.，）/2
虛擬碼表示式

下跌趨勢後晨星策略（MS）

須符合以下所有買進條件：

（1）黑K後隔日跳空小紅小黑：orz>Cao；il1Ona-Cul>0；

（2）跳空下跌後強力上漲：Ca2>Cau；：Ca>Omi；

（3）近一日紅K作收：C>O；

（4）收盤在實體黑K長度一半以上：G>Ca+（g2-0C2）2：

MorningStar（MS）回多轉空

判斷為上漲趨奉後反轉為空頭，可以搭配的4個種交易策略為TBC、TIB、
ToD、ES進行回測如下示意圖。

1

ST

TBC起始起始判斷趨勢為上漲，後勢接著出現三根黑K線，所有收盤價均低於
開盤價，這種模式暗示上升趨勢會反轉為下跌趨勢，因此建議投資人賣出股票。判斷
規則如下：
論文表示式

PK2>PZi>P7；P？2>PZ1>Pf2；P71>P7>PK1；
虛提碼表示式

上升趨勢後黑三兵策略（TBC）

須符合以下所有賣出條件：

（1連三黑：C<oi；icu<ou；Ca<o2：；

（2）底漸低：c<cuicu<c2：

e

（4）無跳空缺口：c<gi；io<o，，：ThreeBlackCrows（TBC）
2.TiD（內困三日翻黑）

TID模式與TIU模式相反，起始趨勢為上漲，先出現一個長紅K線，第二個是
ALLA判
斷規則如下：
論文表示式

Pg2>P？2：P2>PZi>P82；
Pg2>Pi>P？2；P？>P？和P？2>P/；
虛擬碼表示式

上升趨勢後內困三日翻黑策略（TID）

須符合以下所有賣出條件：

（1長紅後小跌：ga<caigosouiou<c，；

（2）小路未跌過前一日開盤：ga<cuicuscui

Pt

（4）2ThreeInsideDown（TID）

3.TOD（外側三日翻黑）

Top模式與TOU模式相反。先是上漲趨勢，第一天是一個小紅衣線，第一和第
三個是向下階梯的長黑K線。判斷規則如下：
論文表示式

PZ2VPZ1>P72P72VPi）

P7>P7#和P7>Pfi；
虛擬碼表示式

上升趨勢後外側三日翻黑策略（TOD）

須符合以下所有賣出條件：

（1小紅K後回跌：Cz2>Oz2o：Om>C2：3

（2）開高走低強力回跌：Cz2>O2o：Oz2>C-：

ee人

（4）連續三日收盤低：Cr<C-：ThreeOutsideDown（TOD）
4.ES（夜星）
ES模式與MS模式相反。第一天是一個長紅K線，第二天可以天上漲或下跌，
第三個是向下階梯的長黑K線。判斷規則如下：
論文表示式
PK2>P？2；IP7i-PZil>0；Pfi>P/2和PZi>P？2；
P/>P7和Pf<P？2+（P72一P？2）/2；
虛擬碼表示式
上升趨勢後夜星策略（ES）
須符合以下所有賣出條件：
（1紅K後隔日上跳空小紅小黑：ge<cailon-cul>0：
（2）跳空上漲後強力下跌：ca<cuica<g，
（3）近一日黑K作收：G<o，；
（4）收盤在實體紅K長度一半以下：G<ca-（ca-952：EveningStar（E5）
回參考文獻
Tsung-HsunLu，Yi-ChiChen，Yu-ChinHsu，“Trenddefinitionorholdingstrategy：
Whatdeterminestheprofitabilityofcandlestickcharting？”，JournalofBanking太Finance，
61，2015，p.172-183.
區圖輸入股票代號開始進行第一種趨勢判斷584。即判斷連續
六天上漲就買進；連續六天大跌就賣出。將有趨勢變化的紀錄在
前端網頁，並將股票資料在頁面上顯示。
|程式碼檔名：E_lo_l.himl
iTsm
2<head>|
3<metacharset="UTF-8'|
4<scriptsrce="http：//code.jquery'com/jquery-3.1.1.js"></scrip選|
5人Joadstatie%）|
6<scriptsre="（9statie"E_16_I/E_16_1j8"%）></Scrip說
<scriptsre="（9statie"E_14_2/E_14_25"%）></Scripb>
8</head>
9<body>
是<h3>題目：趨勢判斷與交易策略<h3>讓說主一<tableborder="0'>
說人AV
13<td><fieldset>
14<legend>新增資料庫資料</legend>
15<span>股票代號：</span><inputtype='text"id="insert_stock'一<br><br>
16<span>起始日：</span><inputtype="date"id="start_date"”value="2007-10-01'">
17<span>終止日：</span><inputtype="date"”id二"end_date”
Value="2017-09-30"><br><br>
18<inputtype二button"id='btn_insert"value="新增呈
19</fieldset></td>
20<td><fieldset>
21<legend>讀取資料庫資料</legend>
2<inputtype="radio"name="choose_type"value="all'id="all"checked>所有
股票<br>
23<inputtype="Tadio"name="choose_type"value="one"id="one">單一股票
24<span>股票代號：</span>
25An
26{%forstock_nameinstock_names%》
六<optionvalue="t（stock_name））">（（{stock_name）}</option>
28{（%endfor%）
2</select><br><br>
30<span>選擇趨勢判斷：</span><br>
2<inputtype二radio"”name=="trend_type"value="SMA3"id="SMA3"
checked>SMA3
32<inputtype="radio"name="trend_type"value="EMA10"
id="EMA10">EMA10
33<inputtyperadio”name="trend_type"value="Levy"id="Levy">Levy
34<br><span>買進策略</span><br>
35<inputtype="checkbox"name="trade_type"id="TWS"value="TWSn><label
for="TWS">TWS</label>
36<inputtype=checkboxname=trade_type"id="TIU"value="TIUm><label
for="TIU">TIU</label>37<inputtype="checkbox"”name="trade_type"id="TOUrvalue="TOU"><label|
foF="TOU">TOU</labeb>
38<inputtype=checkbox"name="trade_type"id="MS"value="MS"><label
for="MS">MS</label>
39<br><span>賣出策略</span><brr>
台AC_
5
41<inputtype="checkbox"name="trade_type"id="TIB"value="TIB"><label
LEE-
<inputtype='checkbox"name="trade_type"id="TOD"value="TOD'"><label
for="TOD">TOD</label>
43<inputtype="checkbox"name="trade_type"id="ES"value="ES"><label
for="ES">ES</label>
44<br><span>若未選擇，預設為全選</span><br>
說全回名
為</fieldset></td>1
和AV
48</table>
台AV
50”</body>
51<html>：
|程式碼檔名，m_6一
15$（documen6）.ready（function（1
2$（"#btn_search"）.click（function0（
3document，getElementById（"result"）.innerHTML='抓取中.，，.若期限過長，請稍後1
S
4varmethod=$（einputlname=choose_type]：ehecked）.val0；
2vartrend_typeLELE
讓Yarcheckbox_value三"站
w$C：eheckbox"）.each（function0（
varischecked=$（this）.is（"：checked）；
EL光隆ll10checkbox_value+二$（this），val0十9
17）
12》
13itmethod-一"one"）（
14varstock_id二$（9#stock_id9）.val0；
15$.ajax（t
16type："GET"，//傳送方式
17url："/E_16_1_Py"，//傳送目的地
18data：f//要傳送的資料
19"stock_id"：stock_id，
20trend_type：trend_type，
21trade_type'：checkbox_value
22和
23OOfunction（Data）《
EL
25）
26eTTOr：function（e）《
27console.log（e）；
9.，
29）
多
31elseitmethod一"al
325$.ajax（f
33type："GET"，//傳送方式
34url："/E_16IPy"，//傳送目的地
35data：（/要傳送的資料
36人
rend_type：trend_type，
38'trade_type：checkbox_value
39了
40success：function（Data）（
41$（"#result"）.html（Data）42j

說error：function（e）（

4console.log（e）；

4$

46闊

41】

為蕊

站0）

html與js的部份則跟第十五章範例E_152範例程式類似，請回顧E_152範例
程式碼說明，比較要注意的是，必須將趨勢判斷的radio值與交易策略的checkbox透
過AJAX傳進E161Py中，而checkbox將被勾選的值全部傳進一個變數之中，用，"
1"來分離。
urls.py記得做變動，而在views.py中也必須添加要執行的動作，如下：

1_fomE_161importmainasE_161_main

2fromdjango.dbimportconnection

3importpandasaspd

4

5defE_16_1（request）：

6tables=connection.introspection.table_names（）

7stock_names二

8fortableintables：

9iftlen（table）一10andtable[：6]一'stock_“andtable[-4：].isdigit0）：

10stock_names.append（table[-4：]）

1returnrender（request，E_16_1.htmlulocals0）

12

13defE_161_Py（reques0）：

14。stock_id=request.GET[stock_id]

15trend_type=request.GET[trend_typel]

16trade_type=request.GET[trade_typel]

17Huade_type一悶18trade_type="al
19eg
20trade_type=trade_type.split（"P）|
21deltrade_type[-11]
22ifCstock_id一"al
23tables=connection.introspection.table_names（）
24Tesult三pd.DataFrame（）
25fortableintables：
26iftlen（table）一10andtable[：6]一'stock_'andtable[-4：].isdigit0）：
如stkno二table[-4：]
28Tesult三result.append（E_16_l_main（stkno，'all，trend_type，trade_type），ignore_
index==True）
29response三Tesult
30else：
31response=E_161_main（stock_id，'onetrend_type，trade_type）
32
33returHttpResponse（response.to_html（classes二，col_space=100））
程式說明

第1列引入自定義模組E_161中的main方法。

第2列引入Django內建的connection方法。

第5列為載入一開始HTML頁面時所要執行的指令。

第6列依靠connection方法找到所有Models的名稱。

第9列加入判斷式，從資料庫中找出所有符合[stock_股票代號]這個命
名原則的資料表，加入進陣列中後並回傳至頁面上，顯示在使用者可以選擇的
<select><option>中的值。

第13列為使用者按下回測所要執行的指令。第22列至第29列為判斷計算所有股票。
第25列的迴圈將所有股票的資料傳進E_16_1_main（）進行計算，並將結果存放
進result中。
第29列為將一檔股票資料傳進E_16_1_main0）進行計算。
第33列是將dataFrame轉成html，顯示回頁面上，colspace可以設置表格儲存
格的最小寬度。
|程式碼檔名：E_16_1.py
1importpymysqlLcursors國
2importpandasaspd|
3importnumpyasnp|
4importdatetime
5importtime
6_#引用talib相關套件|
7importtalib4
8fromtalibimportMA_Type
9#引用plotly相關套件
10importplotly
11fromplotly.graph_objsimportFigure|
12importplotly.ofHlineaspyo
13#設定plotly帳號與apikey
14”plotlytools.set_credentials_file（username二api_key二）
15pyo.ofHline.init_notebook_mode（）
有
17#趨勢判斷
18deftrend_judgement（df，stkno，count，acmroiWinnum，winfact，trend_type，trade_type）：
|19close=np.array（df['closer]，dtype=floab）
20。SMA=talib.SMA（close，3）#close代進WMA方法做計算4
21dfDSMA']=SMA
22row==len（df）23

24foriinrange（row）：

25ifttrend_type一'SMA30：

26trend_status二SMA3（dfD

27

28Teturmdf

29#趨勢1SMA3

30“defSMA3（dfD：

1trend_status三None

32ii>=6）：

33ifCdfPSMAriloc[i]>dfPSMA'.iloe[i-1]>df[SMA'.iloc[i-21>df[SMA'.iloc[i-

3]>dfSMAiloc[i-4J>dfLSMAiloc[i-5]>dfSMAiloc[i-61）：

34trend_status三True

35print（'第{0）筆上漲趨勢SMA：（1j.format（i，dfPSMAilocl））
36elifCdfPSMA'iloc[i]<dfPSMA'].iloe[i-1]<df[SMA'].iloe[i-21<dfLSMA'].iloc[i-

3]<dfLSMA.iloe[i-4]<dfPSMA'.iloc[i-5]<dfLSMA'iloc[i-61）：

ootrend_status三False

38print（'第（0）筆下降趨勢SMA：（laformat（i，df[SMA'iloc[ij）
39returntrend_status

40

41#查詢資料庫的股票資料

42。defselect_db（stkno）：

63...同15章範例程式

64

65#主程式

66defmain（stkno，get_type，trend_type，trade_type）：

67df=select_db（stkno）

68”#進行趨勢判斷

69df=trend|judgement（dfstkno，count三0，acmroi三0，winnum三0，Winfact三0，trend_type

三trend_type，trade_type=trade_type）

70
有1returndf|程式說明

此範例程式大部份函數與15章相同，可以直接使用，如查詢資料庫功能seleot_
db0，主要新增的為進行趨勢判斷的trend_judgement（）與SA/4.0。

第18列至第28列為進行趨勢判斷的trend_judgement0。

第24列將每一列的數據以迴圈的方式，一筆一筆都執行過一次。

第25列判斷如果是使用s474，趨勢判斷。

第26列呼叫sa，函數，並將可能是上漲趨勢、下降趨勢或是None回傳至
tend_status。第28列，將tf結果回傳至main。

第30列至第39列為進行474趨勢判斷的S374，函數。

第32列判斷是否為4的趨勢變化，因為需要與前6天的收盤價進行判斷，
因此需要從第6天起才可以進行判斷。

第35列，為上漲趨勢的判斷條件，若符合則將結果在網頁印出。

第38列，為下降趨勢的判斷條件，若符合則將結果在網頁印出。

第65列為主程式，呼叫trend_judgement（）。
|十行結果

可以在頁面上看到df結果（下圖1）與終端機（下圖2）顯示S474，的趨勢判斷

PPLE與Levy趨勢會在下個範例中加入）igKUU划
533只1時上
《，Gololocanosrso00/E.16.l加和as人人和加人有和還生：
題目：趨勢判斷與交易策略
讀取資料庫資料
*所有股果
=單一代號：[i4097
新增資料庫資料r
股隊代號：[當當時
*SMA3yyLLevy
起始日29e7/7167e1終止日：2917/799739買進策略
~GTwsTUBEToUgMs
[三買出策略
口TBCUTIB品TODES
若未選擇，預設為全選
區班
富基天天天項寬國還相所轉選加凋
生[上天轉加革寬[EE國還EE還了其晤還還
1[2007-10021320|13.80一13.0013.40[1114000NaN|
|還還神加的CMEE因還點EE時戰[io900[1109
上_h___【o8__|92
!3600710042920和1280人29[0189000[53133333
|加罰天是加EETTCIEFEB5[2s51152c009|12950900
|國本二天一天基點已點還避[205900[2373333|
TTSTSEESIT[97000333|
上了50加上20692009[12416627
品205」和2220203
eeeSU5912.7012.2012.20[38900922s3333
站：5EP全3台8ES[33333）|
TTELlo下人
TT中所FeSEE|
說一上||」
TE號TTS了5EASTESSS
4200710192ti1可
TESTS太
因人三名8已9511.s66667
4HEE_SEl66667
15162007.10-237三多中蕊3[96300011.766667
reLETi一，
5hoseasy而而面悶悶
第2342生到超聞$M6：？.623333333333363
os
和
各
生
各生條蟬和全全
人
六
全人
全條蟬加全蟬全和
和光：本和
人
和說人
11症MKKKKKKKKK同
下生全LE
生全全全8.933333333333355
1LE
人
和人3站相遇劑共條
人生信友
中
-四全全菩癌生全章條
還人汪中人香料科科生
人
|人8生全和和人
和TEee
生人蟬入汪，，和計生
器朮字太全
攻灶和
人
系2454華夫人
人
半生和和
ST_接下來嘗試將另外2種趨勢變化EMA10與Levy也加進trend_
judgement（）中，只需要更改trend_judgement（），其他函數不用
變動。

[程式碼檔名：E_16_1.py

1#趨勢判斷

2deftrend_judgement（df，stkno，count，acmroi，winnum，winfact，trend_type，trade_type）：

3close=np.array（dfclose']，dtype=floab）

4SMA=talib.SMA（close，3）#close代進WMA方法做計算

5WMA=talib.WMA（close，3）#close代進WMA方法做計算

6”EMA=talib.EMA（close，10）#close代進EMA方法做計算

7dfPSMA]=SMA

8dfPWMA]=WMA

9dfEMA]=EMA

10row=len（d6）

1

12foriinrange（row）：

13ittrend_type一'SMA30：

14trend_status三SMA3（df，D）

15elifttrend_typePE

16trend_status=EMA10（dfD

17EL

trend_status三Levy（df，1

19

20retumdf

21#趨勢2EMA10

22defEMA10（dfD：

23trend_status三None

做

25idfPelose.iloc[iJ>dfPEMATiloc[iD：

26trend_status=三True

27print（第（0）筆上漲趨勢EMA：（1j'format（i，dLEMATiloc上））人28eliftdfLclose'].iloc[i]<dfLEMA'Tiloc[：~
29trend_status三False
30print（'第（0）筆下降趨勢EMA：（1j.format（i，dfLEMAT.iloc中））
31returtrend_status
32#趨勢3Levy趨勢
33“defLevy（df.0：
34trend_status=None
35itG>=131：
36total_change=0
37today_change=dfLclose'].iloc[ij/df[open].iloc叫
38before_change==df[closer].iloc[i-6]/df[open].iloc[i-6]
39forjinrange（-131.1：
40total_change+=df[closer]iloc[j]/df[open].iloc戰
41average_change==total_change/131.0
42if（（today_change-before_change）/before_change>6*average_change）：
43trend_status=True
44print（'第（0）筆上漲趨勢Levy：（1j.format（i，today_change））
45elift（today_change-before_change）/before_change~6*average_change）：
46trend_status三False
47print（'第（0）筆下降趨勢Levy：（1）format（i，today_change））
48returmtrend_status
|程式說明
第5-6列新增了SMA與EMA的計算。
第8-9列將資料放進df中。
第15列判斷如果是使用EMA10趨勢判斷。第17列判斷如果是使用Levy趨勢
判斷。
第21列至第32列為EMA10函數。
第24列，因為需要與在第10天才計算出的EMA10進行判斷，因此需要從第10
天起才可以開始進行。和第25列判斷為EMA10的上漲趨勢。
第28列判斷為EMA10的下降趨勢。
第32列至第48列，為Levy函數。
第35列，因為需要過去131天每日的價格變動的平均數，因此需要從第131天
起後才可以開始進行判斷。
第36列至第41列，可以計算出當日收盤價變化量、6日前收盤價變化量與過去
131天的價格變動的平均數。
第42列判斷為Levy的上漲趨勢。
第43列判斷為Levy的下降趨勢。
|選擇EMA10趨勢判斷的執行結果
ll
十目：趨勢判斷與交易策略和
|讀取資料庫資料
*所有股栗
一如當和
二一說這蟬|
n人
當還
全5
若未選擇，預設為全選
|[時一ar一ma
|
|BBS5：生
LEAS一上人了
SA四上SEE[17200o坊一|
上ELIED
HL問全
一一中下一了一還四
|加人一了一了訪TE中說一
TTLI了一際一中一|
T司[090740152.25TeLE一由0
性說點加
TL上EP一一一ASLESENEES|
TT上站TREL放的加點語CTE三
TTLTLELE上一head[Leeep一ad一
[站一險戰各一中一一一和畫路上時店1
圖cwindowsvsystem32Xxmdexe-pythonmanagepyrunserver下二全
第2429筆下降超勢EMa：？.1？？79797698g62
加條人和人
加條1和扣六人
四全全
EL
四全條人時入生信人
全作是
條
下全
加全全還全劑信人
下全加計說有人主全人
條條1四放yy7
下全還人說
下全人說加人
下全人
上人下本2八汪TT1
下全次全區選CAP
四條條全本站全才TA1
加條條全各全說
下全信條還
全
ee失人襄江人
下生生呈人1人語計01汪由和汪8
下說全是凍條二四公信人
罷課條俱全是人信人人人
四說條導作加日廬店不1史C生8全
做和宣戰人相抽性玉本入于條葡下訓全經
肝全全下3
人全王
四條俱全日聊性涼了
生9圖
公公全人全人全各全和表
中讓全」
SER家1未1上
1ee和和加
加以中I
茲3圖接下來再加入交易策略，TWS（紅三兵）與TBS（黑三兵）策略，
下LTvst過
並依照策略進行買賣，將股票代號、交易次數、累計報酬率、勝
MMN佃記櫥困太
率、獲利因子顯示至頁面上，還有若是判斷為只分析一檔股票，
7和
則進行K線圖繪製。
和w全沐廚導
更動trend_judgement（），將符合交易策略的日期、價錢添加進df中，與計算股票
加k下54
代號、交易次數、累計報酬率、勝率、獲利因子。
說新增trade_judgement（），進行交易策略的判斷。
>新增showMAplot（），為繪製K線圖。
2下
y更動main（）'，加入若為分析一檔股票，執行showMAplot繪製K線圖。|程式碼檔名：E_16_1.py
1#趨勢判斷
2deftrend_Judgement（df，stkno，count，acmroi，winnum，winfact，trend_type，trade_type）：
3close==np.array（df['close']，dtype=float）
4SMA=talib.SMA（close，3）#close代進WMA方法做計算
5WMA=ftalib.WMA（close，3）#close代進WMA方法做計算
6”EMA=talib.EMA（close，10）#close代進EMA方法做計算
7diPSMA]=SMA
8dPWMA]T=WMA
9diPEMA1=EMA
10只
11#設定初始值
12df[XBuy]三np.nan
13PE
14。df[XSell]=np.nan
15dfLYSell]=np.nan
16fiag=False
17buyprice=|]
18sellpriee=H
19win=0
f20Josshe
21
22foriinrange（row）：
23EPLE
六trend_status=SMA3（df1）
25elifttrend_type一EMA100：
26有PE
人83IFE2Y
38trend_status=Levy（dfD
39else：
30trend_status三None
3132#判斷有趨勢變化

33ifttrend_statust=None）：

34#進行八種交易策略判斷

35trade_result=trade_judgement（df，i，trend_status）
36itrade_result一Trueandfag一False）：

37dfLXBuyr].iloc[i]=dfdatesr].iloc輻

38buyprice=dfPeloser]iloc占

39dfLYBuy].iloc[i]=buyprice

40flag=True

41elifttrade_result一Falseandfag一True）：

42全三

43sellprice=dfL'close']iloc[

44dfYSell]iloc[i=sellprice

45flag=False

46count+三1

47[roi，winnum]==roical（buyprice，sellprice，winnum）
48acmroil十=rol

49[loss，win]=winfactor（buyprice，sellprice，loss，win）
50elifti一（len（dpD-1）andfag一Trme）：

51dfPXSell].iloc[i]=dfdates]iloc品

52sellpriee二df['closer].iloc[i

53dfPYSell].iloc[i]=sellprice

54count+1

二[roi，winnum]=roical（buyprice，sellprice，winnum）
56acmrol+=rol

57下（loss三0）：

58Joss=1

59Winvar三Win/oss

60。註（count二0）：

61count=0.01

6263df_result=pd.DataFrame（[[stkno，str（eount），str（round（acmroiwe
2））+'%，str（round（（winnum/count）*100，2））+96，strtround（winvar，2））]j，columns=[股票代號
"交易次數，累計報酬率，"勝率，"獲利因子D

64returndf，df_result

65

66#交易策略

67deftrade_judgement（df，Ltrend_status）：

68

69#是否達成任一交易策略

70tradeFalse

71#上升趨勢

22if（trend_statusTrue》：

人2

六itrade一False）：

75ans=0

76ift（dflelose.iloc[ij>diLopen].iloc[）and（dflclose].iloc[i-1]>diLopenj.iloc[i-11）and
（difclose].iloc[i-2]>dflopen]iloc[i-21））：

77ans+=1

78把（dfLeloseiloc[il>dfLelose]iloe[i-11and（dfleloser.iloc[i-1]>dfLelose]iloc[i-21）：

79ansS十=

80if（（dfLclose].iloc[i-2]>dflopen].iloe[i-11）and（dfopen.iloc[i-l]>dfopenr.
iloc[i-2D）：

$1anS+中

$2珀（dfleloseriloc[i-1]>dflopen].iloc[ij）and（dfopenj.iloc[il>dflopeniloc[i-1））：

83anS+中

#符合以上四項TWs標準

85iftans一4：

86trade三True

57ifttrade一True）：

88TeturnTrue

二elifttrade一False）：

90ITeturnNone91

92。經下降趨勢

93elifttrend_status一False）：

94#TBC

905if（trade一False）：

96ans三0

97idfLeloser]iloc[ij<dfPopen].iloc[）and（dfPelose]iloc[i-1]<dfLopen.iloc[i-1]）and

（dfeloser].iloc[i-2]<dfopenl.iloc[i-20）：

98ans+=1

99玖（dfPeloseliloc[i]j<dfLclose]iloc[i-1）and（dielose].iloc[i-1]<dfLcloseiloc[i-2D）：
100ans+=1

101ift（dfLelose].iloc[i-2]<dfLopen].iloc[i-1]）and（df[open.iloc[i-1]<dfLopenr].

iloc[i-21）：

102ans+二1

103記（df[elose]iloc[i-1]<dfLopenjiloc[ij）and（dfLopeniloc[il<dfLopenliloc[i-1D）：
104Gi

105itans二4：

106trade三True

107。。itrade一True）：

108TeturnFalse

109全|

110Teturn之Bo

111#繪製K線圖

112defshowMAplot（d0）：

113...同15章範例程式

114

115#主程式

116defmain（stkno，get_type，trend_type，trade_type）：

117df=select_db（stkno）

118”#進行趨勢判斷
二全人stkno，count=0，acmroi==0，Winnum=0，winfact三0，

trend_type三trend_type，trade_type）人
121showMAplot（df）5

122
|123return（df_Tesult）
|程式說明

第11列至第21列設置初始值，XBuy為買入點的日期、YBuy為買入點的收盤
價、XSell為賣出點的日期、YSell為賣出點的收盤價、flag為判斷找到買入點後，
接下來要找賣出點，找到賣出點下，接著再尋找買入點，以此循環。buyprice與
sellprice則是買入價與賣出價。win與lose用於判斷勝率。

第33列判斷是否有趨勢變化。

第35列進行交易策略的判斷，當判斷可以是買入點時，會回傳Tue給trade_
result，判斷可以是賣出點時，會回傳False給trade_result。目前只有TWS與TBS策
略。

第36列判斷如果為可以是買入點，並且flag=False（正要尋找買入點）時執行。

第41列判斷如果為可以是賣出點，並且fiag=True（正要尋找賣出點）時執行，當
賣出時，可以計算一筆買賣的交易次數、累計報酬率、勝率、獲利因子。

第50列判斷如果是最後一筆資料，並且fiag=True（正要尋找賣出點）時執行，當
賣出時，可以計算一筆買賣的交易次數、困計報酬率、勝率、獲利因子。

第63列將結果存進dfresult的dataFrame中。

第64列將df與df_result回傳至main。

第67列至第110列為進行交易策略的分析。

第72列判斷為上升趨勢（買入點的交易策略都寫進這裡）。第74列判斷當如果尚未符合其他的交易策略，則開始進行TWS的分析。TWS
要同時符合76、78、80、82四個條件式的判斷（見交易策略的公式），才符合可以是
買入點的條件。第92列，判斷為下降趨勢（賣出點的交易策略都寫進這裡）。

第120列判斷如果是查詢單筆股票資料，則進行showMAplot繪製K線圖。

第123列將交易次數、困計報酬率、勝率、獲利因子顯示至頁面上。
ITWws與TBc交易策略以SMA3趨勢判斷執行結果（下個範例）：

33115本凍
Doeshosie

topb3和對中身田人日生點人4

題目：趨勢判斷與交易策略和

讀取資料庫資料導

LE=

新增資料庫資料選單一股栗股林代號：[14099|

股栗代號：還擇趨勢判斷：盡

4人*SMA30EMA10GLevy

起始日12997/19/91終止四2917/99/39一天說請器中

ITWSITIUTOU口MS一

人口TODDES

若未選擇，預設為全選

[他上

本全交易交還和一MR1

1國0.01[0%0.0%_上1

TT5E33E一由

上上一一上

TLBBS點可天天上

TESEESP一上

|肝|

ITELES一

TT了MVL|WIL上

TTSEEFSSTE一

和【

-E北35因0.0%b一員

TT還囊一上

LESEESgegg虹

一be上

THmm|sw一一臣一站條加接下來再將剩餘6個交易策略TIU（內困三日翻紅）、TOU（外側
國圖三日翻紅）、MS（晨星）、TID（內困三日翻黑）、TOD（外側三日
翻黑）、ES（夜星）加進trade_judgement中，其他范數不用縱動。
|程式碼檔名：E_16_1.py
1deftrade_judgement（df，jtrend_status）：
2
3#是否達成任一交易策略
4trade上False
5##上升趨勢
6if（trend_status王True）：
7#TWS
8itrade一False）：
9ans三0
10it（dfLclose]iloc[i]j>dfPopen].iloc[）and（dfLelose.iloc[i-1]>dfPopeniloc[i-11）and
（dfLeloseiloc[i-2]>dfPopen.iloc[i-2D）：
1ans二=1
12記（dflelose]iloc[ij>dfclose]iloc[i-1）and（dfPelose].iloc[i-1]>dftelose]iloc[i-21））：
13ans+=1
14it（dfPeloser.iloc[i-2]>dfIopen].iloc[i-11）and（df[open].iloc[i-1]>df[open].
iloc[i-2D）：
15ans+三1
16ift（dflelose]iloc[i-lJ>dfPopen]iloc[ij）and（df[open]iloc[ij>diopeniloc[i-1D）：
17an5S十三1
18#符合以上四項TWS標準
19抱ans一4：
20trade三True
21#TIU
8itrade一False）：
性ans三0
2記（df[open.iloc[i-2]>df[elose.iloe[i-21）and（dlopen].iloc[i-2]>=dfPopen].
iloc[i-1）and（dftopenr].iloc[i-1]>dfLeloseliloc[i-2））：
2ans+=126（df[openiloc[i-2]>dfelose].iloc[i-1）and（dfPclose].iloc[i-1]>=dfLelosel].
iloc[i-20D）：
2ans+=1
28iftdfeloser].iloc[ij>dfTopen.iloc[i]）：
29ans+=1
30iftdflcloser.iloc[ij>df[open.iloc[i-2]）：
31ans+=1
32iftans一4：
33trade二True
34#TOU
35ifttrade一False）：
36ans=0
37if（（df[openj.iloc[i-2]>df[close].iloc[i-2]）and（dfLelose.iloc[i-1]>dfl'openr].
iloc[i-2D）：
38ans+=1
39if（（df[open].iloc[i-2]>dfclose].iloc[i-21）and（dfLeloser].iloc[i-2]>df['open.
所
40ans+=1
41if（dfLclose].iloc[i]>dfLopenj]iloc[iD：
42ans+=1
43itdfLelose].iloc[ij>dfLelose]iloc[i-1D：
44th
45itans一4：
46trade=True
47#MS
48ittrade一False）：
aeans=三0
50（df[open.iloc[i-2]>df[close.iloc[i-2]）and（abs（dfopenj.iloc[i-1]-dfielosel].
iloc[i-1）>0））：
51ans十三1
52gaEREELRU
ooans+==154if（dfLclose']iloc[i]>dfLopen].iloc[ij）：
55ansS十=1
56itdfLcloser].iloc[i]>（dftclose]iloc[i-2]+（dfLopen.iloc[i-2]-dfilcloseiloc[i-2）/2））：
57E
EP
59trade三True
60itrade一True）：
61TeturnTrue
62elifttrade二False）：
63LENone
&
$左7可本中
（HE
s#TBC
8諷trade一False）：
69ans三0
70識（dfi[close]iloc[ij<dflLopen].iloe[ij）and（dflcloseiloc[i-1]<dflopen]iloc[i-11）and
（dfLelose].iloc[i-2]<dflopenr.iloc[i-21））：
71人
s及人
ans+=1
2太
iloc[i-21）：
25ans十三1
76ift（dfPeloser]iloc[i-1]<df[open.iloc[i）and（dfopen].iloc[il<dfopen].iloc[i-1D）：
>ans+三1
7到
trade三True
80#TID
81ifttrade一False）：
$2ans三0
時下（df[openr].iloc[i-2]<df['closer].iloc[i-21）and（df[open].iloc[i-21<=df[open]-
ioc[i-11and（dflopen.iloc[i-1]<df[eclosel].iloc[i-21））：84ans+三1

85ift（df[open.iloc[i-2]J<dfTelose].iloe[i-11）and（dflclose].iloc[i-1]<=dfLclose]
iloc[i-21）：

86anS+=1

87iftdfelose.iloe[ij<dfopen].iloc[i）：

88ans+=1

89idfclose]iloc[ilj<dfPopen].iloc[i-2]）：

90ans二=1

91iftans一4：

92trade三True

93#TOD

94itrade一False）：

95ans三0

96if（（dfLopenr.iloc[i-2]<dfLelose].iloc[i-21）and（dfLelose'].iloc[i-2]<df[openr].
iloc[i-1D）：

97ans+=1

98if（CdfPopen].iloc[i-21<df[elose.iloc[i-21）and（dfPelose].iloc[i-1]<dfPopenr].
iloe[i-2D）：

99ans+=1

100GELE

101ans+=1

102GEEL

103ans+=1

104ians一4：

105trade二True

人

107ifttrade玫False）：

108ans二0

109iftdfopen].iloc[i-2]<dfLelose].iloe[i-2]and（abs（dflopen.iloe[i-1]-dfPelose.
Em

110ans+=1

111idf[elose.iloc[i-21<dfiPelose].iloe[i-11）and（delosed.iloc[i-2]<dfPopend.
iloc[i-1D）：112ans+=1還生

113itdfLelose].ilocij<dfPopenr.iloc[ij）：

114ans十三1

115idfLelose]Liloc[il<（dfTeloser].iloc[i-2]-（dflcloser]iloc[i-2]-dfPopenj.iloc[i-2]）/2））：

116ans+=1

117iftans一4：

118trade二True

119ifttrade一True）：

120TetuInFalse

121elifttrade一False）：

122returnNone
|徨式說明

加入了TIU（內困三日翻紅）、TOU（外側三日翻紅）、MS（晨星）、TID（內困三

日翻黑）、TOD（外側三日翻黑）、ES（夜星）的交易策略。TIU、TOU、MS為判斷是
上漲趨勢時才會發生；TID、TOD、ES為判斷是下降趨勢時才會發生。
|壯所有交易策略一起執行SMA3趨勢策略的執行結果：1
說：計較點生苞到避扣汪汪2和：汪2訓說問拓
題目：趨勢判斷與交易策略。
讀取資料庫資料
@所有股票員
新增資料庫資料@單一股票股票代號：「1409，中
股栗代號：[一選擇說勢判斷：
@SMA3QEMA10GLevy）
起始日：2997/19/91一終止日]2917/99/39買進策略員
還口TWS口TIU品TOUUMS度
[于是賣出策略中
口ITBCTIBDTODDES
若未選擇，預設為全選二
圖1
[|股栗代紛|交易次數|累計報硬字勝率|獲利因午日
TeCK
TTKr其還國加
TT5r8
加里人；
[4330有0%0.0%0.0買
0上
6[2408婦114.01%50.0%4.78員
7和42台77|00%則
Te
國還加加加本吧條加全有全可各一
上
TEww
eg北上93.34%000%571.0|上
re則
TE
人32
Web+MySQL+Django、\A
金融大數據藍圖
4的
區和和
1條
二EL
加本
本書（二部曲）特色
@程式交易：引用Python之TA-Lib套件
撰寫交易策略如均線、布林通道與K線
組合等技術指標進行回測。和
@前端：Web介面APP實作，前端技術
使用HTML5、CSS3與JavaScript。
@股市走勢圖：採用plotly.js將交易策略各
回測結果標示走勢圖及買點賣。
@後端：Django伺服器架設手把手實
作，簡單、快速、穩定。
@網路爬蟲：以Python撰寫爬蟲程式抓、了
Googlefinance股市資料。
@資料庫：將網路爬蟲的股市資料寫入
MySQL資料庫。
ISBN978-986-434-284-6
MP31805
及博頃文化股份有限公司
碩文化人各廬放和三和ooooeieeooeeec《